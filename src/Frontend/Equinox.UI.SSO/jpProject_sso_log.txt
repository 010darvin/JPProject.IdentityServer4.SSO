2018-08-26 15:17:02.869 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 15:17:02.894 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 15:17:02.895 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 15:17:02.895 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 15:17:02.895 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 15:17:02.978 -03:00 [DBG] Starting token cleanup
2018-08-26 15:18:14.168 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 15:18:14.202 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 15:18:14.203 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 15:18:14.203 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 15:18:14.204 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 15:18:14.302 -03:00 [DBG] Starting token cleanup
2018-08-26 15:18:32.899 -03:00 [DBG] 0 persisted grants found for c4b6b328-21ca-4438-022d-08d60b6c46e1
2018-08-26 15:18:43.035 -03:00 [DBG] 0 persisted grants found for c4b6b328-21ca-4438-022d-08d60b6c46e1
2018-08-26 15:18:48.966 -03:00 [DBG] 0 persisted grants found for c4b6b328-21ca-4438-022d-08d60b6c46e1
2018-08-26 15:18:52.914 -03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-26 15:18:52.964 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-26 15:18:52.968 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-26 15:18:52.969 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-26 15:18:52.990 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "c4b6b328-21ca-4438-022d-08d60b6c46e1",
  "DisplayName": "bruno",
  "ActivityId": "0HLGBG150FCTP:00000008",
  "TimeStamp": "2018-08-26T18:18:52Z",
  "ProcessId": 21940,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 15:18:57.443 -03:00 [INF] AuthenticationScheme: Google was challenged.
2018-08-26 15:19:02.402 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-26 15:19:02.572 -03:00 [WRN] User 3065dd79-077d-4f44-94a7-b248cd933b8c validation failed: DuplicateUserName.
2018-08-26 15:19:11.558 -03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-08-26 15:20:10.216 -03:00 [INF] AuthenticationScheme: Google was challenged.
2018-08-26 15:20:13.664 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-26 15:20:13.688 -03:00 [WRN] User dcf7fd6b-22cc-4248-8992-ac3e34c6a53b validation failed: DuplicateUserName.
2018-08-26 15:20:58.461 -03:00 [INF] AuthenticationScheme: Google was challenged.
2018-08-26 15:21:01.968 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-26 15:21:01.988 -03:00 [WRN] User 4ff1e31d-0b11-4bb4-92f5-20a2258e9a5b validation failed: DuplicateUserName.
2018-08-26 15:21:04.584 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-26 15:21:05.422 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-26 15:21:05.625 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "86cab393-f5a8-46f9-9abc-1f7be2b2e5e2",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGBG150FCTP:0000001F",
  "TimeStamp": "2018-08-26T18:21:05Z",
  "ProcessId": 21940,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 15:21:05.637 -03:00 [DBG] Augmenting SignInContext
2018-08-26 15:21:05.639 -03:00 [DBG] Adding amr claim with value: external
2018-08-26 15:21:05.642 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-26 15:21:05.643 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-26 16:36:26.131 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 16:36:26.160 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 16:36:26.160 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 16:36:26.161 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 16:36:26.161 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 16:36:26.239 -03:00 [DBG] Starting token cleanup
2018-08-26 16:36:27.614 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-26 16:36:27.618 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-26 16:36:27.619 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-26 16:36:27.625 -03:00 [INF] Identity.Application was not authenticated. Failure message: No principal.
2018-08-26 16:36:27.651 -03:00 [INF] Identity.Application was not authenticated. Failure message: No principal.
2018-08-26 16:36:43.628 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 16:36:43.637 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 16:36:43.639 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 16:36:43.646 -03:00 [DBG] Start authorize request
2018-08-26 16:36:43.657 -03:00 [DBG] No user present in authorize request
2018-08-26 16:36:43.664 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 16:36:44.091 -03:00 [DBG] UserManagement found in database: true
2018-08-26 16:36:44.111 -03:00 [ERR] Invalid redirect_uri: https://localhost:5003/swagger/oauth2-redirect.html
{
  "ClientId": "usermanagement",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5001/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagement",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagement",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE2OjM2OjQzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 16:36:44.119 -03:00 [ERR] Request validation failed
2018-08-26 16:36:44.120 -03:00 [INF] {
  "ClientId": "usermanagement",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5001/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagement",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagement",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE2OjM2OjQzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 16:36:44.149 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagement",
  "ClientName": "User Management OpenId Connect",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLGBHCR8VGDE:00000002",
  "TimeStamp": "2018-08-26T19:36:44Z",
  "ProcessId": 29164,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 16:36:59.505 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 16:36:59.518 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 16:36:59.520 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 16:36:59.527 -03:00 [DBG] Start authorize request
2018-08-26 16:36:59.529 -03:00 [DBG] No user present in authorize request
2018-08-26 16:36:59.532 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 16:36:59.550 -03:00 [DBG] UserManagement found in database: true
2018-08-26 16:36:59.550 -03:00 [ERR] Invalid redirect_uri: https://localhost:5003/swagger/oauth2-redirect.html
{
  "ClientId": "usermanagement",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5001/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagement",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagement",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE2OjM2OjU5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 16:36:59.558 -03:00 [ERR] Request validation failed
2018-08-26 16:36:59.559 -03:00 [INF] {
  "ClientId": "usermanagement",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5001/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagement",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagement",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE2OjM2OjU5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 16:36:59.567 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagement",
  "ClientName": "User Management OpenId Connect",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLGBHCR8VGDE:00000004",
  "TimeStamp": "2018-08-26T19:36:59Z",
  "ProcessId": 29164,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 16:42:01.164 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 16:42:01.197 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 16:42:01.197 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 16:42:01.198 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 16:42:01.198 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 16:42:01.318 -03:00 [DBG] Starting token cleanup
2018-08-26 16:42:08.489 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 16:42:08.505 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 16:42:08.506 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 16:42:08.511 -03:00 [DBG] Start authorize request
2018-08-26 16:42:08.521 -03:00 [DBG] No user present in authorize request
2018-08-26 16:42:08.534 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 16:42:08.799 -03:00 [DBG] UserManagementUI found in database: false
2018-08-26 16:42:08.816 -03:00 [ERR] Unknown client or not enabled: UserManagementUI
{
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE2OjQyOjA4IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 16:42:08.821 -03:00 [ERR] Request validation failed
2018-08-26 16:42:08.821 -03:00 [INF] {
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE2OjQyOjA4IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 16:42:08.844 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ActivityId": "0HLGBHFV4UJ5E:00000002",
  "TimeStamp": "2018-08-26T19:42:08Z",
  "ProcessId": 2668,
  "LocalIpAddress": "127.0.0.1:5000",
  "RemoteIpAddress": "127.0.0.1"
}
2018-08-26 16:53:52.593 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 16:53:52.615 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 16:53:52.615 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 16:53:52.616 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 16:53:52.616 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 16:53:52.699 -03:00 [DBG] Starting token cleanup
2018-08-26 16:54:00.527 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 16:54:00.536 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 16:54:00.537 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 16:54:00.540 -03:00 [DBG] Start authorize request
2018-08-26 16:54:00.550 -03:00 [DBG] No user present in authorize request
2018-08-26 16:54:00.554 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 16:54:00.989 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 16:54:01.010 -03:00 [ERR] Invalid redirect_uri: https://localhost:5003/swagger/oauth2-redirect.html
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5001/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE2OjU0OjAwIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 16:54:01.019 -03:00 [ERR] Request validation failed
2018-08-26 16:54:01.019 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5001/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE2OjU0OjAwIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 16:54:01.044 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLGBHMJ47ML0:00000003",
  "TimeStamp": "2018-08-26T19:54:01Z",
  "ProcessId": 32804,
  "LocalIpAddress": "127.0.0.1:5000",
  "RemoteIpAddress": "127.0.0.1"
}
2018-08-26 17:03:45.476 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 17:03:45.502 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 17:03:45.504 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 17:03:45.506 -03:00 [DBG] Start authorize request
2018-08-26 17:03:45.507 -03:00 [DBG] No user present in authorize request
2018-08-26 17:03:45.508 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:03:45.828 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:03:45.830 -03:00 [ERR] Invalid redirect_uri: https://localhost:5003/swagger/oauth2-redirect.html
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5001/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjAzOjQ1IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:03:45.836 -03:00 [ERR] Request validation failed
2018-08-26 17:03:45.837 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5001/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjAzOjQ1IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:03:45.845 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLGBHMJ47ML2:00000001",
  "TimeStamp": "2018-08-26T20:03:45Z",
  "ProcessId": 32804,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 17:06:08.919 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 17:06:08.941 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 17:06:08.941 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 17:06:08.942 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 17:06:08.942 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 17:06:09.028 -03:00 [DBG] Starting token cleanup
2018-08-26 17:06:22.721 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 17:06:22.730 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 17:06:22.731 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 17:06:22.734 -03:00 [DBG] Start authorize request
2018-08-26 17:06:22.742 -03:00 [DBG] No user present in authorize request
2018-08-26 17:06:22.746 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:06:23.145 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:06:23.165 -03:00 [ERR] Invalid redirect_uri: https://localhost:5003/swagger/oauth2-redirect.html
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjA2OjIyIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:06:23.174 -03:00 [ERR] Request validation failed
2018-08-26 17:06:23.174 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjA2OjIyIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:06:23.200 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLGBHTEJBVGN:00000003",
  "TimeStamp": "2018-08-26T20:06:23Z",
  "ProcessId": 3708,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 17:19:43.166 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 17:19:43.210 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 17:19:43.210 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 17:19:43.210 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 17:19:43.210 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 17:19:43.289 -03:00 [DBG] Starting token cleanup
2018-08-26 17:20:03.215 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 17:20:03.252 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 17:20:03.252 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 17:20:03.253 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 17:20:03.253 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 17:20:03.437 -03:00 [DBG] Starting token cleanup
2018-08-26 17:20:11.967 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 17:20:11.977 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 17:20:11.978 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 17:20:11.984 -03:00 [DBG] Start authorize request
2018-08-26 17:20:11.993 -03:00 [DBG] No user present in authorize request
2018-08-26 17:20:12.007 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:20:12.474 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:20:12.494 -03:00 [ERR] Invalid redirect_uri: https://localhost:5003/swagger/oauth2-redirect.html
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjIwOjExIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:20:12.503 -03:00 [ERR] Request validation failed
2018-08-26 17:20:12.503 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjIwOjExIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:20:12.528 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLGBI578AUUG:00000002",
  "TimeStamp": "2018-08-26T20:20:12Z",
  "ProcessId": 31300,
  "LocalIpAddress": "127.0.0.1:5000",
  "RemoteIpAddress": "127.0.0.1"
}
2018-08-26 17:20:37.774 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 17:20:37.778 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 17:20:37.786 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 17:20:37.793 -03:00 [DBG] Start authorize request
2018-08-26 17:20:37.794 -03:00 [DBG] No user present in authorize request
2018-08-26 17:20:37.798 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:20:37.822 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:20:37.825 -03:00 [ERR] Invalid redirect_uri: https://localhost:5003/swagger/oauth2-redirect.html
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjIwOjM3IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:20:37.830 -03:00 [ERR] Request validation failed
2018-08-26 17:20:37.831 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjIwOjM3IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:20:37.837 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLGBI578AUUG:00000004",
  "TimeStamp": "2018-08-26T20:20:37Z",
  "ProcessId": 31300,
  "LocalIpAddress": "127.0.0.1:5000",
  "RemoteIpAddress": "127.0.0.1"
}
2018-08-26 17:22:53.193 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 17:22:53.209 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 17:22:53.211 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 17:22:53.214 -03:00 [DBG] Start authorize request
2018-08-26 17:22:53.215 -03:00 [DBG] No user present in authorize request
2018-08-26 17:22:53.216 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:22:53.230 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:22:53.231 -03:00 [ERR] Invalid redirect_uri: https://localhost:5003/swagger/oauth2-redirect.html
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjIyOjUzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:22:53.235 -03:00 [ERR] Request validation failed
2018-08-26 17:22:53.236 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjIyOjUzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:22:53.243 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLGBI578AUUG:00000006",
  "TimeStamp": "2018-08-26T20:22:53Z",
  "ProcessId": 31300,
  "LocalIpAddress": "127.0.0.1:5000",
  "RemoteIpAddress": "127.0.0.1"
}
2018-08-26 17:23:10.872 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 17:23:10.875 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 17:23:10.880 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 17:23:10.884 -03:00 [DBG] Start authorize request
2018-08-26 17:23:10.887 -03:00 [DBG] No user present in authorize request
2018-08-26 17:23:10.889 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:23:10.903 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:23:10.906 -03:00 [ERR] Invalid redirect_uri: https://localhost:5003/swagger/oauth2-redirect.html
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjIzOjEwIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:23:10.911 -03:00 [ERR] Request validation failed
2018-08-26 17:23:10.912 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjIzOjEwIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:23:10.920 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLGBI578AUUG:00000008",
  "TimeStamp": "2018-08-26T20:23:10Z",
  "ProcessId": 31300,
  "LocalIpAddress": "127.0.0.1:5000",
  "RemoteIpAddress": "127.0.0.1"
}
2018-08-26 17:23:23.551 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 17:23:23.555 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 17:23:23.562 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 17:23:23.566 -03:00 [DBG] Start authorize request
2018-08-26 17:23:23.568 -03:00 [DBG] No user present in authorize request
2018-08-26 17:23:23.569 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:23:23.584 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:23:23.586 -03:00 [ERR] Invalid redirect_uri: https://localhost:5003/swagger/oauth2-redirect.html
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjIzOjIzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:23:23.594 -03:00 [ERR] Request validation failed
2018-08-26 17:23:23.595 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjIzOjIzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:23:23.609 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLGBI578AUUM:00000002",
  "TimeStamp": "2018-08-26T20:23:23Z",
  "ProcessId": 31300,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 17:23:26.718 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 17:23:26.722 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 17:23:26.727 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 17:23:26.736 -03:00 [DBG] Start authorize request
2018-08-26 17:23:26.741 -03:00 [DBG] No user present in authorize request
2018-08-26 17:23:26.744 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:23:26.758 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:23:26.763 -03:00 [ERR] Invalid redirect_uri: https://localhost:5003/swagger/oauth2-redirect.html
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjIzOjI2IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:23:26.771 -03:00 [ERR] Request validation failed
2018-08-26 17:23:26.772 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjIzOjI2IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:23:26.780 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLGBI578AUUM:00000004",
  "TimeStamp": "2018-08-26T20:23:26Z",
  "ProcessId": 31300,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 17:23:47.665 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 17:23:47.675 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 17:23:47.675 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 17:23:47.678 -03:00 [DBG] Start authorize request
2018-08-26 17:23:47.679 -03:00 [DBG] No user present in authorize request
2018-08-26 17:23:47.683 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:23:47.698 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:23:47.700 -03:00 [ERR] Invalid redirect_uri: https://localhost:5003/swagger/oauth2-redirect.html
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjIzOjQ3IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:23:47.707 -03:00 [ERR] Request validation failed
2018-08-26 17:23:47.707 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjIzOjQ3IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:23:47.712 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLGBI578AUUM:00000006",
  "TimeStamp": "2018-08-26T20:23:47Z",
  "ProcessId": 31300,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 17:25:09.277 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 17:25:09.286 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 17:25:09.290 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 17:25:09.295 -03:00 [DBG] Start authorize request
2018-08-26 17:25:09.297 -03:00 [DBG] No user present in authorize request
2018-08-26 17:25:09.299 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:25:09.314 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:25:09.317 -03:00 [ERR] Invalid redirect_uri: https://localhost:5003/swagger/oauth2-redirect.html
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjI1OjA5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:25:09.324 -03:00 [ERR] Request validation failed
2018-08-26 17:25:09.327 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjI1OjA5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:25:09.334 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLGBI578AUUM:00000008",
  "TimeStamp": "2018-08-26T20:25:09Z",
  "ProcessId": 31300,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 17:25:22.937 -03:00 [DBG] TaskCanceledException. Exiting.
2018-08-26 17:25:22.980 -03:00 [DBG] Stopping token cleanup
2018-08-26 17:26:26.711 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 17:26:26.742 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 17:26:26.742 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 17:26:26.742 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 17:26:26.742 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 17:26:26.872 -03:00 [DBG] Starting token cleanup
2018-08-26 17:26:32.209 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 17:26:32.225 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 17:26:32.226 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 17:26:32.230 -03:00 [DBG] Start authorize request
2018-08-26 17:26:32.240 -03:00 [DBG] No user present in authorize request
2018-08-26 17:26:32.254 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:26:32.696 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:26:32.717 -03:00 [ERR] Invalid redirect_uri: https://localhost:5003/swagger/oauth2-redirect.html
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjI2OjMyIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:26:32.725 -03:00 [ERR] Request validation failed
2018-08-26 17:26:32.726 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "http://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjI2OjMyIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:26:32.752 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLGBI8PI5PMQ:00000002",
  "TimeStamp": "2018-08-26T20:26:32Z",
  "ProcessId": 33904,
  "LocalIpAddress": "127.0.0.1:5000",
  "RemoteIpAddress": "127.0.0.1"
}
2018-08-26 17:27:03.851 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 17:27:03.866 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 17:27:03.867 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 17:27:03.874 -03:00 [DBG] Start authorize request
2018-08-26 17:27:03.875 -03:00 [DBG] No user present in authorize request
2018-08-26 17:27:03.877 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:27:03.897 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:27:03.958 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:27:04.151 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:27:04.172 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:27:04.180 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:27:04.189 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:27:04.191 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.full_access",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDE3OjI3OjAzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjI3OjAzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:27:04.207 -03:00 [INF] Showing login: User is not authenticated
2018-08-26 17:27:04.244 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:27:04.255 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:27:04.258 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:27:04.264 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:27:04.266 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:27:04.272 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:27:04.274 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:27:04.287 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:27:18.625 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-26 17:27:20.580 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-26 17:27:20.886 -03:00 [INF] User created a new account with password.
2018-08-26 17:27:20.910 -03:00 [INF] User created a new account with password.
2018-08-26 17:27:21.164 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "cbf2e91b-b1d5-43bd-a848-59c69da6d0a9",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGBI8PI5PMQ:00000008",
  "TimeStamp": "2018-08-26T20:27:21Z",
  "ProcessId": 33904,
  "LocalIpAddress": "127.0.0.1:5000",
  "RemoteIpAddress": "127.0.0.1"
}
2018-08-26 17:27:21.177 -03:00 [DBG] Augmenting SignInContext
2018-08-26 17:27:21.179 -03:00 [DBG] Adding amr claim with value: external
2018-08-26 17:27:21.184 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-26 17:27:21.189 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-26 17:27:21.226 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-26 17:27:21.229 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-26 17:27:21.232 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-26 17:27:21.238 -03:00 [DBG] Start authorize callback request
2018-08-26 17:27:21.241 -03:00 [DBG] User in authorize request: cbf2e91b-b1d5-43bd-a848-59c69da6d0a9
2018-08-26 17:27:21.242 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:27:21.253 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:27:21.256 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:27:21.263 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:27:21.266 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:27:21.272 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:27:21.274 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:27:21.278 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "cbf2e91b-b1d5-43bd-a848-59c69da6d0a9",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.full_access",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDE3OjI3OjAzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "SessionId": "e2e2589c857224a33d6793f78d6d143c",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE3OjI3OjAzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 17:27:21.337 -03:00 [DBG] r4ljfuZ+IcGi2dKi04HTEZ9Wc0/pnELR5Wx8ta0+taE= found in database: false
2018-08-26 17:27:21.340 -03:00 [DBG] user_consent grant with value: UserManagementUI|cbf2e91b-b1d5-43bd-a848-59c69da6d0a9 not found in store.
2018-08-26 17:27:21.343 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-26 17:27:21.344 -03:00 [INF] Showing consent: User has not yet consented
2018-08-26 17:27:21.375 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:27:21.384 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:27:21.389 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:27:21.394 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:27:21.397 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:27:21.402 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:27:21.403 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:27:21.412 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:27:21.415 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:27:21.421 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:28:08.690 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:28:08.706 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:28:08.710 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:28:08.717 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:28:08.722 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:28:08.729 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:28:08.730 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:28:08.743 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:28:08.748 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:28:08.756 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:29:27.333 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:29:27.349 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:29:27.351 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:29:27.361 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:29:27.363 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:29:27.369 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:29:27.372 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:29:27.383 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:29:27.389 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:29:27.396 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:30:13.078 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:30:13.087 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:30:13.090 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:30:13.098 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:30:13.100 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:30:13.106 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:30:13.107 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:30:13.115 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:30:13.117 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:30:13.123 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:30:37.415 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:30:37.429 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:30:37.432 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:30:37.440 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:30:37.443 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:30:37.455 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:30:37.458 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:30:37.475 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:30:37.478 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:30:37.492 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:30:52.378 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:30:52.391 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:30:52.395 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:30:52.404 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:30:52.408 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:30:52.417 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:30:52.419 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:30:52.434 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:30:52.438 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:30:52.446 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:37:23.675 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:37:23.722 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:37:23.726 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:37:23.734 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:37:23.737 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:37:23.742 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:37:23.743 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:37:23.755 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:37:23.757 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:37:23.765 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:37:49.635 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:37:49.645 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:37:49.648 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:37:49.654 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:37:49.656 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:37:49.662 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:37:49.663 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:37:49.674 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:37:49.676 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:37:49.681 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:37:54.489 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:37:54.502 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:37:54.505 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:37:54.511 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:37:54.514 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:37:54.519 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:37:54.520 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:37:54.529 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:37:54.531 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:37:54.538 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:39:20.754 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:39:20.768 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:39:20.770 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:39:20.775 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:39:20.777 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:39:20.783 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:39:20.785 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:39:20.794 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:39:20.796 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:39:20.801 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:42:28.362 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:42:28.372 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:42:28.375 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:42:28.381 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:42:28.383 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:42:28.390 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:42:28.391 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:42:28.401 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:42:28.403 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:42:28.409 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:43:52.719 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:43:52.728 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:43:52.731 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:43:52.736 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:43:52.739 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:43:52.746 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:43:52.747 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:43:52.756 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:43:52.758 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:43:52.765 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:44:14.642 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:44:14.652 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:44:14.654 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:44:14.660 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:44:14.662 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:44:14.668 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:44:14.670 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:44:14.678 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:44:14.680 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:44:14.685 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:44:45.943 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:44:45.952 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:44:45.954 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:44:45.959 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:44:45.961 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:44:45.969 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:44:45.970 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:44:45.980 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:44:45.983 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:44:45.989 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:44:48.509 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:44:48.519 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:44:48.522 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:44:48.527 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:44:48.532 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:44:48.538 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:44:48.539 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:44:48.550 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:44:48.551 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:44:48.556 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:48:20.913 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:48:20.927 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:48:20.929 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:48:20.934 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:48:20.938 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:48:20.949 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:48:20.951 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:48:20.960 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:48:20.963 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:48:20.971 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:51:51.154 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:51:51.167 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:51:51.170 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:51:51.177 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:51:51.179 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:51:51.186 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:51:51.187 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:51:51.196 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:51:51.200 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:51:51.206 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:53:19.134 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:53:19.144 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:53:19.147 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:53:19.152 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:53:19.154 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:53:19.163 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:53:19.164 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:53:19.174 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:53:19.176 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:53:19.183 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:54:09.083 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:54:09.097 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:54:09.099 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:54:09.105 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:54:09.108 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:54:09.114 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:54:09.115 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:54:09.124 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:54:09.126 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:54:09.133 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:56:07.351 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:56:07.367 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:56:07.370 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:56:07.380 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:56:07.383 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:56:07.391 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:56:07.393 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:56:07.409 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:56:07.413 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:56:07.423 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:56:18.423 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:56:18.435 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:56:18.438 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:56:18.444 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:56:18.446 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:56:18.455 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:56:18.458 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:56:18.468 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:56:18.470 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:56:18.476 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:56:30.542 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:56:30.555 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:56:30.559 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:56:30.569 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:56:30.572 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:56:30.589 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:56:30.593 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:56:30.609 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:56:30.614 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:56:30.622 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:57:38.228 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:57:38.236 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:57:38.239 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:57:38.245 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:57:38.248 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:57:38.254 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:57:38.255 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:57:38.264 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:57:38.266 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:57:38.271 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:57:59.098 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:57:59.111 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:57:59.113 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:57:59.120 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:57:59.122 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:57:59.128 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:57:59.129 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:57:59.137 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:57:59.139 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:57:59.145 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:58:30.857 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 17:58:30.872 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:58:30.878 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:58:30.886 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:58:30.889 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:58:30.897 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 17:58:30.898 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 17:58:30.911 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 17:58:30.913 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 17:58:30.922 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:02:54.956 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:02:54.965 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:02:54.968 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:02:54.974 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:02:54.977 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:02:54.985 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:02:54.986 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:02:54.997 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:02:54.999 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:02:55.005 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:04:01.541 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:04:01.552 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:04:01.554 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:04:01.561 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:04:01.563 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:04:01.570 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:04:01.572 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:04:01.587 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:04:01.591 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:04:01.596 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:04:11.258 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:04:11.273 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:04:11.275 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:04:11.285 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:04:11.287 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:04:11.294 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:04:11.295 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:04:11.309 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:04:11.312 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:04:11.320 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:04:35.517 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:04:35.529 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:04:35.532 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:04:35.537 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:04:35.539 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:04:35.546 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:04:35.547 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:04:35.555 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:04:35.557 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:04:35.566 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:08:08.544 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:08:08.560 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:08:08.562 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:08:08.569 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:08:08.571 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:08:08.577 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:08:08.579 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:08:08.588 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:08:08.590 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:08:08.598 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:08:45.977 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:08:45.993 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:08:45.996 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:08:46.003 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:08:46.006 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:08:46.015 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:08:46.017 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:08:46.033 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:08:46.036 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:08:46.046 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:09:03.230 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:09:03.242 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:09:03.244 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:09:03.253 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:09:03.256 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:09:03.265 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:09:03.267 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:09:03.282 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:09:03.286 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:09:03.297 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:10:40.388 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:10:40.401 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:10:40.403 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:10:40.410 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:10:40.413 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:10:40.420 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:10:40.421 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:10:40.431 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:10:40.435 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:10:40.443 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:11:03.377 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:11:03.390 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:11:03.393 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:11:03.400 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:11:03.404 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:11:03.411 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:11:03.413 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:11:03.424 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:11:03.426 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:11:03.432 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:11:11.452 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:11:11.464 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:11:11.467 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:11:11.473 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:11:11.475 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:11:11.482 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:11:11.483 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:11:11.492 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:11:11.494 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:11:11.500 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:13:35.136 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:13:35.152 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:13:35.156 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:13:35.167 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:13:35.171 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:13:35.178 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:13:35.180 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:13:35.188 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:13:35.191 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:13:35.197 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:13:49.221 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:13:49.236 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:13:49.238 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:13:49.247 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:13:49.249 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:13:49.255 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:13:49.256 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:13:49.265 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:13:49.267 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:13:49.272 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:14:46.221 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:14:46.233 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:14:46.236 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:14:46.242 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:14:46.246 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:14:46.253 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:14:46.254 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:14:46.262 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:14:46.264 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:14:46.269 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:15:21.268 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:15:21.284 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:15:21.287 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:15:21.292 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:15:21.294 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:15:21.300 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:15:21.301 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:15:21.309 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:15:21.311 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:15:21.316 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:15:49.684 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:15:49.697 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:15:49.700 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:15:49.708 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:15:49.711 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:15:49.718 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:15:49.719 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:15:49.729 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:15:49.732 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:15:49.739 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:16:12.125 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:16:12.140 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:16:12.143 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:16:12.151 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:16:12.155 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:16:12.163 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:16:12.165 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:16:12.182 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:16:12.184 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:16:12.193 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:17:14.779 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:17:14.791 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:17:14.794 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:17:14.800 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:17:14.802 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:17:14.808 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:17:14.809 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:17:14.816 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:17:14.820 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:17:14.825 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:20:35.366 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:20:35.384 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:20:35.387 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:20:35.396 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:20:35.399 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:20:35.406 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:20:35.407 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:20:35.420 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:20:35.422 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:20:35.431 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:20:47.715 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:20:47.729 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:20:47.735 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:20:47.744 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:20:47.747 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:20:47.759 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:20:47.760 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:20:47.775 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:20:47.778 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:20:47.786 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:21:04.979 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:21:04.996 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:21:05.002 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:21:05.014 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:21:05.017 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:21:05.030 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:21:05.034 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:21:05.050 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:21:05.053 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:21:05.060 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:21:25.698 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:21:25.711 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:21:25.714 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:21:25.725 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:21:25.728 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:21:25.739 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:21:25.741 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:21:25.754 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:21:25.756 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:21:25.763 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:21:40.810 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:21:40.824 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:21:40.830 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:21:40.840 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:21:40.845 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:21:40.856 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:21:40.857 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:21:40.871 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:21:40.877 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:21:40.888 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:21:59.619 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:21:59.633 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:21:59.636 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:21:59.647 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:21:59.650 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:21:59.659 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:21:59.660 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 18:21:59.671 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:21:59.674 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 18:21:59.683 -03:00 [DBG] Found ["UserManagementApi.full_access"] API scopes in database
2018-08-26 18:29:12.810 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 18:29:12.844 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 18:29:12.845 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 18:29:12.845 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 18:29:12.845 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 18:29:12.954 -03:00 [DBG] Starting token cleanup
2018-08-26 18:29:24.431 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 18:29:24.441 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 18:29:24.442 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 18:29:24.445 -03:00 [DBG] Start authorize request
2018-08-26 18:29:24.453 -03:00 [DBG] User in authorize request: cbf2e91b-b1d5-43bd-a848-59c69da6d0a9
2018-08-26 18:29:24.467 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:29:24.874 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:29:24.946 -03:00 [DBG] Found ["openid"] identity scopes in database
2018-08-26 18:29:25.140 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 18:29:25.158 -03:00 [DBG] Found ["openid"] identity scopes in database
2018-08-26 18:29:25.165 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 18:29:25.169 -03:00 [ERR] Requested scope not allowed: UserManagementApi.read_access
2018-08-26 18:29:25.172 -03:00 [ERR] Request validation failed
2018-08-26 18:29:25.184 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "cbf2e91b-b1d5-43bd-a848-59c69da6d0a9",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access openid",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDE4OjI5OjI0IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access openid",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE4OjI5OjI0IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 18:29:25.210 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "Endpoint": "Authorize",
  "SubjectId": "cbf2e91b-b1d5-43bd-a848-59c69da6d0a9",
  "Scopes": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access openid",
  "GrantType": "implicit",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid scope",
  "ActivityId": "0HLGBJBRU8200:00000003",
  "TimeStamp": "2018-08-26T21:29:25Z",
  "ProcessId": 15480,
  "LocalIpAddress": "127.0.0.1:5000",
  "RemoteIpAddress": "127.0.0.1"
}
2018-08-26 18:31:34.875 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 18:31:34.917 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 18:31:34.918 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 18:31:34.919 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 18:31:34.919 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 18:31:35.029 -03:00 [DBG] Starting token cleanup
2018-08-26 18:31:42.249 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 18:31:42.259 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 18:31:42.260 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 18:31:42.264 -03:00 [DBG] Start authorize request
2018-08-26 18:31:42.273 -03:00 [DBG] User in authorize request: cbf2e91b-b1d5-43bd-a848-59c69da6d0a9
2018-08-26 18:31:42.286 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 18:31:42.734 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 18:31:42.794 -03:00 [DBG] Found ["openid"] identity scopes in database
2018-08-26 18:31:42.938 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 18:31:42.956 -03:00 [DBG] Found ["openid"] identity scopes in database
2018-08-26 18:31:42.961 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 18:31:42.965 -03:00 [ERR] Requests for token response type only must include resource scopes, but no identity scopes.
2018-08-26 18:31:42.969 -03:00 [ERR] Request validation failed
2018-08-26 18:31:42.980 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "cbf2e91b-b1d5-43bd-a848-59c69da6d0a9",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access openid",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDE4OjMxOjQyIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access openid",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE4OjMxOjQyIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 18:31:43.014 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "Endpoint": "Authorize",
  "SubjectId": "cbf2e91b-b1d5-43bd-a848-59c69da6d0a9",
  "Scopes": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access openid",
  "GrantType": "implicit",
  "Error": "invalid_scope",
  "ActivityId": "0HLGBJD67KA12:00000002",
  "TimeStamp": "2018-08-26T21:31:43Z",
  "ProcessId": 29096,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 19:01:21.322 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 19:01:21.348 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 19:01:21.349 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 19:01:21.349 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 19:01:21.349 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 19:01:21.444 -03:00 [DBG] Starting token cleanup
2018-08-26 19:01:22.806 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-26 19:01:22.811 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-26 19:01:22.812 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-26 19:01:22.817 -03:00 [INF] Identity.Application was not authenticated. Failure message: No principal.
2018-08-26 19:01:22.835 -03:00 [INF] Identity.Application was not authenticated. Failure message: No principal.
2018-08-26 19:01:29.758 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 19:01:29.767 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 19:01:29.769 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 19:01:29.775 -03:00 [DBG] Start authorize request
2018-08-26 19:01:29.784 -03:00 [DBG] No user present in authorize request
2018-08-26 19:01:29.790 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 19:01:30.212 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 19:01:30.278 -03:00 [DBG] Found ["openid","email"] identity scopes in database
2018-08-26 19:01:30.486 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 19:01:30.503 -03:00 [DBG] Found ["openid","email"] identity scopes in database
2018-08-26 19:01:30.510 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 19:01:30.514 -03:00 [ERR] Requests for token response type only must include resource scopes, but no identity scopes.
2018-08-26 19:01:30.520 -03:00 [ERR] Request validation failed
2018-08-26 19:01:30.534 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access openid email",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDE5OjAxOjI5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access openid email",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE5OjAxOjI5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 19:01:30.558 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "Endpoint": "Authorize",
  "Scopes": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access openid email",
  "GrantType": "implicit",
  "Error": "invalid_scope",
  "ActivityId": "0HLGBJTQNKO2P:00000002",
  "TimeStamp": "2018-08-26T22:01:30Z",
  "ProcessId": 30556,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 19:03:25.731 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 19:03:25.753 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 19:03:25.754 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 19:03:25.754 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 19:03:25.754 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 19:03:25.831 -03:00 [DBG] Starting token cleanup
2018-08-26 19:03:34.991 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 19:03:35.013 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 19:03:35.016 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 19:03:35.022 -03:00 [DBG] Start authorize request
2018-08-26 19:03:35.033 -03:00 [DBG] No user present in authorize request
2018-08-26 19:03:35.047 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 19:03:35.491 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 19:03:35.559 -03:00 [DBG] Found ["openid","email"] identity scopes in database
2018-08-26 19:03:35.756 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 19:03:35.776 -03:00 [DBG] Found ["openid","email"] identity scopes in database
2018-08-26 19:03:35.783 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 19:03:35.788 -03:00 [ERR] Requests for token response type only must include resource scopes, but no identity scopes.
2018-08-26 19:03:35.791 -03:00 [ERR] Request validation failed
2018-08-26 19:03:35.803 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access openid email",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDE5OjAzOjM0IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access openid email",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE5OjAzOjM0IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 19:03:35.833 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "Endpoint": "Authorize",
  "Scopes": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access openid email",
  "GrantType": "implicit",
  "Error": "invalid_scope",
  "ActivityId": "0HLGBJUVN9KMS:00000002",
  "TimeStamp": "2018-08-26T22:03:35Z",
  "ProcessId": 28040,
  "LocalIpAddress": "127.0.0.1:5000",
  "RemoteIpAddress": "127.0.0.1"
}
2018-08-26 19:04:05.305 -03:00 [DBG] TaskCanceledException. Exiting.
2018-08-26 19:04:05.322 -03:00 [DBG] Stopping token cleanup
2018-08-26 19:04:24.873 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 19:04:24.897 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 19:04:24.897 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 19:04:24.897 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 19:04:24.897 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 19:04:24.981 -03:00 [DBG] Starting token cleanup
2018-08-26 19:04:33.460 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 19:04:33.474 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 19:04:33.475 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 19:04:33.478 -03:00 [DBG] Start authorize request
2018-08-26 19:04:33.489 -03:00 [DBG] No user present in authorize request
2018-08-26 19:04:33.503 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 19:04:33.982 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 19:04:34.050 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 19:04:34.241 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 19:04:34.260 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 19:04:34.268 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 19:04:34.276 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 19:04:34.290 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDE5OjA0OjMzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE5OjA0OjMzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 19:04:34.302 -03:00 [INF] Showing login: User is not authenticated
2018-08-26 19:04:34.357 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 19:04:34.367 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 19:04:34.369 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 19:04:34.376 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 19:04:34.379 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 19:04:34.384 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 19:04:34.388 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 19:04:34.401 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 19:04:38.493 -03:00 [INF] AuthenticationScheme: Google was challenged.
2018-08-26 19:04:43.992 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-26 19:04:44.325 -03:00 [INF] User created a new account with password.
2018-08-26 19:04:44.350 -03:00 [INF] User created a new account with password.
2018-08-26 19:04:44.628 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Google",
  "ProviderUserId": "102696868227620762147",
  "SubjectId": "61a5cabb-7b72-4331-b50f-de670ff4dcb2",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGBJVHAI3CG:00000007",
  "TimeStamp": "2018-08-26T22:04:44Z",
  "ProcessId": 11584,
  "LocalIpAddress": "127.0.0.1:5000",
  "RemoteIpAddress": "127.0.0.1"
}
2018-08-26 19:04:44.642 -03:00 [DBG] Augmenting SignInContext
2018-08-26 19:04:44.644 -03:00 [DBG] Adding amr claim with value: external
2018-08-26 19:04:44.650 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-26 19:04:44.658 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-26 19:04:44.682 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-26 19:04:44.686 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-26 19:04:44.687 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-26 19:04:44.692 -03:00 [DBG] Start authorize callback request
2018-08-26 19:04:44.696 -03:00 [DBG] User in authorize request: 61a5cabb-7b72-4331-b50f-de670ff4dcb2
2018-08-26 19:04:44.697 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 19:04:44.707 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 19:04:44.710 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 19:04:44.717 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 19:04:44.720 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 19:04:44.727 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 19:04:44.728 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 19:04:44.730 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "61a5cabb-7b72-4331-b50f-de670ff4dcb2",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDE5OjA0OjMzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "SessionId": "4ee96e42109898bfe90089d35b91d2fa",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE5OjA0OjMzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 19:04:44.795 -03:00 [DBG] BWGaH/fS95QWH/4MoNijTrVW1Ba8zE20FJFCBEA56sg= found in database: false
2018-08-26 19:04:44.797 -03:00 [DBG] user_consent grant with value: UserManagementUI|61a5cabb-7b72-4331-b50f-de670ff4dcb2 not found in store.
2018-08-26 19:04:44.803 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-26 19:04:44.804 -03:00 [INF] Showing consent: User has not yet consented
2018-08-26 19:04:44.842 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 19:04:44.851 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 19:04:44.854 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 19:04:44.860 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 19:04:44.864 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 19:04:44.869 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 19:04:44.871 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 19:04:44.881 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 19:04:44.883 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 19:04:44.891 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 19:05:16.738 -03:00 [DBG] TaskCanceledException. Exiting.
2018-08-26 19:05:16.764 -03:00 [DBG] Stopping token cleanup
2018-08-26 19:59:39.043 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 19:59:39.101 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 19:59:39.104 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 19:59:39.106 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 19:59:39.107 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 19:59:39.246 -03:00 [DBG] Starting token cleanup
2018-08-26 19:59:47.246 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 19:59:47.253 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 19:59:47.254 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 19:59:47.258 -03:00 [DBG] Start authorize request
2018-08-26 19:59:47.270 -03:00 [DBG] User in authorize request: 61a5cabb-7b72-4331-b50f-de670ff4dcb2
2018-08-26 19:59:47.283 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 19:59:47.669 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 19:59:47.727 -03:00 [DBG] Found ["openid"] identity scopes in database
2018-08-26 19:59:47.807 -03:00 [DBG] Found [] API scopes in database
2018-08-26 19:59:47.824 -03:00 [DBG] Found ["openid"] identity scopes in database
2018-08-26 19:59:47.827 -03:00 [DBG] Found [] API scopes in database
2018-08-26 19:59:47.830 -03:00 [ERR] Requests for token response type only must include resource scopes, but no identity scopes.
2018-08-26 19:59:47.833 -03:00 [ERR] Request validation failed
2018-08-26 19:59:47.843 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "61a5cabb-7b72-4331-b50f-de670ff4dcb2",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDE5OjU5OjQ3IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "openid",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE5OjU5OjQ3IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 19:59:47.870 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "Endpoint": "Authorize",
  "SubjectId": "61a5cabb-7b72-4331-b50f-de670ff4dcb2",
  "Scopes": "openid",
  "GrantType": "implicit",
  "Error": "invalid_scope",
  "ActivityId": "0HLGBKUD5CQKL:00000003",
  "TimeStamp": "2018-08-26T22:59:47Z",
  "ProcessId": 28872,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 19:59:54.739 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 19:59:54.744 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 19:59:54.749 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 19:59:54.755 -03:00 [DBG] Start authorize request
2018-08-26 19:59:54.757 -03:00 [DBG] User in authorize request: 61a5cabb-7b72-4331-b50f-de670ff4dcb2
2018-08-26 19:59:54.764 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 19:59:54.780 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 19:59:54.789 -03:00 [DBG] Found ["openid"] identity scopes in database
2018-08-26 19:59:54.932 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 19:59:54.943 -03:00 [DBG] Found ["openid"] identity scopes in database
2018-08-26 19:59:54.951 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 19:59:54.957 -03:00 [ERR] Requests for token response type only must include resource scopes, but no identity scopes.
2018-08-26 19:59:54.958 -03:00 [ERR] Request validation failed
2018-08-26 19:59:54.959 -03:00 [INF] {
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "61a5cabb-7b72-4331-b50f-de670ff4dcb2",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDE5OjU5OjU0IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "openid UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDE5OjU5OjU0IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 19:59:54.965 -03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "Endpoint": "Authorize",
  "SubjectId": "61a5cabb-7b72-4331-b50f-de670ff4dcb2",
  "Scopes": "openid UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access",
  "GrantType": "implicit",
  "Error": "invalid_scope",
  "ActivityId": "0HLGBKUD5CQKL:00000005",
  "TimeStamp": "2018-08-26T22:59:54Z",
  "ProcessId": 28872,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 20:00:33.107 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 20:00:33.112 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 20:00:33.116 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 20:00:33.121 -03:00 [DBG] Start authorize request
2018-08-26 20:00:33.124 -03:00 [DBG] User in authorize request: 61a5cabb-7b72-4331-b50f-de670ff4dcb2
2018-08-26 20:00:33.127 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 20:00:33.138 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:00:33.142 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:00:33.212 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:00:33.215 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:00:33.223 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:00:33.230 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 20:00:33.232 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management OpenId Connect",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "61a5cabb-7b72-4331-b50f-de670ff4dcb2",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDIwOjAwOjMzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "SessionId": "4ee96e42109898bfe90089d35b91d2fa",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDIwOjAwOjMzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 20:00:33.303 -03:00 [DBG] BWGaH/fS95QWH/4MoNijTrVW1Ba8zE20FJFCBEA56sg= found in database: false
2018-08-26 20:00:33.305 -03:00 [DBG] user_consent grant with value: UserManagementUI|61a5cabb-7b72-4331-b50f-de670ff4dcb2 not found in store.
2018-08-26 20:00:33.311 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-26 20:00:33.312 -03:00 [INF] Showing consent: User has not yet consented
2018-08-26 20:00:33.360 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 20:00:33.368 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:00:33.371 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:00:33.378 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:00:33.381 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:00:33.389 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:00:33.390 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 20:00:33.401 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:00:33.403 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:00:33.410 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:06:28.264 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 20:06:28.287 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 20:06:28.288 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 20:06:28.288 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 20:06:28.288 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 20:06:28.372 -03:00 [DBG] Starting token cleanup
2018-08-26 20:06:33.302 -03:00 [DBG] 0 persisted grants found for 61a5cabb-7b72-4331-b50f-de670ff4dcb2
2018-08-26 20:06:37.736 -03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-26 20:06:37.823 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-26 20:06:37.826 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-26 20:06:37.827 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-26 20:06:37.850 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "61a5cabb-7b72-4331-b50f-de670ff4dcb2",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGBL2725RRV:00000004",
  "TimeStamp": "2018-08-26T23:06:37Z",
  "ProcessId": 23400,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 20:06:57.597 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 20:06:57.628 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 20:06:57.629 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 20:06:57.629 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 20:06:57.629 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 20:06:57.730 -03:00 [DBG] Starting token cleanup
2018-08-26 20:07:09.194 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 20:07:09.208 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 20:07:09.209 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 20:07:09.214 -03:00 [DBG] Start authorize request
2018-08-26 20:07:09.224 -03:00 [DBG] No user present in authorize request
2018-08-26 20:07:09.237 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 20:07:09.829 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:07:09.881 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:10.118 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:07:10.141 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:10.149 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:07:10.159 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 20:07:10.173 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.read_access UserManagementApi.write_access UserManagementApi.full_access",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDIwOjA3OjA5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.read_access UserManagementApi.write_access UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDIwOjA3OjA5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 20:07:10.184 -03:00 [INF] Showing login: User is not authenticated
2018-08-26 20:07:10.236 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 20:07:10.247 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:07:10.250 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:10.256 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:07:10.258 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:10.265 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:07:10.267 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 20:07:10.283 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:07:12.323 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-26 20:07:13.258 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-26 20:07:13.568 -03:00 [INF] User created a new account with password.
2018-08-26 20:07:13.591 -03:00 [INF] User created a new account with password.
2018-08-26 20:07:13.858 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGBL2FP3P5C:00000006",
  "TimeStamp": "2018-08-26T23:07:13Z",
  "ProcessId": 6252,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 20:07:13.868 -03:00 [DBG] Augmenting SignInContext
2018-08-26 20:07:13.870 -03:00 [DBG] Adding amr claim with value: external
2018-08-26 20:07:13.876 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-26 20:07:13.882 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-26 20:07:13.905 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-26 20:07:13.907 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-26 20:07:13.908 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-26 20:07:13.913 -03:00 [DBG] Start authorize callback request
2018-08-26 20:07:13.917 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:07:13.919 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 20:07:13.927 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:07:13.929 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:13.936 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:07:13.939 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:13.945 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:07:13.946 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 20:07:13.949 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.read_access UserManagementApi.write_access UserManagementApi.full_access",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDIwOjA3OjA5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "SessionId": "f6933a5634abb3d2b645f6920ce828e1",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.read_access UserManagementApi.write_access UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDIwOjA3OjA5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 20:07:14.012 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: false
2018-08-26 20:07:14.015 -03:00 [DBG] user_consent grant with value: UserManagementUI|42261a5f-a14b-48e5-8533-3b6ca24564e3 not found in store.
2018-08-26 20:07:14.018 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-26 20:07:14.019 -03:00 [INF] Showing consent: User has not yet consented
2018-08-26 20:07:14.058 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 20:07:14.067 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:07:14.070 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:14.076 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:07:14.078 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:14.084 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:07:14.085 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 20:07:14.095 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:07:14.097 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:14.103 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:07:18.370 -03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-26 20:07:18.411 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 20:07:18.421 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:07:18.423 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:18.429 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:07:18.432 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:18.437 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:07:18.438 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 20:07:18.457 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-26 20:07:18.460 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-26 20:07:18.462 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-26 20:07:18.463 -03:00 [DBG] Start authorize callback request
2018-08-26 20:07:18.468 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:07:18.471 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 20:07:18.483 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:07:18.487 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:18.495 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:07:18.501 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:18.509 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:07:18.513 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 20:07:18.515 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.read_access UserManagementApi.write_access UserManagementApi.full_access",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDIwOjA3OjA5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "SessionId": "f6933a5634abb3d2b645f6920ce828e1",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.read_access UserManagementApi.write_access UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDIwOjA3OjA5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 20:07:18.529 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: false
2018-08-26 20:07:18.530 -03:00 [DBG] user_consent grant with value: UserManagementUI|42261a5f-a14b-48e5-8533-3b6ca24564e3 not found in store.
2018-08-26 20:07:18.533 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-26 20:07:18.537 -03:00 [INF] User consented to scopes: ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"]
2018-08-26 20:07:18.540 -03:00 [DBG] User indicated to remember consent for scopes: ["UserManagementApi.read_access","UserManagementApi.write_access","UserManagementApi.full_access"]
2018-08-26 20:07:18.545 -03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:07:18.559 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= not found in database
2018-08-26 20:07:18.602 -03:00 [DBG] Creating Implicit Flow response.
2018-08-26 20:07:18.613 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-26 20:07:18.614 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:07:18.647 -03:00 [DBG] 1Iij0KfoDQDse32PXh9l60wZ6tu8NinVroKu6K8NFSc= not found in database
2018-08-26 20:07:18.663 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "UserManagementApi.read_access UserManagementApi.write_access UserManagementApi.full_access",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "access_token",
      "TokenValue": "****95a6"
    }
  ],
  "ActivityId": "0HLGBL2FP3P5C:0000000A",
  "TimeStamp": "2018-08-26T23:07:18Z",
  "ProcessId": 6252,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 20:07:18.671 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDIwOjA3OjA5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "Scope": "UserManagementApi.read_access UserManagementApi.write_access UserManagementApi.full_access"
}
2018-08-26 20:07:18.686 -03:00 [DBG] Augmenting SignInContext
2018-08-26 20:07:18.686 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-26 20:07:25.237 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 20:07:25.242 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 20:07:25.244 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 20:07:25.252 -03:00 [DBG] Start authorize request
2018-08-26 20:07:25.253 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:07:25.256 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 20:07:25.272 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:07:25.275 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:25.288 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:07:25.293 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:25.305 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:07:25.307 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 20:07:25.313 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.read_access UserManagementApi.write_access UserManagementApi.full_access",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDIwOjA3OjI1IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "SessionId": "f6933a5634abb3d2b645f6920ce828e1",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.read_access UserManagementApi.write_access UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDIwOjA3OjI1IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 20:07:25.342 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-26 20:07:25.349 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-26 20:07:25.350 -03:00 [DBG] Creating Implicit Flow response.
2018-08-26 20:07:25.351 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-26 20:07:25.352 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:07:25.369 -03:00 [DBG] jlc9yMGndLnpRQmOM0sp0Tie/CyUc0hUfEgNNbeXWLA= not found in database
2018-08-26 20:07:25.415 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "UserManagementApi.read_access UserManagementApi.write_access UserManagementApi.full_access",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "access_token",
      "TokenValue": "****401c"
    }
  ],
  "ActivityId": "0HLGBL2FP3P5C:0000000B",
  "TimeStamp": "2018-08-26T23:07:25Z",
  "ProcessId": 6252,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 20:07:25.433 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDIwOjA3OjI1IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "Scope": "UserManagementApi.read_access UserManagementApi.write_access UserManagementApi.full_access"
}
2018-08-26 20:07:38.239 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:07:38.265 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:07:38.268 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:07:38.274 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:12:08.594 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-26 20:12:08.626 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-26 20:12:08.627 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-26 20:12:08.627 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-26 20:12:08.627 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-26 20:12:08.756 -03:00 [DBG] Starting token cleanup
2018-08-26 20:12:13.028 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:12:13.554 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:12:13.598 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:12:13.838 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:12:39.849 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:12:39.869 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:12:39.872 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:12:39.877 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:12:47.365 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:12:47.395 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:12:47.398 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:12:47.408 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:14:45.642 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:14:45.668 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:14:45.671 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:14:45.680 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:14:59.341 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:14:59.370 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:14:59.374 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:14:59.382 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:15:14.688 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:15:14.710 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:15:14.713 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:15:14.719 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:15:20.647 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:15:20.665 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:15:20.667 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:15:20.677 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:15:25.200 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:15:25.220 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:15:25.223 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:15:25.230 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:15:32.028 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:15:32.051 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:15:32.054 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:15:32.062 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:18:14.065 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:18:14.085 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:18:14.087 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:18:14.097 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:18:33.305 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:18:33.331 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:18:33.335 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:18:33.342 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:20:35.140 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:20:35.165 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:20:35.169 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:20:35.179 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:21:03.828 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:21:03.851 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:21:03.856 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:21:03.866 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:21:04.238 -03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The layout page '/Views/Shared/_Layout.cshtml' cannot find the section 'styles' in the content page '/Views/Grants/Index.cshtml'.
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name)
   at AspNetCore.Views_Shared__Layout.<>c__DisplayClass15_0.<<ExecuteAsync>b__1>d.MoveNext() in D:\workspace\JP.Project\src\Backend\Equinox.UI.SSO\Views\Shared\_Layout.cshtml:line 25
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCore.Views_Shared__Layout.ExecuteAsync() in D:\workspace\JP.Project\src\Backend\Equinox.UI.SSO\Views\Shared\_Layout.cshtml:line 9
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2018-08-26 20:21:14.654 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:21:14.680 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:21:14.683 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:21:14.690 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:21:14.768 -03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The layout page '/Views/Shared/_Layout.cshtml' cannot find the section 'styles' in the content page '/Views/Grants/Index.cshtml'.
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name)
   at AspNetCore.Views_Shared__Layout.<>c__DisplayClass15_0.<<ExecuteAsync>b__1>d.MoveNext() in D:\workspace\JP.Project\src\Backend\Equinox.UI.SSO\Views\Shared\_Layout.cshtml:line 25
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCore.Views_Shared__Layout.ExecuteAsync() in D:\workspace\JP.Project\src\Backend\Equinox.UI.SSO\Views\Shared\_Layout.cshtml:line 9
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2018-08-26 20:21:21.504 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:21:21.527 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:21:21.531 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:21:21.538 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:25:39.146 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:25:39.164 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:25:39.166 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:25:39.175 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:25:48.413 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:25:48.434 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:25:48.438 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:25:48.445 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:26:17.548 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:26:17.569 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:26:17.572 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:26:17.578 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:26:22.631 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:26:22.654 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:26:22.659 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:26:22.666 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:27:01.683 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:27:01.704 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:27:01.708 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:27:01.715 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:27:20.761 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:27:20.782 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:27:20.786 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:27:20.794 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:27:44.231 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:27:44.250 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:27:44.252 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:27:44.258 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:29:37.418 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:29:37.441 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:29:37.444 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:29:37.451 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:30:10.426 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:30:10.458 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:30:10.461 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:30:10.468 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:31:35.757 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:31:35.781 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:31:35.785 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:31:35.792 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:31:50.849 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:31:50.871 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:31:50.875 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:31:50.881 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:32:28.731 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:32:28.752 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:32:28.755 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:32:28.762 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:32:31.405 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:32:31.427 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:32:31.430 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:32:31.436 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:32:38.702 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:32:38.734 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:32:38.738 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:32:38.746 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:42:47.652 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:42:47.673 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:42:47.676 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:42:47.682 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 20:42:50.354 -03:00 [DBG] 3 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 20:42:50.377 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 20:42:50.380 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 20:42:50.386 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:12:08.825 -03:00 [INF] Clearing 2 tokens
2018-08-26 21:41:29.215 -03:00 [DBG] 1 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 21:41:29.230 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:41:29.232 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:41:29.240 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:41:39.032 -03:00 [DBG] CORS request made for path: /Grants/Revoke from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-26 21:41:39.096 -03:00 [DBG] removing 1 persisted grants from database for subject 42261a5f-a14b-48e5-8533-3b6ca24564e3, clientId UserManagementUI
2018-08-26 21:41:39.112 -03:00 [DBG] 0 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 21:41:44.216 -03:00 [DBG] 0 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 21:42:25.712 -03:00 [DBG] 0 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 21:42:50.222 -03:00 [DBG] 0 persisted grants found for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 21:42:59.201 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 21:42:59.218 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 21:42:59.220 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 21:42:59.228 -03:00 [DBG] Start authorize request
2018-08-26 21:42:59.240 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 21:42:59.248 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:42:59.269 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:42:59.291 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:42:59.378 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:42:59.390 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:42:59.399 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:42:59.411 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:42:59.428 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.write_access UserManagementApi.read_access UserManagementApi.full_access",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDIxOjQyOjU5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "SessionId": "f6933a5634abb3d2b645f6920ce828e1",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.write_access UserManagementApi.read_access UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDIxOjQyOjU5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 21:42:59.477 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: false
2018-08-26 21:42:59.478 -03:00 [DBG] user_consent grant with value: UserManagementUI|42261a5f-a14b-48e5-8533-3b6ca24564e3 not found in store.
2018-08-26 21:42:59.482 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-26 21:42:59.483 -03:00 [INF] Showing consent: User has not yet consented
2018-08-26 21:42:59.517 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:42:59.527 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:42:59.530 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:42:59.536 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:42:59.538 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:42:59.546 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:42:59.547 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:42:59.557 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:42:59.561 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:42:59.566 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:43:03.526 -03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-26 21:43:03.560 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:43:03.572 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:43:03.576 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:43:03.584 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:43:03.587 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:43:03.594 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:43:03.596 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:43:03.618 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-26 21:43:03.620 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-26 21:43:03.623 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-26 21:43:03.630 -03:00 [DBG] Start authorize callback request
2018-08-26 21:43:03.634 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 21:43:03.635 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:43:03.644 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:43:03.646 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:43:03.653 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:43:03.655 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:43:03.660 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:43:03.662 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:43:03.664 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.write_access UserManagementApi.read_access UserManagementApi.full_access",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDIxOjQyOjU5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "SessionId": "f6933a5634abb3d2b645f6920ce828e1",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.write_access UserManagementApi.read_access UserManagementApi.full_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDIxOjQyOjU5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 21:43:03.674 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: false
2018-08-26 21:43:03.675 -03:00 [DBG] user_consent grant with value: UserManagementUI|42261a5f-a14b-48e5-8533-3b6ca24564e3 not found in store.
2018-08-26 21:43:03.678 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-26 21:43:03.683 -03:00 [INF] User consented to scopes: ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"]
2018-08-26 21:43:03.690 -03:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 21:43:03.696 -03:00 [DBG] no nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= persisted grant found in database
2018-08-26 21:43:03.704 -03:00 [DBG] Creating Implicit Flow response.
2018-08-26 21:43:03.714 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-26 21:43:03.715 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 21:43:03.768 -03:00 [DBG] JjWc/EwNqGqz3XwbSxzYHlRKaYqfr8YimNYpOIm29vM= not found in database
2018-08-26 21:43:03.829 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "UserManagementApi.write_access UserManagementApi.read_access UserManagementApi.full_access",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "access_token",
      "TokenValue": "****9687"
    }
  ],
  "ActivityId": "0HLGBL5CF5VBR:00000013",
  "TimeStamp": "2018-08-27T00:43:03Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 21:43:03.839 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDIxOjQyOjU5IEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "Scope": "UserManagementApi.write_access UserManagementApi.read_access UserManagementApi.full_access"
}
2018-08-26 21:43:13.602 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 21:43:13.610 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 21:43:13.616 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 21:43:13.622 -03:00 [DBG] Start authorize request
2018-08-26 21:43:13.624 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 21:43:13.626 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:43:13.641 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:43:13.645 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:43:13.725 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:43:13.728 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:43:13.734 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:43:13.736 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:43:13.741 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDIxOjQzOjEzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "SessionId": "f6933a5634abb3d2b645f6920ce828e1",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDIxOjQzOjEzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 21:43:13.755 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: false
2018-08-26 21:43:13.756 -03:00 [DBG] user_consent grant with value: UserManagementUI|42261a5f-a14b-48e5-8533-3b6ca24564e3 not found in store.
2018-08-26 21:43:13.758 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-26 21:43:13.758 -03:00 [INF] Showing consent: User has not yet consented
2018-08-26 21:43:13.770 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:43:13.777 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:43:13.780 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:43:13.787 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:43:13.790 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:43:13.798 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:43:13.799 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:43:13.810 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:43:13.814 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:43:13.821 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:44:15.274 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:44:15.291 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:44:15.294 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:44:15.303 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:44:15.306 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:44:15.319 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:44:15.321 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:44:15.334 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:44:15.338 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:44:15.350 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:44:26.878 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:44:26.893 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:44:26.897 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:44:26.908 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:44:26.913 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:44:26.921 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:44:26.923 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:44:26.934 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:44:26.936 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:44:26.944 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:44:41.472 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:44:41.485 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:44:41.488 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:44:41.498 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:44:41.502 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:44:41.510 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:44:41.513 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:44:41.523 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:44:41.528 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:44:41.535 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:44:51.240 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:44:51.252 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:44:51.256 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:44:51.267 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:44:51.271 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:44:51.278 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:44:51.279 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:44:51.289 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:44:51.291 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:44:51.298 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:45:12.531 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:45:12.547 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:45:12.557 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:45:12.569 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:45:12.572 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:45:12.583 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:45:12.585 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:45:12.596 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:45:12.599 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:45:12.608 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:45:36.632 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:45:36.647 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:45:36.650 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:45:36.660 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:45:36.664 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:45:36.669 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:45:36.671 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:45:36.681 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:45:36.684 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:45:36.689 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:45:42.631 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:45:42.646 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:45:42.648 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:45:42.659 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:45:42.662 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:45:42.669 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:45:42.671 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:45:42.678 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:45:42.680 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:45:42.688 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:46:08.160 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:46:08.172 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:46:08.175 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:46:08.180 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:46:08.182 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:46:08.190 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:46:08.192 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:46:08.202 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:46:08.204 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:46:08.212 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:46:34.095 -03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-26 21:46:34.101 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:46:34.113 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:46:34.115 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:46:34.122 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:46:34.125 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:46:34.131 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:46:34.132 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:46:34.147 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-26 21:46:34.149 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-26 21:46:34.152 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-26 21:46:34.154 -03:00 [DBG] Start authorize callback request
2018-08-26 21:46:34.157 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 21:46:34.160 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 21:46:34.174 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 21:46:34.177 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:46:34.187 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:46:34.191 -03:00 [DBG] Found [] identity scopes in database
2018-08-26 21:46:34.197 -03:00 [DBG] Found ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] API scopes in database
2018-08-26 21:46:34.198 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 21:46:34.201 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDIxOjQzOjEzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "SessionId": "f6933a5634abb3d2b645f6920ce828e1",
  "Raw": {
    "response_type": "token",
    "client_id": "UserManagementUI",
    "redirect_uri": "https://localhost:5003/swagger/oauth2-redirect.html",
    "scope": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access",
    "state": "U3VuIEF1ZyAyNiAyMDE4IDIxOjQzOjEzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk="
  }
}
2018-08-26 21:46:34.211 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: false
2018-08-26 21:46:34.212 -03:00 [DBG] user_consent grant with value: UserManagementUI|42261a5f-a14b-48e5-8533-3b6ca24564e3 not found in store.
2018-08-26 21:46:34.215 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-26 21:46:34.216 -03:00 [INF] User consented to scopes: ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"]
2018-08-26 21:46:34.218 -03:00 [DBG] User indicated to remember consent for scopes: ["UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"]
2018-08-26 21:46:34.219 -03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 21:46:34.226 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= not found in database
2018-08-26 21:46:34.250 -03:00 [DBG] Creating Implicit Flow response.
2018-08-26 21:46:34.251 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-26 21:46:34.253 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 21:46:34.264 -03:00 [DBG] DvAdw4tfT5JMUe+681vX+0liklbqNVefdwhVUgcrkeQ= not found in database
2018-08-26 21:46:34.270 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "access_token",
      "TokenValue": "****7a13"
    }
  ],
  "ActivityId": "0HLGBL5CF5VBS:0000000D",
  "TimeStamp": "2018-08-27T00:46:34Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 21:46:34.275 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "https://localhost:5003/swagger/oauth2-redirect.html",
  "State": "U3VuIEF1ZyAyNiAyMDE4IDIxOjQzOjEzIEdNVC0wMzAwIChIb3LDoXJpbyBQYWRyw6NvIGRlIEJyYXPDrWxpYSk=",
  "Scope": "UserManagementApi.full_access UserManagementApi.read_access UserManagementApi.write_access"
}
2018-08-26 21:55:48.785 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-26 21:55:55.012 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-26 21:55:56.160 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-26 21:55:57.038 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-26 21:56:03.253 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-26 21:56:07.223 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-26 21:57:26.126 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-26 22:12:08.987 -03:00 [INF] Clearing 0 tokens
2018-08-26 23:12:09.086 -03:00 [INF] Clearing 2 tokens
2018-08-26 23:31:50.534 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:31:50.679 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:31:50.681 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:31:50.690 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:31:50.699 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:31:50.700 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:31:50.710 -03:00 [DBG] Start discovery request
2018-08-26 23:31:50.832 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:31:50.870 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:31:50.880 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:31:50.881 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:31:50.882 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:31:50.890 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:31:50.893 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:31:50.901 -03:00 [DBG] Start key discovery request
2018-08-26 23:33:02.266 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:33:02.271 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:33:02.275 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:33:02.279 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:33:02.282 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:33:02.286 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:33:02.288 -03:00 [DBG] Start discovery request
2018-08-26 23:33:02.304 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:33:02.380 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:33:02.384 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:33:02.386 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:33:02.387 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:33:02.392 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:33:02.395 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:33:02.398 -03:00 [DBG] Start key discovery request
2018-08-26 23:33:06.945 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:33:06.948 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:33:06.950 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:33:06.951 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:33:06.956 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:33:06.960 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:33:06.962 -03:00 [DBG] Start discovery request
2018-08-26 23:33:06.976 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:33:07.120 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:33:07.127 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:33:07.129 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:33:07.131 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:33:07.133 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:33:07.139 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:33:07.142 -03:00 [DBG] Start key discovery request
2018-08-26 23:33:22.261 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:33:22.271 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:33:22.275 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:33:22.282 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:33:22.287 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:33:22.290 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:33:22.297 -03:00 [DBG] Start discovery request
2018-08-26 23:33:22.312 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:33:22.366 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:33:22.371 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:33:22.373 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:33:22.375 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:33:22.379 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:33:22.381 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:33:22.382 -03:00 [DBG] Start key discovery request
2018-08-26 23:33:51.302 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:33:51.306 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:33:51.308 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:33:51.310 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:33:51.313 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:33:51.319 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:33:51.326 -03:00 [DBG] Start discovery request
2018-08-26 23:33:51.341 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:33:51.435 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:33:51.442 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:33:51.444 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:33:51.444 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:33:51.452 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:33:51.454 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:33:51.458 -03:00 [DBG] Start key discovery request
2018-08-26 23:34:11.990 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:34:11.994 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:34:11.995 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:34:11.999 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:34:12.001 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:34:12.006 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:34:12.008 -03:00 [DBG] Start discovery request
2018-08-26 23:34:12.022 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:34:12.107 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:34:12.112 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:34:12.113 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:34:12.114 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:34:12.115 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:34:12.119 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:34:12.122 -03:00 [DBG] Start key discovery request
2018-08-26 23:34:31.296 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:34:31.300 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:34:31.302 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:34:31.302 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:34:31.304 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:34:31.306 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:34:31.310 -03:00 [DBG] Start discovery request
2018-08-26 23:34:31.325 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:34:31.371 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:34:31.376 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:34:31.378 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:34:31.379 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:34:31.383 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:34:31.387 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:34:31.389 -03:00 [DBG] Start key discovery request
2018-08-26 23:35:06.241 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:35:06.244 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:35:06.249 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:35:06.251 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:35:06.255 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:35:06.257 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:35:06.259 -03:00 [DBG] Start discovery request
2018-08-26 23:35:06.276 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:35:06.333 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:35:06.339 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:35:06.341 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:35:06.344 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:35:06.350 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:35:06.353 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:35:06.356 -03:00 [DBG] Start key discovery request
2018-08-26 23:35:36.833 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:35:36.837 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:35:36.839 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:35:36.840 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:35:36.843 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:35:36.847 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:35:36.851 -03:00 [DBG] Start discovery request
2018-08-26 23:35:36.866 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:35:36.946 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:35:36.951 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:35:36.952 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:35:36.954 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:35:36.956 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:35:36.962 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:35:36.965 -03:00 [DBG] Start key discovery request
2018-08-26 23:35:56.431 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:35:56.442 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:35:56.444 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:35:56.446 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:35:56.449 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:35:56.453 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:35:56.458 -03:00 [DBG] Start discovery request
2018-08-26 23:35:56.478 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:35:56.566 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:35:56.573 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:35:56.576 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:35:56.578 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:35:56.584 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:35:56.586 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:35:56.593 -03:00 [DBG] Start key discovery request
2018-08-26 23:36:04.371 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:36:04.375 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:36:04.377 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:36:04.377 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:36:04.379 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:36:04.380 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:36:04.381 -03:00 [DBG] Start discovery request
2018-08-26 23:36:04.395 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:36:04.444 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:36:04.449 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:36:04.451 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:36:04.453 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:36:04.456 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:36:04.459 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:36:04.462 -03:00 [DBG] Start key discovery request
2018-08-26 23:36:24.133 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:36:24.138 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:36:24.140 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:36:24.141 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:36:24.144 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:36:24.147 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:36:24.149 -03:00 [DBG] Start discovery request
2018-08-26 23:36:24.165 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:36:24.316 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:36:24.327 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:36:24.329 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:36:24.331 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:36:24.335 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:36:24.339 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:36:24.341 -03:00 [DBG] Start key discovery request
2018-08-26 23:36:27.780 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:36:27.783 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:36:27.785 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:36:27.785 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:36:27.787 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:36:27.789 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:36:27.794 -03:00 [DBG] Start discovery request
2018-08-26 23:36:27.807 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:36:27.840 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:36:27.845 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:36:27.847 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:36:27.849 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:36:27.852 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:36:27.857 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:36:27.859 -03:00 [DBG] Start key discovery request
2018-08-26 23:36:37.815 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:36:37.820 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:36:37.826 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:36:37.830 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:36:37.835 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:36:37.839 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:36:37.850 -03:00 [DBG] Start discovery request
2018-08-26 23:36:37.868 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:36:37.964 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:36:37.969 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:36:37.971 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:36:37.974 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:36:37.979 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:36:37.983 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:36:37.985 -03:00 [DBG] Start key discovery request
2018-08-26 23:37:28.325 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:37:28.328 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:37:28.329 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:37:28.330 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:37:28.331 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:37:28.332 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:37:28.334 -03:00 [DBG] Start discovery request
2018-08-26 23:37:28.349 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:37:28.401 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:37:28.408 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:37:28.411 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:37:28.412 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:37:28.419 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:37:28.422 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:37:28.426 -03:00 [DBG] Start key discovery request
2018-08-26 23:37:54.074 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:37:54.077 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:37:54.079 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:37:54.079 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:37:54.080 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:37:54.081 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:37:54.083 -03:00 [DBG] Start discovery request
2018-08-26 23:37:54.099 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:37:54.143 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:37:54.148 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:37:54.152 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:37:54.152 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:37:54.155 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:37:54.159 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:37:54.160 -03:00 [DBG] Start key discovery request
2018-08-26 23:37:59.677 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:37:59.685 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:37:59.686 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:37:59.689 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:37:59.692 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:37:59.694 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:37:59.697 -03:00 [DBG] Start discovery request
2018-08-26 23:37:59.714 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:37:59.747 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:37:59.751 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:37:59.752 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:37:59.754 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:37:59.757 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:37:59.762 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:37:59.764 -03:00 [DBG] Start key discovery request
2018-08-26 23:38:02.762 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 23:38:02.766 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 23:38:02.769 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 23:38:02.770 -03:00 [DBG] Start authorize request
2018-08-26 23:38:02.772 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 23:38:02.773 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:38:02.787 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:38:02.797 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:38:02.805 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:38:02.811 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:38:02.815 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:38:02.816 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:38:02.817 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "htqITnvjfEYGuS03AX7CtlCLFaK6ezehfoJ1no4E;login",
  "Nonce": "htqITnvjfEYGuS03AX7CtlCLFaK6ezehfoJ1no4E",
  "SessionId": "f6933a5634abb3d2b645f6920ce828e1",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "htqITnvjfEYGuS03AX7CtlCLFaK6ezehfoJ1no4E;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "htqITnvjfEYGuS03AX7CtlCLFaK6ezehfoJ1no4E"
  }
}
2018-08-26 23:38:02.827 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-26 23:38:02.833 -03:00 [DBG] Consent found in consent store is different than current request, consent is required
2018-08-26 23:38:02.834 -03:00 [INF] Showing consent: User has not yet consented
2018-08-26 23:38:02.854 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:38:02.862 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:38:02.866 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:38:02.869 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:38:02.873 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:38:02.876 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:38:02.878 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:38:02.887 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:38:02.890 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:38:02.893 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:38:54.647 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:38:54.659 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:38:54.664 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:38:54.668 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:38:54.673 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:38:54.676 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:38:54.678 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:38:54.692 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:38:54.698 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:38:54.703 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:39:04.950 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:39:04.962 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:39:04.977 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:39:04.981 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:39:04.987 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:39:04.992 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:39:04.993 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:39:05.006 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:39:05.011 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:39:05.015 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:39:25.352 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:39:25.369 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:39:25.374 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:39:25.377 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:39:25.382 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:39:25.386 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:39:25.388 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:39:25.399 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:39:25.405 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:39:25.408 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:41:08.725 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:41:08.740 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:41:08.746 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:41:08.752 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:41:08.757 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:41:08.761 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:41:08.763 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:41:08.778 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:41:08.783 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:41:08.788 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:41:40.439 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:41:40.455 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:41:40.459 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:41:40.461 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:41:40.465 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:41:40.468 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:41:40.469 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:41:40.478 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:41:40.481 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:41:40.484 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:42:36.599 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:42:36.622 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:42:36.628 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:42:36.633 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:42:36.640 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:42:36.645 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:42:36.647 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:42:36.661 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:42:36.666 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:42:36.673 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:42:55.393 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:42:55.408 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:42:55.411 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:42:55.415 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:42:55.419 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:42:55.423 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:42:55.424 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:42:55.436 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:42:55.440 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:42:55.443 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:43:48.755 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:43:48.768 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:43:48.772 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:43:48.774 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:43:48.778 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:43:48.782 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:43:48.783 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:43:48.791 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:43:48.794 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:43:48.797 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:44:00.329 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:44:00.342 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:44:00.347 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:44:00.352 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:44:00.360 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:44:00.365 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:44:00.367 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:44:00.381 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:44:00.386 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:44:00.391 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:44:10.786 -03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-26 23:44:10.793 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:44:10.806 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:44:10.810 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:44:10.814 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:44:10.818 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:44:10.820 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:44:10.824 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:44:10.832 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-26 23:44:10.835 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-26 23:44:10.837 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-26 23:44:10.839 -03:00 [DBG] Start authorize callback request
2018-08-26 23:44:10.840 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 23:44:10.844 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:44:10.859 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:44:10.864 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:44:10.867 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:44:10.872 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:44:10.875 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:44:10.877 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:44:10.880 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "htqITnvjfEYGuS03AX7CtlCLFaK6ezehfoJ1no4E;login",
  "Nonce": "htqITnvjfEYGuS03AX7CtlCLFaK6ezehfoJ1no4E",
  "SessionId": "f6933a5634abb3d2b645f6920ce828e1",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "htqITnvjfEYGuS03AX7CtlCLFaK6ezehfoJ1no4E;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "htqITnvjfEYGuS03AX7CtlCLFaK6ezehfoJ1no4E"
  }
}
2018-08-26 23:44:10.893 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-26 23:44:10.899 -03:00 [DBG] Consent found in consent store is different than current request, consent is required
2018-08-26 23:44:10.901 -03:00 [INF] User consented to scopes: ["openid","profile","email"]
2018-08-26 23:44:10.903 -03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email"]
2018-08-26 23:44:10.906 -03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 23:44:10.912 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database
2018-08-26 23:44:10.938 -03:00 [DBG] Creating Implicit Flow response.
2018-08-26 23:44:10.939 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-26 23:44:10.941 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 23:44:10.959 -03:00 [DBG] XAY2987qNkkhI5GglBlQD+iJwy56VVdKIaeiHWMiveY= not found in database
2018-08-26 23:44:10.982 -03:00 [DBG] Getting claims for identity token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3 and client: UserManagementUI
2018-08-26 23:44:10.985 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-26 23:44:11.090 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****6Dzg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****46a7"
    }
  ],
  "ActivityId": "0HLGBL5CF5VC1:00000016",
  "TimeStamp": "2018-08-27T02:44:11Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 23:44:11.102 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "htqITnvjfEYGuS03AX7CtlCLFaK6ezehfoJ1no4E;login",
  "Scope": "openid profile email"
}
2018-08-26 23:44:12.812 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:44:12.815 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:44:12.816 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:44:12.817 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:44:12.818 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:44:12.821 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:44:12.829 -03:00 [DBG] Start discovery request
2018-08-26 23:44:12.840 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:44:12.886 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:44:12.890 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:44:12.892 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:44:12.894 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:44:12.897 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:44:12.901 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:44:12.902 -03:00 [DBG] Start key discovery request
2018-08-26 23:45:30.173 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:45:30.177 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:45:30.178 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:45:30.179 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:45:30.182 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:45:30.185 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:45:30.191 -03:00 [DBG] Start discovery request
2018-08-26 23:45:30.205 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:45:30.266 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:45:30.272 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:45:30.273 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:45:30.274 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:45:30.277 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:45:30.281 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:45:30.283 -03:00 [DBG] Start key discovery request
2018-08-26 23:45:32.736 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 23:45:32.741 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 23:45:32.744 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 23:45:32.745 -03:00 [DBG] Start authorize request
2018-08-26 23:45:32.746 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 23:45:32.747 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:45:32.759 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:45:32.763 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:45:32.766 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:45:32.769 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:45:32.772 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:45:32.774 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:45:32.775 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "jeOdHGfboA1JnLxbnizDSNbTKHvseBM7aKNw6U7q;login",
  "Nonce": "jeOdHGfboA1JnLxbnizDSNbTKHvseBM7aKNw6U7q",
  "SessionId": "f6933a5634abb3d2b645f6920ce828e1",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "jeOdHGfboA1JnLxbnizDSNbTKHvseBM7aKNw6U7q;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "jeOdHGfboA1JnLxbnizDSNbTKHvseBM7aKNw6U7q"
  }
}
2018-08-26 23:45:32.787 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-26 23:45:32.791 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-26 23:45:32.793 -03:00 [DBG] Creating Implicit Flow response.
2018-08-26 23:45:32.794 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-26 23:45:32.795 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 23:45:32.808 -03:00 [DBG] 8S9kPRl8FsDmHlyoqP+rR/v8fIRjGBgGqpAkWaSWJsc= not found in database
2018-08-26 23:45:32.821 -03:00 [DBG] Getting claims for identity token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3 and client: UserManagementUI
2018-08-26 23:45:32.823 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-26 23:45:32.828 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****SxBw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****12a5"
    }
  ],
  "ActivityId": "0HLGBL5CF5VC1:00000017",
  "TimeStamp": "2018-08-27T02:45:32Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 23:45:32.831 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "jeOdHGfboA1JnLxbnizDSNbTKHvseBM7aKNw6U7q;login",
  "Scope": "openid profile email"
}
2018-08-26 23:45:34.165 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:45:34.170 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:45:34.171 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:45:34.173 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:45:34.176 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:45:34.179 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:45:34.182 -03:00 [DBG] Start discovery request
2018-08-26 23:45:34.194 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:45:34.220 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:45:34.225 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:45:34.227 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:45:34.228 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:45:34.234 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:45:34.236 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:45:34.239 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:45:34.239 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:45:34.241 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:45:34.243 -03:00 [DBG] Start discovery request
2018-08-26 23:45:34.244 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:45:34.254 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:45:34.257 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:45:34.260 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:45:34.263 -03:00 [DBG] Start key discovery request
2018-08-26 23:45:34.321 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:45:34.325 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:45:34.327 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:45:34.329 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:45:34.332 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:45:34.336 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:45:34.338 -03:00 [DBG] Start key discovery request
2018-08-26 23:45:49.523 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:45:49.527 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:45:49.531 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:45:49.531 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:45:49.534 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:45:49.539 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:45:49.540 -03:00 [DBG] Start discovery request
2018-08-26 23:45:49.553 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:45:49.578 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:45:49.585 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:45:49.587 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:45:49.589 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:45:49.589 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:45:49.597 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:45:49.598 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:45:49.600 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:45:49.603 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:45:49.606 -03:00 [DBG] Start discovery request
2018-08-26 23:45:49.607 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:45:49.610 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:45:49.613 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:45:49.618 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:45:49.619 -03:00 [DBG] Start key discovery request
2018-08-26 23:45:49.682 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:45:49.687 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:45:49.689 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:45:49.690 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:45:49.691 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:45:49.697 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:45:49.699 -03:00 [DBG] Start key discovery request
2018-08-26 23:46:06.828 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:46:06.833 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:46:06.835 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:46:06.836 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:46:06.839 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:46:06.845 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:46:06.847 -03:00 [DBG] Start discovery request
2018-08-26 23:46:06.860 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:46:06.878 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:46:06.881 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:46:06.882 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:46:06.885 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:46:06.886 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:46:06.889 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:46:06.890 -03:00 [DBG] Start key discovery request
2018-08-26 23:46:09.054 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-26 23:46:09.062 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-26 23:46:09.064 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-26 23:46:09.074 -03:00 [DBG] Processing signout request for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 23:46:09.081 -03:00 [DBG] Start end session request validation
2018-08-26 23:46:09.089 -03:00 [DBG] Start identity token validation
2018-08-26 23:46:09.112 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:46:09.114 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-26 23:46:09.164 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-26 23:46:09.170 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535337932,
    "exp": 1535338232,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "jeOdHGfboA1JnLxbnizDSNbTKHvseBM7aKNw6U7q",
    "iat": 1535337932,
    "at_hash": "RhBcaqGbz5j0Xxkq_Y96bA",
    "sid": "f6933a5634abb3d2b645f6920ce828e1",
    "sub": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
    "auth_time": 1535324833,
    "idp": "Facebook",
    "amr": "external"
  }
}
2018-08-26 23:46:09.177 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzMzc5MzIsImV4cCI6MTUzNTMzODIzMiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiamVPZEhHZmJvQTFKbkx4Ym5pekRTTmJUS0h2c2VCTTdhS053NlU3cSIsImlhdCI6MTUzNTMzNzkzMiwiYXRfaGFzaCI6IlJoQmNhcUdiejVqMFh4a3FfWTk2YkEiLCJzaWQiOiJmNjkzM2E1NjM0YWJiM2QyYjY0NWY2OTIwY2U4MjhlMSIsInN1YiI6IjQyMjYxYTVmLWExNGItNDhlNS04NTMzLTNiNmNhMjQ1NjRlMyIsImF1dGhfdGltZSI6MTUzNTMyNDgzMywiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.XE7fBwKHumcKjwcL_y9XMFdlxibmKeqJvCu0v5Y6bLMiiJ3ywEo-LeDD_sJuxYg-1NfwGTFtIS5FB6y0sqZcZrXtEjht_7-x6ce9_5cDw9fdWh1MBUjTe2YgvHCjcOvx2D_83mGiDRVx-HSn7wvXM2vukaseGEL8pw4N6U9nbQ_eU-8jXte2tkB6xYt1iUlmKMDeGlSmbnigmNU7UfjqDQ5VIIgC2aTdFHjeKWqpOjku9h-8uP_f_eaUeQ6v4isRDyh0LP0BHImntHNHr01cbjOAzwYxEIJVeQsmX8Nq5uvsokDPSFmFMLFSaU-N7uRkSfZ4nvl0V7pSBV-igRSxBw",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-26 23:46:09.183 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-26 23:46:09.325 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-26 23:46:09.331 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-26 23:46:09.333 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-26 23:46:09.340 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGBL5CF5VC1:00000019",
  "TimeStamp": "2018-08-27T02:46:09Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 23:46:10.163 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-26 23:46:10.172 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-26 23:46:10.173 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-26 23:46:10.180 -03:00 [DBG] Processing signout callback request
2018-08-26 23:46:10.204 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:46:10.206 -03:00 [DBG] No client front-channel logout URLs
2018-08-26 23:46:10.207 -03:00 [DBG] No client back-channel logout URLs
2018-08-26 23:46:10.208 -03:00 [INF] Successful signout callback.
2018-08-26 23:46:10.209 -03:00 [DBG] No client front-channel iframe urls
2018-08-26 23:46:10.211 -03:00 [DBG] No client back-channel iframe urls
2018-08-26 23:46:13.600 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:46:13.604 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:46:13.608 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:46:13.608 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:46:13.610 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:46:13.615 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:46:13.618 -03:00 [DBG] Start discovery request
2018-08-26 23:46:13.630 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:46:13.664 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:46:13.671 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:46:13.673 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:46:13.674 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:46:13.677 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:46:13.678 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:46:13.680 -03:00 [DBG] Start key discovery request
2018-08-26 23:46:21.297 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 23:46:21.301 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 23:46:21.303 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 23:46:21.304 -03:00 [DBG] Start authorize request
2018-08-26 23:46:21.305 -03:00 [DBG] No user present in authorize request
2018-08-26 23:46:21.306 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:46:21.320 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:46:21.325 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:46:21.329 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:46:21.336 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:46:21.338 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:46:21.342 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:46:21.343 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "Dcjs638UWxIySBJNcQIOQQYlwlp5VrBj9A41hjqS;login",
  "Nonce": "Dcjs638UWxIySBJNcQIOQQYlwlp5VrBj9A41hjqS",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "Dcjs638UWxIySBJNcQIOQQYlwlp5VrBj9A41hjqS;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "Dcjs638UWxIySBJNcQIOQQYlwlp5VrBj9A41hjqS"
  }
}
2018-08-26 23:46:21.348 -03:00 [INF] Showing login: User is not authenticated
2018-08-26 23:46:21.369 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:46:21.384 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:46:21.388 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:46:21.393 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:46:21.398 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:46:21.401 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:46:21.403 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:46:21.414 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:46:31.171 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-26 23:46:32.277 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-26 23:46:32.377 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGBL5CF5VC2:00000016",
  "TimeStamp": "2018-08-27T02:46:32Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 23:46:32.389 -03:00 [DBG] Augmenting SignInContext
2018-08-26 23:46:32.391 -03:00 [DBG] Adding amr claim with value: external
2018-08-26 23:46:32.393 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-26 23:46:32.395 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-26 23:46:32.411 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-26 23:46:32.414 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-26 23:46:32.414 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-26 23:46:32.416 -03:00 [DBG] Start authorize callback request
2018-08-26 23:46:32.418 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 23:46:32.419 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:46:32.428 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:46:32.431 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:46:32.436 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:46:32.438 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:46:32.441 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:46:32.443 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:46:32.445 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "Dcjs638UWxIySBJNcQIOQQYlwlp5VrBj9A41hjqS;login",
  "Nonce": "Dcjs638UWxIySBJNcQIOQQYlwlp5VrBj9A41hjqS",
  "SessionId": "eb0e7ae566c4ecb4daac55749705676b",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "Dcjs638UWxIySBJNcQIOQQYlwlp5VrBj9A41hjqS;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "Dcjs638UWxIySBJNcQIOQQYlwlp5VrBj9A41hjqS"
  }
}
2018-08-26 23:46:32.456 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-26 23:46:32.460 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-26 23:46:32.461 -03:00 [DBG] Creating Implicit Flow response.
2018-08-26 23:46:32.462 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-26 23:46:32.463 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 23:46:32.476 -03:00 [DBG] ZdRMpDYEL1ZCePN7clInHA02WWh3GFIRKL4nttOX4+E= not found in database
2018-08-26 23:46:32.486 -03:00 [DBG] Getting claims for identity token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3 and client: UserManagementUI
2018-08-26 23:46:32.487 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-26 23:46:32.491 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****dCoQ"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****f377"
    }
  ],
  "ActivityId": "0HLGBL5CF5VC2:00000017",
  "TimeStamp": "2018-08-27T02:46:32Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 23:46:32.494 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "Dcjs638UWxIySBJNcQIOQQYlwlp5VrBj9A41hjqS;login",
  "Scope": "openid profile email"
}
2018-08-26 23:46:32.503 -03:00 [DBG] Augmenting SignInContext
2018-08-26 23:46:32.504 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-26 23:46:34.147 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:46:34.150 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:46:34.152 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:46:34.153 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:46:34.155 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:46:34.160 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:46:34.162 -03:00 [DBG] Start discovery request
2018-08-26 23:46:34.175 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:46:34.207 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:46:34.213 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:46:34.215 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:46:34.217 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:46:34.221 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:46:34.224 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:46:34.226 -03:00 [DBG] Start discovery request
2018-08-26 23:46:34.230 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:46:34.237 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:46:34.291 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:46:34.294 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:46:34.296 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:46:34.298 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:46:34.301 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:46:34.304 -03:00 [DBG] Start key discovery request
2018-08-26 23:46:34.313 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:46:34.316 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:46:34.318 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:46:34.318 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:46:34.321 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:46:34.323 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:46:34.329 -03:00 [DBG] Start key discovery request
2018-08-26 23:46:44.602 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:46:44.609 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:46:44.610 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:46:44.612 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:46:44.615 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:46:44.618 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:46:44.626 -03:00 [DBG] Start discovery request
2018-08-26 23:46:44.639 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:46:44.729 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:46:44.734 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:46:44.736 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:46:44.738 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:46:44.742 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:46:44.744 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:46:44.750 -03:00 [DBG] Start key discovery request
2018-08-26 23:46:52.512 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:46:52.515 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:46:52.516 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:46:52.517 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:46:52.519 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:46:52.520 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:46:52.522 -03:00 [DBG] Start discovery request
2018-08-26 23:46:52.535 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:46:52.563 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:46:52.569 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:46:52.570 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:46:52.572 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:46:52.578 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:46:52.580 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:46:52.582 -03:00 [DBG] Start key discovery request
2018-08-26 23:46:59.593 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:46:59.597 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:46:59.598 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:46:59.599 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:46:59.601 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:46:59.605 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:46:59.609 -03:00 [DBG] Start discovery request
2018-08-26 23:46:59.621 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:46:59.647 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:46:59.653 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:46:59.655 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:46:59.657 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:46:59.662 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:46:59.667 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:46:59.669 -03:00 [DBG] Start key discovery request
2018-08-26 23:47:10.331 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:47:10.336 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:47:10.338 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:47:10.340 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:47:10.345 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:47:10.369 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:47:10.375 -03:00 [DBG] Start discovery request
2018-08-26 23:47:10.388 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:47:10.431 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:47:10.437 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:47:10.440 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:47:10.441 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:47:10.445 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:47:10.450 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:47:10.452 -03:00 [DBG] Start key discovery request
2018-08-26 23:47:14.697 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:47:14.700 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:47:14.702 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:47:14.703 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:47:14.704 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:47:14.707 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:47:14.711 -03:00 [DBG] Start discovery request
2018-08-26 23:47:14.724 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:47:14.757 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:47:14.763 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:47:14.765 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:47:14.767 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:47:14.771 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:47:14.773 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:47:14.777 -03:00 [DBG] Start key discovery request
2018-08-26 23:47:18.623 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:47:18.627 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:47:18.629 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:47:18.631 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:47:18.632 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:47:18.638 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:47:18.640 -03:00 [DBG] Start discovery request
2018-08-26 23:47:18.654 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:47:18.750 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:47:18.756 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:47:18.758 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:47:18.761 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:47:18.767 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:47:18.770 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:47:18.772 -03:00 [DBG] Start key discovery request
2018-08-26 23:48:47.508 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:48:47.516 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:48:47.518 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:48:47.520 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:48:47.524 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:48:47.528 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:48:47.533 -03:00 [DBG] Start discovery request
2018-08-26 23:48:47.548 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:48:47.580 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:48:47.584 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:48:47.585 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:48:47.587 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:48:47.591 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:48:47.596 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:48:47.598 -03:00 [DBG] Start key discovery request
2018-08-26 23:50:38.441 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:50:38.447 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:50:38.449 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:50:38.451 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:50:38.456 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:50:38.458 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:50:38.459 -03:00 [DBG] Start discovery request
2018-08-26 23:50:38.470 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:50:38.525 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:50:38.534 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:50:38.535 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:50:38.537 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:50:38.540 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:50:38.545 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:50:38.549 -03:00 [DBG] Start key discovery request
2018-08-26 23:50:49.289 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:50:49.298 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:50:49.300 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:50:49.302 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:50:49.305 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:50:49.306 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:50:49.308 -03:00 [DBG] Start discovery request
2018-08-26 23:50:49.322 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:50:49.405 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:50:49.410 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:50:49.411 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:50:49.412 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:50:49.414 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:50:49.415 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:50:49.421 -03:00 [DBG] Start key discovery request
2018-08-26 23:51:03.116 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:51:03.126 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:51:03.129 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:51:03.131 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:51:03.133 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:51:03.136 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:51:03.141 -03:00 [DBG] Start discovery request
2018-08-26 23:51:03.152 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:51:03.223 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:51:03.231 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:51:03.232 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:51:03.236 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:51:03.238 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:51:03.241 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:51:03.245 -03:00 [DBG] Start key discovery request
2018-08-26 23:51:09.933 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:51:09.942 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:51:09.944 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:51:09.946 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:51:09.951 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:51:09.953 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:51:09.955 -03:00 [DBG] Start discovery request
2018-08-26 23:51:09.969 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:51:10.068 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:51:10.072 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:51:10.075 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:51:10.077 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:51:10.081 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:51:10.084 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:51:10.086 -03:00 [DBG] Start key discovery request
2018-08-26 23:51:13.971 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-26 23:51:13.974 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-26 23:51:13.978 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-26 23:51:13.982 -03:00 [DBG] Processing signout request for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 23:51:13.985 -03:00 [DBG] Start end session request validation
2018-08-26 23:51:13.988 -03:00 [DBG] Start identity token validation
2018-08-26 23:51:14.000 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:51:14.001 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-26 23:51:14.016 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-26 23:51:14.017 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535337992,
    "exp": 1535338292,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "Dcjs638UWxIySBJNcQIOQQYlwlp5VrBj9A41hjqS",
    "iat": 1535337992,
    "at_hash": "5V8daimqqbr9zIrWTGQz-A",
    "sid": "eb0e7ae566c4ecb4daac55749705676b",
    "sub": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
    "auth_time": 1535337992,
    "idp": "Facebook",
    "amr": "external"
  }
}
2018-08-26 23:51:14.023 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzMzc5OTIsImV4cCI6MTUzNTMzODI5MiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiRGNqczYzOFVXeEl5U0JKTmNRSU9RUVlsd2xwNVZyQmo5QTQxaGpxUyIsImlhdCI6MTUzNTMzNzk5MiwiYXRfaGFzaCI6IjVWOGRhaW1xcWJyOXpJcldUR1F6LUEiLCJzaWQiOiJlYjBlN2FlNTY2YzRlY2I0ZGFhYzU1NzQ5NzA1Njc2YiIsInN1YiI6IjQyMjYxYTVmLWExNGItNDhlNS04NTMzLTNiNmNhMjQ1NjRlMyIsImF1dGhfdGltZSI6MTUzNTMzNzk5MiwiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.i9fB_RckNQgf_g6z5M9W45gLc9cWCOD8rEuVqq_RYMX0XvVr0LHatBinOWb8TRIAYgm1ecHTr8V_mF4c__8ngCgoyTkt-5nLyo9bT0fsdAIGmefsfxyxVGZYdjIgHBBNBhT-Q545iVUp8Gbt70vr8Mzf62pY_Jt_dktESBDHgE-x3hUZxo8wMQdfyd3uEBJFzjPlhBDyaSSCXMTdqb9ByAD_GdzefKjrfOF1tdZ7aLmiDtc8PCMMcysYqaePaLliR9wgAzRc-jYqsZXQl31clFw5dxppgeH8R3pN2G4r4ptM5Dr1HkSK8bPHmqomTyvhrbqVXUIZBZcq0u-E37dCoQ",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-26 23:51:14.033 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-26 23:51:14.051 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-26 23:51:14.053 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-26 23:51:14.055 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-26 23:51:14.060 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGBL5CF5VC2:00000019",
  "TimeStamp": "2018-08-27T02:51:14Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 23:51:14.442 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-26 23:51:14.445 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-26 23:51:14.447 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-26 23:51:14.451 -03:00 [DBG] Processing signout callback request
2018-08-26 23:51:14.464 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:51:14.467 -03:00 [DBG] No client front-channel logout URLs
2018-08-26 23:51:14.469 -03:00 [DBG] No client back-channel logout URLs
2018-08-26 23:51:14.470 -03:00 [INF] Successful signout callback.
2018-08-26 23:51:14.472 -03:00 [DBG] No client front-channel iframe urls
2018-08-26 23:51:14.473 -03:00 [DBG] No client back-channel iframe urls
2018-08-26 23:51:17.708 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:51:17.717 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:51:17.719 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:51:17.721 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:51:17.723 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:51:17.724 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:51:17.728 -03:00 [DBG] Start discovery request
2018-08-26 23:51:17.742 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:51:17.761 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:51:17.768 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:51:17.769 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:51:17.770 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:51:17.774 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:51:17.776 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:51:17.778 -03:00 [DBG] Start key discovery request
2018-08-26 23:51:19.562 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 23:51:19.565 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 23:51:19.568 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 23:51:19.568 -03:00 [DBG] Start authorize request
2018-08-26 23:51:19.569 -03:00 [DBG] No user present in authorize request
2018-08-26 23:51:19.570 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:51:19.579 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:51:19.585 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:51:19.588 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:51:19.593 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:51:19.596 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:51:19.598 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:51:19.599 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "eQyOfGRjUXZjwSXGDm4Foxwh3h8ZpAonKBU8ugTo;login",
  "Nonce": "eQyOfGRjUXZjwSXGDm4Foxwh3h8ZpAonKBU8ugTo",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "eQyOfGRjUXZjwSXGDm4Foxwh3h8ZpAonKBU8ugTo;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "eQyOfGRjUXZjwSXGDm4Foxwh3h8ZpAonKBU8ugTo"
  }
}
2018-08-26 23:51:19.606 -03:00 [INF] Showing login: User is not authenticated
2018-08-26 23:51:19.616 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:51:19.637 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:51:19.642 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:51:19.646 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:51:19.650 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:51:19.652 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:51:19.655 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:51:19.669 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:51:22.477 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-26 23:51:23.074 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-26 23:51:23.103 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGBL5CF5VC4:00000012",
  "TimeStamp": "2018-08-27T02:51:23Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 23:51:23.107 -03:00 [DBG] Augmenting SignInContext
2018-08-26 23:51:23.108 -03:00 [DBG] Adding amr claim with value: external
2018-08-26 23:51:23.109 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-26 23:51:23.111 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-26 23:51:23.123 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-26 23:51:23.124 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-26 23:51:23.127 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-26 23:51:23.127 -03:00 [DBG] Start authorize callback request
2018-08-26 23:51:23.128 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 23:51:23.129 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:51:23.140 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:51:23.144 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:51:23.147 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:51:23.151 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:51:23.154 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:51:23.156 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:51:23.157 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "eQyOfGRjUXZjwSXGDm4Foxwh3h8ZpAonKBU8ugTo;login",
  "Nonce": "eQyOfGRjUXZjwSXGDm4Foxwh3h8ZpAonKBU8ugTo",
  "SessionId": "877ce52dcb316782e7482a06fa11aec4",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "eQyOfGRjUXZjwSXGDm4Foxwh3h8ZpAonKBU8ugTo;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "eQyOfGRjUXZjwSXGDm4Foxwh3h8ZpAonKBU8ugTo"
  }
}
2018-08-26 23:51:23.173 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-26 23:51:23.178 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-26 23:51:23.179 -03:00 [DBG] Creating Implicit Flow response.
2018-08-26 23:51:23.179 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-26 23:51:23.180 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 23:51:23.194 -03:00 [DBG] zXCa9AF7gIfrHvgXKHb3F3S61ulBXx5Hd2uT37aYFZI= not found in database
2018-08-26 23:51:23.200 -03:00 [DBG] Getting claims for identity token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3 and client: UserManagementUI
2018-08-26 23:51:23.201 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-26 23:51:23.205 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****7MTw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****d041"
    }
  ],
  "ActivityId": "0HLGBL5CF5VC4:00000013",
  "TimeStamp": "2018-08-27T02:51:23Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 23:51:23.209 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "eQyOfGRjUXZjwSXGDm4Foxwh3h8ZpAonKBU8ugTo;login",
  "Scope": "openid profile email"
}
2018-08-26 23:51:23.211 -03:00 [DBG] Augmenting SignInContext
2018-08-26 23:51:23.213 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-26 23:56:35.921 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:56:35.988 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:56:35.992 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:56:35.996 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:56:36.000 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:56:36.007 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:56:36.011 -03:00 [DBG] Start discovery request
2018-08-26 23:56:36.029 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:56:36.073 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:56:36.099 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:56:36.103 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:56:36.107 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:56:36.110 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:56:36.112 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:56:36.117 -03:00 [DBG] Start key discovery request
2018-08-26 23:57:21.344 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-26 23:57:21.357 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:57:21.361 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:57:21.363 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-26 23:57:21.367 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-26 23:57:21.371 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-26 23:57:21.372 -03:00 [DBG] Start discovery request
2018-08-26 23:57:21.385 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-26 23:57:21.467 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-26 23:57:21.472 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-26 23:57:21.473 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-26 23:57:21.475 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-26 23:57:21.478 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-26 23:57:21.484 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-26 23:57:21.485 -03:00 [DBG] Start key discovery request
2018-08-26 23:57:22.497 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-26 23:57:22.508 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-26 23:57:22.509 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-26 23:57:22.513 -03:00 [DBG] Start authorize request
2018-08-26 23:57:22.519 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 23:57:22.524 -03:00 [DBG] Start authorize request protocol validation
2018-08-26 23:57:22.543 -03:00 [DBG] UserManagementUI found in database: true
2018-08-26 23:57:22.551 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:57:22.556 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:57:22.560 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-26 23:57:22.564 -03:00 [DBG] Found [] API scopes in database
2018-08-26 23:57:22.565 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-26 23:57:22.571 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "xoqiOfCdioGLHKCRXxs4RzR1vOhXS6FHEtrg5A88;login",
  "Nonce": "xoqiOfCdioGLHKCRXxs4RzR1vOhXS6FHEtrg5A88",
  "SessionId": "877ce52dcb316782e7482a06fa11aec4",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "xoqiOfCdioGLHKCRXxs4RzR1vOhXS6FHEtrg5A88;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "xoqiOfCdioGLHKCRXxs4RzR1vOhXS6FHEtrg5A88"
  }
}
2018-08-26 23:57:22.590 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-26 23:57:22.597 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-26 23:57:22.598 -03:00 [DBG] Creating Implicit Flow response.
2018-08-26 23:57:22.598 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-26 23:57:22.600 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-26 23:57:22.626 -03:00 [DBG] puR5Aha8Kj28DTUwvNed4lL4/0OImke5mYrpLnEf9Oo= not found in database
2018-08-26 23:57:22.638 -03:00 [DBG] Getting claims for identity token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3 and client: UserManagementUI
2018-08-26 23:57:22.639 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-26 23:57:22.643 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****gK2Q"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****81f8"
    }
  ],
  "ActivityId": "0HLGBL5CF5VC8:00000001",
  "TimeStamp": "2018-08-27T02:57:22Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-26 23:57:22.654 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "xoqiOfCdioGLHKCRXxs4RzR1vOhXS6FHEtrg5A88;login",
  "Scope": "openid profile email"
}
2018-08-27 00:00:56.982 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:00:56.989 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:00:56.995 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:00:56.997 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:00:56.998 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:00:57.000 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:00:57.001 -03:00 [DBG] Start discovery request
2018-08-27 00:00:57.013 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:00:57.074 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:00:57.079 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:00:57.082 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:00:57.084 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:00:57.090 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:00:57.093 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:00:57.095 -03:00 [DBG] Start key discovery request
2018-08-27 00:00:57.341 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:00:57.347 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:00:57.349 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:00:57.351 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:00:57.354 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:00:57.361 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:00:57.364 -03:00 [DBG] Start discovery request
2018-08-27 00:00:57.377 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:00:57.444 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:00:57.451 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:00:57.453 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:00:57.454 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:00:57.459 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:00:57.460 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:00:57.463 -03:00 [DBG] Start key discovery request
2018-08-27 00:01:10.417 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:01:10.424 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:01:10.426 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:01:10.428 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:01:10.432 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:01:10.437 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:01:10.442 -03:00 [DBG] Start discovery request
2018-08-27 00:01:10.453 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:01:10.473 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:01:10.478 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:01:10.480 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:01:10.484 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:01:10.487 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:01:10.490 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:01:10.491 -03:00 [DBG] Start key discovery request
2018-08-27 00:01:12.032 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:01:12.038 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:01:12.039 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:01:12.041 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:01:12.045 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:01:12.049 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:01:12.050 -03:00 [DBG] Start discovery request
2018-08-27 00:01:12.058 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:01:12.071 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:01:12.074 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:01:12.075 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:01:12.077 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:01:12.079 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:01:12.080 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:01:12.082 -03:00 [DBG] Start key discovery request
2018-08-27 00:01:14.948 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 00:01:14.951 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 00:01:14.954 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 00:01:14.962 -03:00 [DBG] Processing signout request for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:01:14.964 -03:00 [DBG] Start end session request validation
2018-08-27 00:01:14.968 -03:00 [DBG] Start identity token validation
2018-08-27 00:01:14.986 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:01:14.988 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 00:01:15.002 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 00:01:15.005 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535338642,
    "exp": 1535338942,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "xoqiOfCdioGLHKCRXxs4RzR1vOhXS6FHEtrg5A88",
    "iat": 1535338642,
    "at_hash": "mjD_jgNYXN3M5JVkJWFUkg",
    "sid": "877ce52dcb316782e7482a06fa11aec4",
    "sub": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
    "auth_time": 1535338283,
    "idp": "Facebook",
    "amr": "external"
  }
}
2018-08-27 00:01:15.011 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzMzg2NDIsImV4cCI6MTUzNTMzODk0MiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoieG9xaU9mQ2Rpb0dMSEtDUlh4czRSelIxdk9oWFM2RkhFdHJnNUE4OCIsImlhdCI6MTUzNTMzODY0MiwiYXRfaGFzaCI6Im1qRF9qZ05ZWE4zTTVKVmtKV0ZVa2ciLCJzaWQiOiI4NzdjZTUyZGNiMzE2NzgyZTc0ODJhMDZmYTExYWVjNCIsInN1YiI6IjQyMjYxYTVmLWExNGItNDhlNS04NTMzLTNiNmNhMjQ1NjRlMyIsImF1dGhfdGltZSI6MTUzNTMzODI4MywiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.p3dQHbpLDZG-ES1Q5Wncp4ZvbM6RSbZpLJoLZSLjX12nOjF4CKATgg05ho3ceZdIGH9ghnxol5YxludUTUJWZ27Aez2Pol-rAwBCCLTn5KEd5LGWrYvSzEKDoztBuMKA9aGBor-rgrxr2Ao2TLFNgp3kigrUnsOYh37B_DJFRa7CturBMtg8llT3gM6nL_XRPYfiNXSmUamYVWtxrVpgN9Ry1cMGJRaxZ44NinGbbMVNW25NQTzyRKfZxvNd4jywkn4FBtlonNK3undMseCKgxChNlAb2CKrY5KEpmvb2K_n_bWkdjAeVohJPcnpQHkTy2Y7LUuToLds6xOxgtgK2Q",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 00:01:15.022 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 00:01:15.042 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 00:01:15.043 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 00:01:15.046 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 00:01:15.049 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGBL5CF5VC8:00000003",
  "TimeStamp": "2018-08-27T03:01:15Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:01:15.555 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 00:01:15.558 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 00:01:15.562 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 00:01:15.563 -03:00 [DBG] Processing signout callback request
2018-08-27 00:01:15.582 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:01:15.584 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 00:01:15.585 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 00:01:15.587 -03:00 [INF] Successful signout callback.
2018-08-27 00:01:15.592 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 00:01:15.595 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 00:01:18.707 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:01:18.715 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:01:18.717 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:01:18.719 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:01:18.723 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:01:18.727 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:01:18.729 -03:00 [DBG] Start discovery request
2018-08-27 00:01:18.741 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:01:18.765 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:01:18.771 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:01:18.773 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:01:18.773 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:01:18.776 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:01:18.781 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:01:18.782 -03:00 [DBG] Start key discovery request
2018-08-27 00:01:19.997 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 00:01:20.000 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 00:01:20.002 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 00:01:20.004 -03:00 [DBG] Start authorize request
2018-08-27 00:01:20.006 -03:00 [DBG] No user present in authorize request
2018-08-27 00:01:20.007 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:01:20.028 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:01:20.036 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:01:20.040 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:01:20.045 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:01:20.050 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:01:20.052 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:01:20.055 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "yOBUlCiIboRTVFzUABo6LiP1WPCpW8LNbjeZHzUU;login",
  "Nonce": "yOBUlCiIboRTVFzUABo6LiP1WPCpW8LNbjeZHzUU",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "yOBUlCiIboRTVFzUABo6LiP1WPCpW8LNbjeZHzUU;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "yOBUlCiIboRTVFzUABo6LiP1WPCpW8LNbjeZHzUU"
  }
}
2018-08-27 00:01:20.068 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 00:01:20.078 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:01:20.093 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:01:20.098 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:01:20.102 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:01:20.109 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:01:20.113 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:01:20.116 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:01:20.128 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:01:21.754 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 00:01:22.439 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 00:01:22.464 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGBL5CF5VCB:00000005",
  "TimeStamp": "2018-08-27T03:01:22Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:01:22.471 -03:00 [DBG] Augmenting SignInContext
2018-08-27 00:01:22.473 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 00:01:22.475 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 00:01:22.480 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 00:01:22.490 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 00:01:22.492 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 00:01:22.493 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 00:01:22.495 -03:00 [DBG] Start authorize callback request
2018-08-27 00:01:22.495 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:01:22.498 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:01:22.514 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:01:22.520 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:01:22.523 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:01:22.527 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:01:22.530 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:01:22.532 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:01:22.534 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "yOBUlCiIboRTVFzUABo6LiP1WPCpW8LNbjeZHzUU;login",
  "Nonce": "yOBUlCiIboRTVFzUABo6LiP1WPCpW8LNbjeZHzUU",
  "SessionId": "9b18daa2bab98e501fe9f2f15327851d",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "yOBUlCiIboRTVFzUABo6LiP1WPCpW8LNbjeZHzUU;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "yOBUlCiIboRTVFzUABo6LiP1WPCpW8LNbjeZHzUU"
  }
}
2018-08-27 00:01:22.548 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-27 00:01:22.555 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-27 00:01:22.556 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 00:01:22.557 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 00:01:22.560 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:01:22.572 -03:00 [DBG] MHqff8Fe0SW1aNIejJuPClxCSPGX5wFnsubE52w/zvU= not found in database
2018-08-27 00:01:22.584 -03:00 [DBG] Getting claims for identity token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3 and client: UserManagementUI
2018-08-27 00:01:22.586 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 00:01:22.589 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****-fZw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****dc8c"
    }
  ],
  "ActivityId": "0HLGBL5CF5VCB:00000006",
  "TimeStamp": "2018-08-27T03:01:22Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:01:22.597 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "yOBUlCiIboRTVFzUABo6LiP1WPCpW8LNbjeZHzUU;login",
  "Scope": "openid profile email"
}
2018-08-27 00:01:22.602 -03:00 [DBG] Augmenting SignInContext
2018-08-27 00:01:22.604 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 00:01:25.083 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:01:25.086 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:01:25.087 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:01:25.088 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:01:25.089 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:01:25.091 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:01:25.092 -03:00 [DBG] Start discovery request
2018-08-27 00:01:25.106 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:01:25.125 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:01:25.129 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:01:25.131 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:01:25.132 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:01:25.135 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:01:25.140 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:01:25.141 -03:00 [DBG] Start key discovery request
2018-08-27 00:01:43.773 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:01:43.776 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:01:43.778 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:01:43.779 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:01:43.781 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:01:43.782 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:01:43.787 -03:00 [DBG] Start discovery request
2018-08-27 00:01:43.798 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:01:43.825 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:01:43.830 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:01:43.832 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:01:43.834 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:01:43.838 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:01:43.841 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:01:43.843 -03:00 [DBG] Start key discovery request
2018-08-27 00:01:46.024 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:01:46.030 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:01:46.032 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:01:46.033 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:01:46.036 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:01:46.038 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:01:46.040 -03:00 [DBG] Start discovery request
2018-08-27 00:01:46.054 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:01:46.071 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:01:46.079 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:01:46.080 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:01:46.080 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:01:46.084 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:01:46.086 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:01:46.087 -03:00 [DBG] Start key discovery request
2018-08-27 00:04:50.840 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:04:50.847 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:04:50.853 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:04:50.854 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:04:50.856 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:04:50.858 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:04:50.859 -03:00 [DBG] Start discovery request
2018-08-27 00:04:50.871 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:04:50.893 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:04:50.897 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:04:50.899 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:04:50.900 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:04:50.901 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:04:50.902 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:04:50.907 -03:00 [DBG] Start key discovery request
2018-08-27 00:05:26.822 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:05:26.827 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:05:26.829 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:05:26.830 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:05:26.831 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:05:26.835 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:05:26.836 -03:00 [DBG] Start discovery request
2018-08-27 00:05:26.848 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:05:26.870 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:05:26.876 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:05:26.878 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:05:26.878 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:05:26.880 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:05:26.884 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:05:26.887 -03:00 [DBG] Start key discovery request
2018-08-27 00:05:34.065 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:05:34.070 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:05:34.072 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:05:34.073 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:05:34.079 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:05:34.082 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:05:34.084 -03:00 [DBG] Start discovery request
2018-08-27 00:05:34.092 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:05:34.110 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:05:34.115 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:05:34.117 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:05:34.118 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:05:34.120 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:05:34.127 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:05:34.130 -03:00 [DBG] Start key discovery request
2018-08-27 00:05:38.687 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:05:38.690 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:05:38.692 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:05:38.692 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:05:38.694 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:05:38.696 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:05:38.701 -03:00 [DBG] Start discovery request
2018-08-27 00:05:38.711 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:05:38.730 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:05:38.735 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:05:38.737 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:05:38.738 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:05:38.742 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:05:38.746 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:05:38.749 -03:00 [DBG] Start key discovery request
2018-08-27 00:06:43.023 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:06:43.040 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:06:43.045 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:06:43.050 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:06:43.061 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:06:43.067 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:06:43.072 -03:00 [DBG] Start discovery request
2018-08-27 00:06:43.089 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:06:43.133 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:06:43.149 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:06:43.156 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:06:43.158 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:06:43.164 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:06:43.173 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:06:43.176 -03:00 [DBG] Start key discovery request
2018-08-27 00:06:44.291 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:06:44.296 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:06:44.298 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:06:44.300 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:06:44.303 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:06:44.307 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:06:44.311 -03:00 [DBG] Start discovery request
2018-08-27 00:06:44.323 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:06:44.374 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:06:44.378 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:06:44.379 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:06:44.381 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:06:44.383 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:06:44.384 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:06:44.390 -03:00 [DBG] Start key discovery request
2018-08-27 00:06:51.074 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 00:06:51.077 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 00:06:51.078 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 00:06:51.080 -03:00 [DBG] Start authorize request
2018-08-27 00:06:51.082 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:06:51.084 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:06:51.105 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:06:51.110 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:06:51.114 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:06:51.118 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:06:51.122 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:06:51.124 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:06:51.127 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "BoBvR33m88wBOsCbtLVxhQtr6WFGhrEx4kyqtgk4;login",
  "Nonce": "BoBvR33m88wBOsCbtLVxhQtr6WFGhrEx4kyqtgk4",
  "SessionId": "9b18daa2bab98e501fe9f2f15327851d",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "BoBvR33m88wBOsCbtLVxhQtr6WFGhrEx4kyqtgk4;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "BoBvR33m88wBOsCbtLVxhQtr6WFGhrEx4kyqtgk4"
  }
}
2018-08-27 00:06:51.140 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-27 00:06:51.145 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-27 00:06:51.146 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 00:06:51.146 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 00:06:51.148 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:06:51.163 -03:00 [DBG] WX7L0rrwJVTmjuePQdOr2JOUWDYSfMlB7R0B86OJKH8= not found in database
2018-08-27 00:06:51.171 -03:00 [DBG] Getting claims for identity token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3 and client: UserManagementUI
2018-08-27 00:06:51.173 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 00:06:51.177 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****yACg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****4d88"
    }
  ],
  "ActivityId": "0HLGBL5CF5VCD:00000001",
  "TimeStamp": "2018-08-27T03:06:51Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:06:51.182 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "BoBvR33m88wBOsCbtLVxhQtr6WFGhrEx4kyqtgk4;login",
  "Scope": "openid profile email"
}
2018-08-27 00:06:52.774 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:06:52.783 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:06:52.787 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:06:52.794 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:06:52.798 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:06:52.805 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:06:52.813 -03:00 [DBG] Start discovery request
2018-08-27 00:06:52.826 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:06:52.873 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:06:52.878 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:06:52.880 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:06:52.883 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:06:52.890 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:06:52.894 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:06:52.896 -03:00 [DBG] Start key discovery request
2018-08-27 00:06:58.027 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:06:58.040 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:06:58.044 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:06:58.050 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:06:58.054 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:06:58.060 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:06:58.065 -03:00 [DBG] Start discovery request
2018-08-27 00:06:58.078 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:06:58.103 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:06:58.109 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:06:58.110 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:06:58.112 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:06:58.115 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:06:58.119 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:06:58.122 -03:00 [DBG] Start key discovery request
2018-08-27 00:07:02.632 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:07:02.641 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:02.642 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:02.644 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:07:02.648 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:07:02.650 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:07:02.658 -03:00 [DBG] Start discovery request
2018-08-27 00:07:02.672 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:07:02.724 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:07:02.729 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:02.730 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:02.732 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:07:02.734 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:07:02.739 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:07:02.741 -03:00 [DBG] Start key discovery request
2018-08-27 00:07:13.276 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:07:13.283 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:13.285 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:13.288 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:07:13.291 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:07:13.294 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:07:13.297 -03:00 [DBG] Start discovery request
2018-08-27 00:07:13.312 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:07:13.386 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:07:13.391 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:13.393 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:13.395 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:07:13.399 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:07:13.402 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:07:13.406 -03:00 [DBG] Start key discovery request
2018-08-27 00:07:32.156 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:07:32.166 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:32.170 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:32.172 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:07:32.175 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:07:32.180 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:07:32.182 -03:00 [DBG] Start discovery request
2018-08-27 00:07:32.197 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:07:32.236 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:07:32.241 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:32.242 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:32.244 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:07:32.249 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:07:32.254 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:07:32.256 -03:00 [DBG] Start key discovery request
2018-08-27 00:07:33.559 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:07:33.565 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:33.569 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:33.569 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:07:33.573 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:07:33.576 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:07:33.579 -03:00 [DBG] Start discovery request
2018-08-27 00:07:33.591 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:07:33.639 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:07:33.643 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:33.644 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:33.644 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:07:33.645 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:07:33.647 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:07:33.648 -03:00 [DBG] Start key discovery request
2018-08-27 00:07:37.241 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:07:37.246 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:37.249 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:37.252 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:07:37.256 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:07:37.258 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:07:37.261 -03:00 [DBG] Start discovery request
2018-08-27 00:07:37.275 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:07:37.319 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:07:37.327 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:37.331 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:37.333 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:07:37.334 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:07:37.338 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:07:37.343 -03:00 [DBG] Start key discovery request
2018-08-27 00:07:46.749 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:07:46.755 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:46.757 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:46.758 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:07:46.759 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:07:46.764 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:07:46.767 -03:00 [DBG] Start discovery request
2018-08-27 00:07:46.778 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:07:46.801 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:07:46.806 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:46.808 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:46.812 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:07:46.815 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:07:46.817 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:07:46.819 -03:00 [DBG] Start key discovery request
2018-08-27 00:07:47.877 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:07:47.882 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:47.884 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:47.890 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:07:47.894 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:07:47.897 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:07:47.899 -03:00 [DBG] Start discovery request
2018-08-27 00:07:47.909 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:07:47.923 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:07:47.926 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:47.930 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:47.931 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:07:47.934 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:07:47.935 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:07:47.937 -03:00 [DBG] Start key discovery request
2018-08-27 00:07:49.611 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 00:07:49.615 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 00:07:49.617 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 00:07:49.619 -03:00 [DBG] Processing signout request for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:07:49.622 -03:00 [DBG] Start end session request validation
2018-08-27 00:07:49.624 -03:00 [DBG] Start identity token validation
2018-08-27 00:07:49.634 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:07:49.636 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 00:07:49.643 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 00:07:49.644 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535339211,
    "exp": 1535339511,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "BoBvR33m88wBOsCbtLVxhQtr6WFGhrEx4kyqtgk4",
    "iat": 1535339211,
    "at_hash": "jB8fzSuNJ7SWLJc0QDpeEQ",
    "sid": "9b18daa2bab98e501fe9f2f15327851d",
    "sub": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
    "auth_time": 1535338882,
    "idp": "Facebook",
    "amr": "external"
  }
}
2018-08-27 00:07:49.647 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzMzkyMTEsImV4cCI6MTUzNTMzOTUxMSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiQm9CdlIzM204OHdCT3NDYnRMVnhoUXRyNldGR2hyRXg0a3lxdGdrNCIsImlhdCI6MTUzNTMzOTIxMSwiYXRfaGFzaCI6ImpCOGZ6U3VOSjdTV0xKYzBRRHBlRVEiLCJzaWQiOiI5YjE4ZGFhMmJhYjk4ZTUwMWZlOWYyZjE1MzI3ODUxZCIsInN1YiI6IjQyMjYxYTVmLWExNGItNDhlNS04NTMzLTNiNmNhMjQ1NjRlMyIsImF1dGhfdGltZSI6MTUzNTMzODg4MiwiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.cMUxFyRS79h-HtsGnJLWC9mFpVeie7u6Np0mb5pLt9v4duEVEzg_wt8hbPkM7NErEjpU0L-SxdKNWP0aVR9akuyXqamR9otBVJSxR_7ISOe3LQg7CUfbYEh1v4swXgRJOIqW51i3cagT7a0Cyr3tckiSuQFBazwc_R6xXgs4vQqowQLQqHXv8rYzEI9Xh-WdA0_afB4jcAspuJiz5moXbDMb_16mXzFpaR59_WJVEr51Mt-am6bvxiZIn2tqCTJltvRxiZvGCup8eXHQ1t76-2_O2FI-Vut6-3bTheRgFNTV5KV4WA1Xp8_lCJ76__DVq71N_VyZcgpVKNSO1zyACg",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 00:07:49.655 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 00:07:49.670 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 00:07:49.673 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 00:07:49.675 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 00:07:49.677 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGBL5CF5VCD:00000003",
  "TimeStamp": "2018-08-27T03:07:49Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:07:50.130 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 00:07:50.132 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 00:07:50.133 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 00:07:50.138 -03:00 [DBG] Processing signout callback request
2018-08-27 00:07:50.152 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:07:50.157 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 00:07:50.157 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 00:07:50.159 -03:00 [INF] Successful signout callback.
2018-08-27 00:07:50.165 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 00:07:50.169 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 00:07:53.199 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:07:53.204 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:53.205 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:53.207 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:07:53.210 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:07:53.214 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:07:53.216 -03:00 [DBG] Start discovery request
2018-08-27 00:07:53.228 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:07:53.276 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:07:53.280 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:07:53.282 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:07:53.283 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:07:53.286 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:07:53.290 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:07:53.293 -03:00 [DBG] Start key discovery request
2018-08-27 00:07:54.818 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 00:07:54.821 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 00:07:54.825 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 00:07:54.826 -03:00 [DBG] Start authorize request
2018-08-27 00:07:54.827 -03:00 [DBG] No user present in authorize request
2018-08-27 00:07:54.828 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:07:54.843 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:07:54.848 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:07:54.852 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:07:54.856 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:07:54.861 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:07:54.862 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:07:54.863 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "Tr6xZMOyjW4hhRRhqx5ssFLNncPdmHT0Xk1ueJ8P;login",
  "Nonce": "Tr6xZMOyjW4hhRRhqx5ssFLNncPdmHT0Xk1ueJ8P",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "Tr6xZMOyjW4hhRRhqx5ssFLNncPdmHT0Xk1ueJ8P;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "Tr6xZMOyjW4hhRRhqx5ssFLNncPdmHT0Xk1ueJ8P"
  }
}
2018-08-27 00:07:54.872 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 00:07:54.885 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:07:54.899 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:07:54.905 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:07:54.909 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:07:54.912 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:07:54.915 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:07:54.918 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:07:54.929 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:08:00.192 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 00:08:00.829 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 00:08:00.852 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGBL5CF5VCD:00000009",
  "TimeStamp": "2018-08-27T03:08:00Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:08:00.857 -03:00 [DBG] Augmenting SignInContext
2018-08-27 00:08:00.858 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 00:08:00.859 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 00:08:00.860 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 00:08:00.868 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 00:08:00.870 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 00:08:00.871 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 00:08:00.873 -03:00 [DBG] Start authorize callback request
2018-08-27 00:08:00.873 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:08:00.877 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:08:00.890 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:08:00.894 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:08:00.898 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:08:00.901 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:08:00.905 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:08:00.909 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:08:00.910 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "Tr6xZMOyjW4hhRRhqx5ssFLNncPdmHT0Xk1ueJ8P;login",
  "Nonce": "Tr6xZMOyjW4hhRRhqx5ssFLNncPdmHT0Xk1ueJ8P",
  "SessionId": "312ecb826ba174a7f8d8b6d1386f3165",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "Tr6xZMOyjW4hhRRhqx5ssFLNncPdmHT0Xk1ueJ8P;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "Tr6xZMOyjW4hhRRhqx5ssFLNncPdmHT0Xk1ueJ8P"
  }
}
2018-08-27 00:08:00.926 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-27 00:08:00.931 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-27 00:08:00.934 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 00:08:00.935 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 00:08:00.937 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:08:00.953 -03:00 [DBG] rQ9iAb2QfFv4gN68vpBZsa+RU8f6YUlhIv7XK8s1q8k= not found in database
2018-08-27 00:08:00.964 -03:00 [DBG] Getting claims for identity token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3 and client: UserManagementUI
2018-08-27 00:08:00.968 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 00:08:00.972 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****uzvg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****8646"
    }
  ],
  "ActivityId": "0HLGBL5CF5VCD:0000000A",
  "TimeStamp": "2018-08-27T03:08:00Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:08:00.975 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "Tr6xZMOyjW4hhRRhqx5ssFLNncPdmHT0Xk1ueJ8P;login",
  "Scope": "openid profile email"
}
2018-08-27 00:08:00.977 -03:00 [DBG] Augmenting SignInContext
2018-08-27 00:08:00.978 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 00:08:02.479 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:08:02.485 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:08:02.487 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:08:02.489 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:08:02.492 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:08:02.497 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:08:02.499 -03:00 [DBG] Start discovery request
2018-08-27 00:08:02.513 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:08:02.570 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:08:02.579 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:08:02.580 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:08:02.582 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:08:02.584 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:08:02.585 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:08:02.587 -03:00 [DBG] Start key discovery request
2018-08-27 00:08:50.107 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:08:50.113 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:08:50.117 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:08:50.118 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:08:50.123 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:08:50.125 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:08:50.128 -03:00 [DBG] Start discovery request
2018-08-27 00:08:50.139 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:08:50.210 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:08:50.214 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:08:50.219 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:08:50.220 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:08:50.223 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:08:50.227 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:08:50.231 -03:00 [DBG] Start key discovery request
2018-08-27 00:08:50.985 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:08:50.991 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:08:50.993 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:08:50.995 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:08:50.996 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:08:51.001 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:08:51.003 -03:00 [DBG] Start discovery request
2018-08-27 00:08:51.014 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:08:51.148 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:08:51.153 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:08:51.156 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:08:51.158 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:08:51.162 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:08:51.163 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:08:51.164 -03:00 [DBG] Start key discovery request
2018-08-27 00:10:52.421 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:10:52.428 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:10:52.432 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:10:52.433 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:10:52.439 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:10:52.441 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:10:52.446 -03:00 [DBG] Start discovery request
2018-08-27 00:10:52.458 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:10:52.472 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:10:52.476 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:10:52.478 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:10:52.479 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:10:52.482 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:10:52.484 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:10:52.488 -03:00 [DBG] Start discovery request
2018-08-27 00:10:52.498 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:10:52.608 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:10:52.613 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:10:52.615 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:10:52.617 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:10:52.619 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:10:52.623 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:10:52.625 -03:00 [DBG] Start key discovery request
2018-08-27 00:10:52.639 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:10:52.643 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:10:52.645 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:10:52.647 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:10:52.649 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:10:52.653 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:10:52.658 -03:00 [DBG] Start key discovery request
2018-08-27 00:11:13.106 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:11:13.111 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:11:13.113 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:11:13.115 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:11:13.117 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:11:13.121 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:11:13.123 -03:00 [DBG] Start discovery request
2018-08-27 00:11:13.135 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:11:13.160 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:11:13.165 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:11:13.173 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:11:13.174 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:11:13.176 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:11:13.184 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:11:13.188 -03:00 [DBG] Start discovery request
2018-08-27 00:11:13.201 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:11:13.333 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:11:13.339 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:11:13.344 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:11:13.358 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:11:13.364 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:11:13.366 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:11:13.370 -03:00 [DBG] Start key discovery request
2018-08-27 00:11:13.388 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:11:13.396 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:11:13.398 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:11:13.402 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:11:13.409 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:11:13.412 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:11:13.419 -03:00 [DBG] Start key discovery request
2018-08-27 00:11:32.388 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:11:32.394 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:11:32.396 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:11:32.398 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:11:32.401 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:11:32.406 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:11:32.409 -03:00 [DBG] Start discovery request
2018-08-27 00:11:32.421 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:11:32.439 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:11:32.445 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:11:32.447 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:11:32.450 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:11:32.452 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:11:32.457 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:11:32.458 -03:00 [DBG] Start discovery request
2018-08-27 00:11:32.471 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:11:32.515 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:11:32.519 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:11:32.521 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:11:32.522 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:11:32.525 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:11:32.529 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:11:32.534 -03:00 [DBG] Start key discovery request
2018-08-27 00:11:32.543 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:11:32.570 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:11:32.571 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:11:32.576 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:11:32.578 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:11:32.580 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:11:32.582 -03:00 [DBG] Start key discovery request
2018-08-27 00:12:09.107 -03:00 [INF] Clearing 0 tokens
2018-08-27 00:12:18.240 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:12:18.245 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:18.247 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:18.254 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:12:18.256 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:12:18.258 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:12:18.263 -03:00 [DBG] Start discovery request
2018-08-27 00:12:18.279 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:12:18.343 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:12:18.356 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:18.357 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:18.358 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:12:18.360 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:12:18.362 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:12:18.363 -03:00 [DBG] Start key discovery request
2018-08-27 00:12:19.642 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 00:12:19.644 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 00:12:19.647 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 00:12:19.649 -03:00 [DBG] Start authorize request
2018-08-27 00:12:19.650 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:12:19.652 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:12:19.665 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:12:19.671 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:12:19.676 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:12:19.680 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:12:19.684 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:12:19.686 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:12:19.690 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "UhnWIwH0t0NM6mBXjpTVuKQFejFx5IAxx2oO8UP5;login",
  "Nonce": "UhnWIwH0t0NM6mBXjpTVuKQFejFx5IAxx2oO8UP5",
  "SessionId": "312ecb826ba174a7f8d8b6d1386f3165",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "UhnWIwH0t0NM6mBXjpTVuKQFejFx5IAxx2oO8UP5;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "UhnWIwH0t0NM6mBXjpTVuKQFejFx5IAxx2oO8UP5"
  }
}
2018-08-27 00:12:19.709 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-27 00:12:19.715 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-27 00:12:19.716 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 00:12:19.717 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 00:12:19.718 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:12:19.739 -03:00 [DBG] H2FVqoG125iGdHPNgFMg6LgmKTi3QZMf35IDOV7DZYE= not found in database
2018-08-27 00:12:19.747 -03:00 [DBG] Getting claims for identity token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3 and client: UserManagementUI
2018-08-27 00:12:19.750 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 00:12:19.756 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Yh2w"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****be36"
    }
  ],
  "ActivityId": "0HLGBL5CF5VCD:0000000B",
  "TimeStamp": "2018-08-27T03:12:19Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:12:19.767 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "UhnWIwH0t0NM6mBXjpTVuKQFejFx5IAxx2oO8UP5;login",
  "Scope": "openid profile email"
}
2018-08-27 00:12:21.338 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:12:21.347 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:21.348 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:21.350 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:12:21.356 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:12:21.358 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:12:21.360 -03:00 [DBG] Start discovery request
2018-08-27 00:12:21.371 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:12:21.429 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:12:21.434 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:21.436 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:21.439 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:12:21.443 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:12:21.446 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:12:21.449 -03:00 [DBG] Start key discovery request
2018-08-27 00:12:42.043 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:12:42.048 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:42.051 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:42.053 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:12:42.057 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:12:42.062 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:12:42.064 -03:00 [DBG] Start discovery request
2018-08-27 00:12:42.074 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:12:42.104 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:12:42.104 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:12:42.109 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:42.111 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:42.111 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:42.112 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:42.113 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:12:42.115 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:12:42.120 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:12:42.120 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:12:42.123 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:12:42.124 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:12:42.127 -03:00 [DBG] Start discovery request
2018-08-27 00:12:42.130 -03:00 [DBG] Start key discovery request
2018-08-27 00:12:42.141 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:12:42.312 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:12:42.316 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:42.318 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:42.320 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:12:42.322 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:12:42.325 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:12:42.327 -03:00 [DBG] Start key discovery request
2018-08-27 00:12:43.546 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:12:43.550 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:43.553 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:43.555 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:12:43.556 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:12:43.559 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:12:43.561 -03:00 [DBG] Start discovery request
2018-08-27 00:12:43.575 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:12:43.593 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:12:43.597 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:12:43.598 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:43.601 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:43.602 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:43.607 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:43.607 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:12:43.609 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:12:43.611 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:12:43.612 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:12:43.613 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:12:43.614 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:12:43.615 -03:00 [DBG] Start discovery request
2018-08-27 00:12:43.616 -03:00 [DBG] Start key discovery request
2018-08-27 00:12:43.625 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:12:43.797 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:12:43.801 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:43.802 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:43.803 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:12:43.804 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:12:43.808 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:12:43.811 -03:00 [DBG] Start key discovery request
2018-08-27 00:12:44.073 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:12:44.078 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:44.080 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:44.082 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:12:44.086 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:12:44.088 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:12:44.090 -03:00 [DBG] Start discovery request
2018-08-27 00:12:44.105 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:12:44.118 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:12:44.122 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:12:44.125 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:44.128 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:44.128 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:44.132 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:12:44.135 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:44.137 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:12:44.137 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:12:44.141 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:12:44.144 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:12:44.145 -03:00 [DBG] Start discovery request
2018-08-27 00:12:44.146 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:12:44.148 -03:00 [DBG] Start key discovery request
2018-08-27 00:12:44.157 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:12:44.308 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:12:44.325 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:44.327 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:44.329 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:12:44.330 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:12:44.331 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:12:44.342 -03:00 [DBG] Start key discovery request
2018-08-27 00:12:44.564 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:12:44.570 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:44.572 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:44.577 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:12:44.581 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:12:44.585 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:12:44.588 -03:00 [DBG] Start discovery request
2018-08-27 00:12:44.600 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:12:44.613 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:12:44.616 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:12:44.617 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:44.621 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:44.621 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:44.623 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:44.623 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:12:44.626 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:12:44.627 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:12:44.630 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:12:44.631 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:12:44.632 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:12:44.634 -03:00 [DBG] Start discovery request
2018-08-27 00:12:44.635 -03:00 [DBG] Start key discovery request
2018-08-27 00:12:44.642 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:12:44.770 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:12:44.774 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:44.776 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:44.778 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:12:44.781 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:12:44.784 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:12:44.786 -03:00 [DBG] Start key discovery request
2018-08-27 00:12:47.085 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 00:12:47.088 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 00:12:47.093 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 00:12:47.096 -03:00 [DBG] Processing signout request for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:12:47.097 -03:00 [DBG] Start end session request validation
2018-08-27 00:12:47.098 -03:00 [DBG] Start identity token validation
2018-08-27 00:12:47.108 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:12:47.109 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 00:12:47.114 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 00:12:47.116 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535339539,
    "exp": 1535339839,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "UhnWIwH0t0NM6mBXjpTVuKQFejFx5IAxx2oO8UP5",
    "iat": 1535339539,
    "at_hash": "KJhLvH2vQYHvGUwlMwXvmA",
    "sid": "312ecb826ba174a7f8d8b6d1386f3165",
    "sub": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
    "auth_time": 1535339280,
    "idp": "Facebook",
    "amr": "external"
  }
}
2018-08-27 00:12:47.119 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzMzk1MzksImV4cCI6MTUzNTMzOTgzOSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiVWhuV0l3SDB0ME5NNm1CWGpwVFZ1S1FGZWpGeDVJQXh4Mm9POFVQNSIsImlhdCI6MTUzNTMzOTUzOSwiYXRfaGFzaCI6IktKaEx2SDJ2UVlIdkdVd2xNd1h2bUEiLCJzaWQiOiIzMTJlY2I4MjZiYTE3NGE3ZjhkOGI2ZDEzODZmMzE2NSIsInN1YiI6IjQyMjYxYTVmLWExNGItNDhlNS04NTMzLTNiNmNhMjQ1NjRlMyIsImF1dGhfdGltZSI6MTUzNTMzOTI4MCwiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.weZjPQUYG6Jav_k36-HvuwFOGtUJCNVBlyMzURcia15TflBJPVy9esoOP6eQcNI5ZUtCbCkrQ6ysHp4U5DAbrrGZrTpUpM1sTmPMkkuvm6nxxlNn1aWN_twU60IKrQolnzKhG02uXTOFPWxWaeUyCD1KzFsNeo-gZ3VahVcGCx-oBqLqOi1Pcp4BR6NjJpyVzVRkUszexG3PxvfMjsiu4p9NA-1fJfmO8jdYWBdrdHbE7YU4JxfOwWbbNVA3okPRYKl62vJoPsnRF_WPpHo_C-MoEDXG7yCbvUbC6ch7g_3IevvEuDyrhzuvkxD7_ZrSbR3ByWHQ05ZMH3cutmYh2w",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 00:12:47.123 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 00:12:47.138 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 00:12:47.139 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 00:12:47.155 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 00:12:47.159 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGBL5CF5VCD:0000000D",
  "TimeStamp": "2018-08-27T03:12:47Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:12:47.553 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 00:12:47.556 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 00:12:47.558 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 00:12:47.562 -03:00 [DBG] Processing signout callback request
2018-08-27 00:12:47.573 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:12:47.574 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 00:12:47.575 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 00:12:47.577 -03:00 [INF] Successful signout callback.
2018-08-27 00:12:47.579 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 00:12:47.581 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 00:12:50.177 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:12:50.183 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:50.185 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:50.187 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:12:50.191 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:12:50.193 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:12:50.196 -03:00 [DBG] Start discovery request
2018-08-27 00:12:50.208 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:12:50.267 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:12:50.271 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:12:50.273 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:12:50.286 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:12:50.296 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:12:50.298 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:12:50.300 -03:00 [DBG] Start key discovery request
2018-08-27 00:12:50.756 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 00:12:50.758 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 00:12:50.761 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 00:12:50.763 -03:00 [DBG] Processing signout callback request
2018-08-27 00:12:50.775 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:12:50.776 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 00:12:50.779 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 00:12:50.781 -03:00 [INF] Successful signout callback.
2018-08-27 00:12:50.783 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 00:12:50.785 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 00:13:50.035 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:13:50.040 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:13:50.042 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:13:50.043 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:13:50.049 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:13:50.052 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:13:50.054 -03:00 [DBG] Start discovery request
2018-08-27 00:13:50.066 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:13:50.102 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:13:50.107 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:13:50.109 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:13:50.110 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:13:50.113 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:13:50.116 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:13:50.117 -03:00 [DBG] Start key discovery request
2018-08-27 00:13:52.924 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 00:13:52.927 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 00:13:52.930 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 00:13:52.931 -03:00 [DBG] Start authorize request
2018-08-27 00:13:52.932 -03:00 [DBG] No user present in authorize request
2018-08-27 00:13:52.935 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:13:52.948 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:13:52.953 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:13:52.958 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:13:52.961 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:13:52.963 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:13:52.967 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:13:52.969 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "FDcYsY5LbOU48lfq3XQTv8mIjTzhTcX0ppIXf6U6;login",
  "Nonce": "FDcYsY5LbOU48lfq3XQTv8mIjTzhTcX0ppIXf6U6",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "FDcYsY5LbOU48lfq3XQTv8mIjTzhTcX0ppIXf6U6;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "FDcYsY5LbOU48lfq3XQTv8mIjTzhTcX0ppIXf6U6"
  }
}
2018-08-27 00:13:52.975 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 00:13:52.985 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:13:52.996 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:13:53.000 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:13:53.003 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:13:53.006 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:13:53.010 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:13:53.013 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:13:53.026 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:14:02.952 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 00:14:03.621 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 00:14:03.656 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGBL5CF5VCG:00000008",
  "TimeStamp": "2018-08-27T03:14:03Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:14:03.659 -03:00 [DBG] Augmenting SignInContext
2018-08-27 00:14:03.660 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 00:14:03.662 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 00:14:03.664 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 00:14:03.672 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 00:14:03.673 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 00:14:03.674 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 00:14:03.675 -03:00 [DBG] Start authorize callback request
2018-08-27 00:14:03.676 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:14:03.677 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:14:03.685 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:14:03.689 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:14:03.692 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:14:03.694 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:14:03.697 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:14:03.700 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:14:03.701 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "FDcYsY5LbOU48lfq3XQTv8mIjTzhTcX0ppIXf6U6;login",
  "Nonce": "FDcYsY5LbOU48lfq3XQTv8mIjTzhTcX0ppIXf6U6",
  "SessionId": "b58c0dd8a887f88c88590b81b4146acf",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "FDcYsY5LbOU48lfq3XQTv8mIjTzhTcX0ppIXf6U6;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "FDcYsY5LbOU48lfq3XQTv8mIjTzhTcX0ppIXf6U6"
  }
}
2018-08-27 00:14:03.710 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-27 00:14:03.714 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-27 00:14:03.715 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 00:14:03.716 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 00:14:03.717 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:14:03.729 -03:00 [DBG] m9XYIJ3HbMrli4zyUVtYZ0uSfkA0iaSypwJaPSRyVWA= not found in database
2018-08-27 00:14:03.738 -03:00 [DBG] Getting claims for identity token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3 and client: UserManagementUI
2018-08-27 00:14:03.740 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 00:14:03.743 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****u5Gw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****d5b4"
    }
  ],
  "ActivityId": "0HLGBL5CF5VCG:00000009",
  "TimeStamp": "2018-08-27T03:14:03Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:14:03.750 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "FDcYsY5LbOU48lfq3XQTv8mIjTzhTcX0ppIXf6U6;login",
  "Scope": "openid profile email"
}
2018-08-27 00:14:03.751 -03:00 [DBG] Augmenting SignInContext
2018-08-27 00:14:03.753 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 00:14:05.530 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:14:05.535 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:14:05.536 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:14:05.537 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:14:05.540 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:14:05.545 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:14:05.547 -03:00 [DBG] Start discovery request
2018-08-27 00:14:05.558 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:14:05.633 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:14:05.637 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:14:05.640 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:14:05.641 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:14:05.646 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:14:05.648 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:14:05.650 -03:00 [DBG] Start key discovery request
2018-08-27 00:14:36.805 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:14:36.817 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:14:36.820 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:14:36.823 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:14:36.829 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:14:36.833 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:14:36.834 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:14:36.850 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:14:39.039 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 00:14:39.599 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 00:14:39.627 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGBL5CF5VCF:00000009",
  "TimeStamp": "2018-08-27T03:14:39Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:14:39.638 -03:00 [DBG] Augmenting SignInContext
2018-08-27 00:14:39.642 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 00:14:39.645 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 00:14:39.647 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 00:14:39.658 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 00:14:39.663 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 00:14:39.666 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 00:14:39.670 -03:00 [DBG] Start authorize callback request
2018-08-27 00:14:39.672 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:14:39.677 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:14:39.693 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:14:39.701 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:14:39.706 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:14:39.713 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:14:39.719 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:14:39.721 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:14:39.723 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "FDcYsY5LbOU48lfq3XQTv8mIjTzhTcX0ppIXf6U6;login",
  "Nonce": "FDcYsY5LbOU48lfq3XQTv8mIjTzhTcX0ppIXf6U6",
  "SessionId": "599d5af2ec88c91cf67b3b180ce0464d",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "FDcYsY5LbOU48lfq3XQTv8mIjTzhTcX0ppIXf6U6;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "FDcYsY5LbOU48lfq3XQTv8mIjTzhTcX0ppIXf6U6"
  }
}
2018-08-27 00:14:39.736 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-27 00:14:39.742 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-27 00:14:39.743 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 00:14:39.746 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 00:14:39.747 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:14:39.761 -03:00 [DBG] pmoy4dNuyXIGBSdM7E0sN7rh1LcoC/R515nZ581Ctyo= not found in database
2018-08-27 00:14:39.769 -03:00 [DBG] Getting claims for identity token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3 and client: UserManagementUI
2018-08-27 00:14:39.771 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 00:14:39.774 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Rgsw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****a938"
    }
  ],
  "ActivityId": "0HLGBL5CF5VCF:0000000A",
  "TimeStamp": "2018-08-27T03:14:39Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:14:39.782 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "FDcYsY5LbOU48lfq3XQTv8mIjTzhTcX0ppIXf6U6;login",
  "Scope": "openid profile email"
}
2018-08-27 00:14:39.784 -03:00 [DBG] Augmenting SignInContext
2018-08-27 00:14:39.785 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 00:14:41.245 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:14:41.251 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:14:41.252 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:14:41.254 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:14:41.259 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:14:41.260 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:14:41.263 -03:00 [DBG] Start discovery request
2018-08-27 00:14:41.276 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:14:41.336 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:14:41.345 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:14:41.347 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:14:41.347 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:14:41.348 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:14:41.349 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:14:41.353 -03:00 [DBG] Start key discovery request
2018-08-27 00:14:44.377 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:14:44.382 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:14:44.385 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:14:44.387 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:14:44.398 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:14:44.405 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:14:44.410 -03:00 [DBG] Start discovery request
2018-08-27 00:14:44.423 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:14:44.476 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:14:44.481 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:14:44.482 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:14:44.483 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:14:44.487 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:14:44.490 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:14:44.492 -03:00 [DBG] Start key discovery request
2018-08-27 00:14:47.673 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 00:14:47.676 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 00:14:47.678 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 00:14:47.680 -03:00 [DBG] Processing signout request for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:14:47.682 -03:00 [DBG] Start end session request validation
2018-08-27 00:14:47.687 -03:00 [DBG] Start identity token validation
2018-08-27 00:14:47.703 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:14:47.704 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 00:14:47.713 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 00:14:47.718 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535339679,
    "exp": 1535339979,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "FDcYsY5LbOU48lfq3XQTv8mIjTzhTcX0ppIXf6U6",
    "iat": 1535339679,
    "at_hash": "-WGU1vXOySMKV7b4QdAC4g",
    "sid": "599d5af2ec88c91cf67b3b180ce0464d",
    "sub": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
    "auth_time": 1535339679,
    "idp": "Facebook",
    "amr": "external"
  }
}
2018-08-27 00:14:47.730 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzMzk2NzksImV4cCI6MTUzNTMzOTk3OSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiRkRjWXNZNUxiT1U0OGxmcTNYUVR2OG1JalR6aFRjWDBwcElYZjZVNiIsImlhdCI6MTUzNTMzOTY3OSwiYXRfaGFzaCI6Ii1XR1UxdlhPeVNNS1Y3YjRRZEFDNGciLCJzaWQiOiI1OTlkNWFmMmVjODhjOTFjZjY3YjNiMTgwY2UwNDY0ZCIsInN1YiI6IjQyMjYxYTVmLWExNGItNDhlNS04NTMzLTNiNmNhMjQ1NjRlMyIsImF1dGhfdGltZSI6MTUzNTMzOTY3OSwiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.VrTnYHyHp8A7oXvaM-3HuPMzE6xKshK_DHfjwCg846mOAzHhF7S1WRMQypAinJmzx_AQ_PL4lTMy6r4_pNRx4se8_mM_DnxpOnhjgpMO5x0Ghc5ce3ANo76q3MIRysKAAYx9RA_0tZDoJaUD7DtE4zMPI81FedWJ24Insigtn3VroKQm5g3moyQTBQ_LvenEUtR8nHVkdkaCQqsM31rozejm18GKoaU6Z5eIL29EsXI6fTS8i9JlwiGWy6StWu_tipblPKimOO9YmMOhRmlwNOqvCQpDZFLgWLh4pvGKFQ-tEoPGUhuri5Xm0gw244Z84hgkLA5GZfP8O5XeIlRgsw",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 00:14:47.736 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 00:14:47.750 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 00:14:47.751 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 00:14:47.754 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 00:14:47.755 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGBL5CF5VCF:0000000C",
  "TimeStamp": "2018-08-27T03:14:47Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:14:48.322 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 00:14:48.324 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 00:14:48.326 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 00:14:48.331 -03:00 [DBG] Processing signout callback request
2018-08-27 00:14:48.346 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:14:48.349 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 00:14:48.349 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 00:14:48.351 -03:00 [INF] Successful signout callback.
2018-08-27 00:14:48.354 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 00:14:48.354 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 00:14:51.389 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:14:51.393 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:14:51.395 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:14:51.397 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:14:51.400 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:14:51.404 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:14:51.405 -03:00 [DBG] Start discovery request
2018-08-27 00:14:51.416 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:14:51.483 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:14:51.488 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:14:51.489 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:14:51.491 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:14:51.494 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:14:51.498 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:14:51.500 -03:00 [DBG] Start key discovery request
2018-08-27 00:14:53.133 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 00:14:53.138 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 00:14:53.142 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 00:14:53.146 -03:00 [DBG] Start authorize request
2018-08-27 00:14:53.148 -03:00 [DBG] No user present in authorize request
2018-08-27 00:14:53.149 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:14:53.162 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:14:53.169 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:14:53.172 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:14:53.177 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:14:53.179 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:14:53.180 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:14:53.180 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "j08nIvQSufYquyL7WoHlieXWFaCVaioPNaOjylXN;login",
  "Nonce": "j08nIvQSufYquyL7WoHlieXWFaCVaioPNaOjylXN",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "j08nIvQSufYquyL7WoHlieXWFaCVaioPNaOjylXN;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "j08nIvQSufYquyL7WoHlieXWFaCVaioPNaOjylXN"
  }
}
2018-08-27 00:14:53.184 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 00:14:53.199 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:14:53.211 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:14:53.215 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:14:53.217 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:14:53.219 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:14:53.221 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:14:53.221 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:14:53.233 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:15:03.979 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 00:15:04.521 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 00:15:04.540 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGBL5CF5VCF:00000012",
  "TimeStamp": "2018-08-27T03:15:04Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:15:04.542 -03:00 [DBG] Augmenting SignInContext
2018-08-27 00:15:04.542 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 00:15:04.543 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 00:15:04.543 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 00:15:04.550 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 00:15:04.552 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 00:15:04.553 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 00:15:04.553 -03:00 [DBG] Start authorize callback request
2018-08-27 00:15:04.554 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:15:04.554 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:15:04.566 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:15:04.568 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:15:04.570 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:15:04.573 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:15:04.575 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:15:04.576 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:15:04.577 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "j08nIvQSufYquyL7WoHlieXWFaCVaioPNaOjylXN;login",
  "Nonce": "j08nIvQSufYquyL7WoHlieXWFaCVaioPNaOjylXN",
  "SessionId": "b0c35d4056ad31304ed1283201d6144f",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "j08nIvQSufYquyL7WoHlieXWFaCVaioPNaOjylXN;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "j08nIvQSufYquyL7WoHlieXWFaCVaioPNaOjylXN"
  }
}
2018-08-27 00:15:04.583 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-27 00:15:04.589 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-27 00:15:04.597 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 00:15:04.597 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 00:15:04.602 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:15:04.621 -03:00 [DBG] UaWK+mySy5wT0cUdSPrJHCVN3edtMN8hY7ZiuKdGSrI= not found in database
2018-08-27 00:15:04.631 -03:00 [DBG] Getting claims for identity token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3 and client: UserManagementUI
2018-08-27 00:15:04.632 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 00:15:04.635 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****XOvQ"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****329a"
    }
  ],
  "ActivityId": "0HLGBL5CF5VCF:00000013",
  "TimeStamp": "2018-08-27T03:15:04Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:15:04.642 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "j08nIvQSufYquyL7WoHlieXWFaCVaioPNaOjylXN;login",
  "Scope": "openid profile email"
}
2018-08-27 00:15:04.643 -03:00 [DBG] Augmenting SignInContext
2018-08-27 00:15:04.644 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 00:15:06.484 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:15:06.488 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:15:06.489 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:15:06.490 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:15:06.490 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:15:06.491 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:15:06.491 -03:00 [DBG] Start discovery request
2018-08-27 00:15:06.501 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:15:06.581 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:15:06.584 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:15:06.584 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:15:06.585 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:15:06.585 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:15:06.586 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:15:06.586 -03:00 [DBG] Start key discovery request
2018-08-27 00:16:35.847 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:16:35.851 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:16:35.856 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:16:35.860 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:16:35.860 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:16:35.861 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:16:35.861 -03:00 [DBG] Start discovery request
2018-08-27 00:16:35.872 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:16:35.942 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:16:35.944 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:16:35.945 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:16:35.945 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:16:35.945 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:16:35.946 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:16:35.946 -03:00 [DBG] Start key discovery request
2018-08-27 00:18:26.165 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:18:26.183 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:18:26.187 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:18:26.189 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:18:26.192 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:18:26.193 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:18:26.195 -03:00 [DBG] Start discovery request
2018-08-27 00:18:26.205 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:18:26.228 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:18:26.234 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:18:26.236 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:18:26.237 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:18:26.237 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:18:26.238 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:18:26.238 -03:00 [DBG] Start discovery request
2018-08-27 00:18:26.250 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:18:26.263 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:18:26.265 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:18:26.280 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:18:26.282 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:18:26.283 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:18:26.284 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:18:26.284 -03:00 [DBG] Start key discovery request
2018-08-27 00:18:26.464 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:18:26.489 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:18:26.491 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:18:26.492 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:18:26.494 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:18:26.496 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:18:26.501 -03:00 [DBG] Start key discovery request
2018-08-27 00:18:35.157 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:18:35.161 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:18:35.162 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:18:35.163 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:18:35.164 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:18:35.165 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:18:35.165 -03:00 [DBG] Start discovery request
2018-08-27 00:18:35.179 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:18:35.234 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:18:35.237 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:18:35.238 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:18:35.238 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:18:35.239 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:18:35.239 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:18:35.239 -03:00 [DBG] Start key discovery request
2018-08-27 00:19:12.698 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:19:12.713 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:12.721 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:12.721 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:19:12.724 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:19:12.724 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:19:12.725 -03:00 [DBG] Start discovery request
2018-08-27 00:19:12.736 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:19:12.841 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:19:12.847 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:12.848 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:12.848 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:19:12.849 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:19:12.849 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:19:12.850 -03:00 [DBG] Start key discovery request
2018-08-27 00:19:16.633 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:19:16.639 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:16.640 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:16.640 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:19:16.641 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:19:16.641 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:19:16.642 -03:00 [DBG] Start discovery request
2018-08-27 00:19:16.653 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:19:16.665 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:19:16.670 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:16.672 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:16.673 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:19:16.674 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:19:16.674 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:19:16.674 -03:00 [DBG] Start key discovery request
2018-08-27 00:19:17.708 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:19:17.711 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:17.712 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:17.712 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:19:17.713 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:19:17.714 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:19:17.715 -03:00 [DBG] Start discovery request
2018-08-27 00:19:17.727 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:19:17.735 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:19:17.738 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:17.738 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:17.738 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:19:17.740 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:19:17.740 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:19:17.741 -03:00 [DBG] Start key discovery request
2018-08-27 00:19:18.039 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:19:18.044 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:18.045 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:18.045 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:19:18.046 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:19:18.046 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:19:18.047 -03:00 [DBG] Start discovery request
2018-08-27 00:19:18.057 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:19:18.068 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:19:18.070 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:18.071 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:18.071 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:19:18.071 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:19:18.073 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:19:18.073 -03:00 [DBG] Start key discovery request
2018-08-27 00:19:18.596 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:19:18.600 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:18.601 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:18.601 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:19:18.603 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:19:18.604 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:19:18.604 -03:00 [DBG] Start discovery request
2018-08-27 00:19:18.616 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:19:18.710 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:19:18.713 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:18.714 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:18.715 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:19:18.715 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:19:18.716 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:19:18.716 -03:00 [DBG] Start key discovery request
2018-08-27 00:19:19.001 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:19:19.007 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:19.008 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:19.009 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:19:19.009 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:19:19.010 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:19:19.010 -03:00 [DBG] Start discovery request
2018-08-27 00:19:19.023 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:19:19.036 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:19:19.039 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:19.040 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:19.040 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:19:19.041 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:19:19.041 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:19:19.041 -03:00 [DBG] Start key discovery request
2018-08-27 00:19:21.973 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 00:19:21.974 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 00:19:21.975 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 00:19:21.975 -03:00 [DBG] Processing signout request for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:19:21.976 -03:00 [DBG] Start end session request validation
2018-08-27 00:19:21.976 -03:00 [DBG] Start identity token validation
2018-08-27 00:19:21.988 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:19:21.988 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 00:19:21.993 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 00:19:21.993 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535339704,
    "exp": 1535340004,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "j08nIvQSufYquyL7WoHlieXWFaCVaioPNaOjylXN",
    "iat": 1535339704,
    "at_hash": "YLrxDox7_mHbaxn_Aozftw",
    "sid": "b0c35d4056ad31304ed1283201d6144f",
    "sub": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
    "auth_time": 1535339704,
    "idp": "Facebook",
    "amr": "external"
  }
}
2018-08-27 00:19:21.994 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzMzk3MDQsImV4cCI6MTUzNTM0MDAwNCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiajA4bkl2UVN1ZllxdXlMN1dvSGxpZVhXRmFDVmFpb1BOYU9qeWxYTiIsImlhdCI6MTUzNTMzOTcwNCwiYXRfaGFzaCI6IllMcnhEb3g3X21IYmF4bl9Bb3pmdHciLCJzaWQiOiJiMGMzNWQ0MDU2YWQzMTMwNGVkMTI4MzIwMWQ2MTQ0ZiIsInN1YiI6IjQyMjYxYTVmLWExNGItNDhlNS04NTMzLTNiNmNhMjQ1NjRlMyIsImF1dGhfdGltZSI6MTUzNTMzOTcwNCwiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.YT_DHpaYcFwMBKxokE-Im-5ROlfnmZ-pkGhuykq-FP65sDY8WeNZoQ-vZbBl5xR4_feMSLpo812tYRaWL0-Nj3Tpy7T6JpY1RZwJCYvvvQB27hSmkWaPDFqmsveXT40Y3mhkBXqi3a6YUA7ec8ScFjlthnPxys4cH9v7Ar6bOKrlXkxMle4-Tx6QOBVoyY3Gcd_OjLQ-DlEgJ9XOe06eJ8mvGHinzE44jZcAMTskvcgpXdTd3SeAYbiQopsznpPa0y4kFjrmS8IWCp2pCl9FR1HNq0yHGKcFg2-lPqyA8D9us9vdciqBRuI0XEllqibewfkzblpJYuZATnwcVXXOvQ",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 00:19:21.995 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 00:19:22.007 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 00:19:22.007 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 00:19:22.008 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 00:19:22.008 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGBL5CF5VCF:00000015",
  "TimeStamp": "2018-08-27T03:19:22Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:19:22.445 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 00:19:22.446 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 00:19:22.447 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 00:19:22.447 -03:00 [DBG] Processing signout callback request
2018-08-27 00:19:22.458 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:19:22.458 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 00:19:22.459 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 00:19:22.459 -03:00 [INF] Successful signout callback.
2018-08-27 00:19:22.459 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 00:19:22.459 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 00:19:29.392 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:19:29.395 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:29.396 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:29.397 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:19:29.397 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:19:29.398 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:19:29.398 -03:00 [DBG] Start discovery request
2018-08-27 00:19:29.408 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:19:29.466 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:19:29.477 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:29.477 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:29.478 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:19:29.479 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:19:29.479 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:19:29.479 -03:00 [DBG] Start key discovery request
2018-08-27 00:19:30.699 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 00:19:30.700 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 00:19:30.701 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 00:19:30.701 -03:00 [DBG] Start authorize request
2018-08-27 00:19:30.701 -03:00 [DBG] No user present in authorize request
2018-08-27 00:19:30.702 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:19:30.715 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:19:30.718 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:19:30.720 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:19:30.724 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:19:30.726 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:19:30.727 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:19:30.727 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "xqOYSgLqPS3cHXh4x2nNv3AZtDSP5hZKGlzt4hK2;login",
  "Nonce": "xqOYSgLqPS3cHXh4x2nNv3AZtDSP5hZKGlzt4hK2",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "xqOYSgLqPS3cHXh4x2nNv3AZtDSP5hZKGlzt4hK2;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "xqOYSgLqPS3cHXh4x2nNv3AZtDSP5hZKGlzt4hK2"
  }
}
2018-08-27 00:19:30.728 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 00:19:30.738 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:19:30.749 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:19:30.756 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:19:30.758 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:19:30.761 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:19:30.763 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:19:30.764 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:19:30.775 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:19:32.272 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 00:19:32.944 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 00:19:32.973 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGBL5CF5VCG:00000014",
  "TimeStamp": "2018-08-27T03:19:32Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:19:32.975 -03:00 [DBG] Augmenting SignInContext
2018-08-27 00:19:32.975 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 00:19:32.975 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 00:19:32.976 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 00:19:32.982 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 00:19:32.983 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 00:19:32.987 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 00:19:32.987 -03:00 [DBG] Start authorize callback request
2018-08-27 00:19:32.988 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:19:32.988 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:19:32.997 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:19:32.999 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:19:33.000 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:19:33.002 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:19:33.004 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:19:33.004 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:19:33.004 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "xqOYSgLqPS3cHXh4x2nNv3AZtDSP5hZKGlzt4hK2;login",
  "Nonce": "xqOYSgLqPS3cHXh4x2nNv3AZtDSP5hZKGlzt4hK2",
  "SessionId": "3c0a43c4dd0a02a2525b4c89aece7f82",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "xqOYSgLqPS3cHXh4x2nNv3AZtDSP5hZKGlzt4hK2;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "xqOYSgLqPS3cHXh4x2nNv3AZtDSP5hZKGlzt4hK2"
  }
}
2018-08-27 00:19:33.018 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-27 00:19:33.024 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-27 00:19:33.025 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 00:19:33.026 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 00:19:33.027 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:19:33.038 -03:00 [DBG] rsEP/MGVSlspqe6hHzCqHyNKeedJ6h/Xkqp9Fd/Tpac= not found in database
2018-08-27 00:19:33.044 -03:00 [DBG] Getting claims for identity token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3 and client: UserManagementUI
2018-08-27 00:19:33.045 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 00:19:33.047 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****r0oQ"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****8613"
    }
  ],
  "ActivityId": "0HLGBL5CF5VCG:00000015",
  "TimeStamp": "2018-08-27T03:19:33Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:19:33.050 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "xqOYSgLqPS3cHXh4x2nNv3AZtDSP5hZKGlzt4hK2;login",
  "Scope": "openid profile email"
}
2018-08-27 00:19:33.050 -03:00 [DBG] Augmenting SignInContext
2018-08-27 00:19:33.051 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 00:19:34.418 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:19:34.421 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:34.422 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:34.423 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:19:34.424 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:19:34.424 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:19:34.425 -03:00 [DBG] Start discovery request
2018-08-27 00:19:34.437 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:19:34.504 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:19:34.507 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:19:34.508 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:19:34.508 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:19:34.509 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:19:34.509 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:19:34.509 -03:00 [DBG] Start key discovery request
2018-08-27 00:20:27.697 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:20:27.701 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:20:27.702 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:20:27.703 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:20:27.704 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:20:27.704 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:20:27.708 -03:00 [DBG] Start discovery request
2018-08-27 00:20:27.722 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:20:27.761 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:20:27.764 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:20:27.765 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:20:27.766 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:20:27.766 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:20:27.767 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:20:27.767 -03:00 [DBG] Start key discovery request
2018-08-27 00:20:28.821 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 00:20:28.823 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 00:20:28.824 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 00:20:28.825 -03:00 [DBG] Start authorize request
2018-08-27 00:20:28.825 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:20:28.826 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:20:28.836 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:20:28.840 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:20:28.842 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:20:28.845 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:20:28.847 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:20:28.847 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:20:28.848 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "D4Q3TaDwm2lDzJWKhN3oVP91cB6kYO2ctnrAIOm6;login",
  "Nonce": "D4Q3TaDwm2lDzJWKhN3oVP91cB6kYO2ctnrAIOm6",
  "SessionId": "3c0a43c4dd0a02a2525b4c89aece7f82",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "D4Q3TaDwm2lDzJWKhN3oVP91cB6kYO2ctnrAIOm6;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "D4Q3TaDwm2lDzJWKhN3oVP91cB6kYO2ctnrAIOm6"
  }
}
2018-08-27 00:20:28.853 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-27 00:20:28.857 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-27 00:20:28.857 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 00:20:28.857 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 00:20:28.857 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:20:28.868 -03:00 [DBG] 1rdyS+AupZWK4LkDqDlkH02uNDc2V2G7nr/+KxkOfQg= not found in database
2018-08-27 00:20:28.880 -03:00 [DBG] Getting claims for identity token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3 and client: UserManagementUI
2018-08-27 00:20:28.880 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 00:20:28.883 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****OKXg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****99c8"
    }
  ],
  "ActivityId": "0HLGBL5CF5VCG:00000016",
  "TimeStamp": "2018-08-27T03:20:28Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:20:28.887 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "D4Q3TaDwm2lDzJWKhN3oVP91cB6kYO2ctnrAIOm6;login",
  "Scope": "openid profile email"
}
2018-08-27 00:20:30.370 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:20:30.374 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:20:30.376 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:20:30.377 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:20:30.377 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:20:30.378 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:20:30.378 -03:00 [DBG] Start discovery request
2018-08-27 00:20:30.388 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:20:30.467 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:20:30.471 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:20:30.471 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:20:30.472 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:20:30.472 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:20:30.472 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:20:30.473 -03:00 [DBG] Start key discovery request
2018-08-27 00:20:46.516 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 00:20:46.517 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 00:20:46.518 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 00:20:46.518 -03:00 [DBG] Processing signout request for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:20:46.519 -03:00 [DBG] Start end session request validation
2018-08-27 00:20:46.519 -03:00 [DBG] Start identity token validation
2018-08-27 00:20:46.532 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:20:46.533 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 00:20:46.542 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 00:20:46.542 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535340028,
    "exp": 1535340328,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "D4Q3TaDwm2lDzJWKhN3oVP91cB6kYO2ctnrAIOm6",
    "iat": 1535340028,
    "at_hash": "L0uLM1L9BBGWTg2jSrlAfQ",
    "sid": "3c0a43c4dd0a02a2525b4c89aece7f82",
    "sub": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
    "auth_time": 1535339972,
    "idp": "Facebook",
    "amr": "external"
  }
}
2018-08-27 00:20:46.543 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzNDAwMjgsImV4cCI6MTUzNTM0MDMyOCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiRDRRM1RhRHdtMmxEekpXS2hOM29WUDkxY0I2a1lPMmN0bnJBSU9tNiIsImlhdCI6MTUzNTM0MDAyOCwiYXRfaGFzaCI6IkwwdUxNMUw5QkJHV1RnMmpTcmxBZlEiLCJzaWQiOiIzYzBhNDNjNGRkMGEwMmEyNTI1YjRjODlhZWNlN2Y4MiIsInN1YiI6IjQyMjYxYTVmLWExNGItNDhlNS04NTMzLTNiNmNhMjQ1NjRlMyIsImF1dGhfdGltZSI6MTUzNTMzOTk3MiwiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.Xvtcy2CKubOI2l6pQNdCMt9AV8_UXf2tVUE_GMO9tu9gAVHthYhPTiWqjiR-fbTiZD4vbXYSvhORI0Kt9qvPqEqZJCvZmPUE9CQK9-1Fzk9JjSlI5ZuqiEv0NNT_3AwcuknK49XnCA0lb3tpHieEC9m0UW_hVIz9cGNEbXX5bv89pRj54QHKjfDHY6UWgnfhbiFIYyx_0gg91vocw8A1GULJDnapDdmEvSJbYfks5DHqfoXXiNFByZODR3xeWo4CfmMcnU6367moftEutEYoCIk0mmLaDJ1JTRtGwxQRQIvF1bqdtw5mx3ODf21bLYIOpAsX-c8aMS4C3EpqGbOKXg",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 00:20:46.543 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 00:20:46.554 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 00:20:46.554 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 00:20:46.555 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 00:20:46.555 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGBL5CF5VCG:00000018",
  "TimeStamp": "2018-08-27T03:20:46Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:20:46.922 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 00:20:46.923 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 00:20:46.923 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 00:20:46.923 -03:00 [DBG] Processing signout callback request
2018-08-27 00:20:46.934 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:20:46.935 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 00:20:46.935 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 00:20:46.935 -03:00 [INF] Successful signout callback.
2018-08-27 00:20:46.936 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 00:20:46.936 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 00:20:50.521 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:20:50.525 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:20:50.526 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:20:50.527 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:20:50.527 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:20:50.528 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:20:50.528 -03:00 [DBG] Start discovery request
2018-08-27 00:20:50.539 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:20:50.563 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:20:50.566 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:20:50.566 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:20:50.567 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:20:50.567 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:20:50.568 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:20:50.568 -03:00 [DBG] Start key discovery request
2018-08-27 00:21:44.988 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:21:45.001 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:21:45.002 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:21:45.002 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:21:45.003 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:21:45.007 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:21:45.007 -03:00 [DBG] Start discovery request
2018-08-27 00:21:45.027 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:21:45.190 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:21:45.218 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:21:45.220 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:21:45.220 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:21:45.221 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:21:45.221 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:21:45.222 -03:00 [DBG] Start key discovery request
2018-08-27 00:21:45.315 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 00:21:45.316 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 00:21:45.317 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 00:21:45.317 -03:00 [DBG] Start authorize request
2018-08-27 00:21:45.318 -03:00 [DBG] No user present in authorize request
2018-08-27 00:21:45.318 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:21:45.331 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:21:45.335 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:21:45.338 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:21:45.342 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:21:45.344 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:21:45.345 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:21:45.345 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "rsI0nhST9AtXH9q94GMFy2d9cPvZ9hUzBUPHl2BK",
  "Nonce": "rsI0nhST9AtXH9q94GMFy2d9cPvZ9hUzBUPHl2BK",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "rsI0nhST9AtXH9q94GMFy2d9cPvZ9hUzBUPHl2BK",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "rsI0nhST9AtXH9q94GMFy2d9cPvZ9hUzBUPHl2BK"
  }
}
2018-08-27 00:21:45.346 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 00:21:45.427 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:21:45.448 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:21:45.453 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:21:45.456 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:21:45.461 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:21:45.464 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:21:45.465 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:21:45.481 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:21:50.121 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 00:21:50.122 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 00:21:50.123 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 00:21:50.123 -03:00 [DBG] Start authorize request
2018-08-27 00:21:50.124 -03:00 [DBG] No user present in authorize request
2018-08-27 00:21:50.124 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:21:50.147 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:21:50.151 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:21:50.153 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:21:50.158 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:21:50.160 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:21:50.161 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:21:50.162 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "KLbTZQ2cuZpz6Y8azkBdhskE30OREcF0zQK8YnxQ",
  "Nonce": "KLbTZQ2cuZpz6Y8azkBdhskE30OREcF0zQK8YnxQ",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "KLbTZQ2cuZpz6Y8azkBdhskE30OREcF0zQK8YnxQ",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "KLbTZQ2cuZpz6Y8azkBdhskE30OREcF0zQK8YnxQ"
  }
}
2018-08-27 00:21:50.163 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 00:21:50.174 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:21:50.183 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:21:50.186 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:21:50.189 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:21:50.191 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:21:50.192 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:21:50.193 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:21:50.203 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:22:00.164 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 00:22:00.844 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 00:22:00.864 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGBL5CF5VCG:0000001E",
  "TimeStamp": "2018-08-27T03:22:00Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:22:00.866 -03:00 [DBG] Augmenting SignInContext
2018-08-27 00:22:00.866 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 00:22:00.866 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 00:22:00.867 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 00:22:00.874 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 00:22:00.877 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 00:22:00.877 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 00:22:00.877 -03:00 [DBG] Start authorize callback request
2018-08-27 00:22:00.878 -03:00 [DBG] User in authorize request: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:22:00.878 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:22:00.889 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:22:00.892 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:22:00.894 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:22:00.897 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:22:00.899 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:22:00.899 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:22:00.899 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "KLbTZQ2cuZpz6Y8azkBdhskE30OREcF0zQK8YnxQ",
  "Nonce": "KLbTZQ2cuZpz6Y8azkBdhskE30OREcF0zQK8YnxQ",
  "SessionId": "18344c3951ffb7204544374da4199161",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "KLbTZQ2cuZpz6Y8azkBdhskE30OREcF0zQK8YnxQ",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "KLbTZQ2cuZpz6Y8azkBdhskE30OREcF0zQK8YnxQ"
  }
}
2018-08-27 00:22:00.907 -03:00 [DBG] nk+ZQxr0k2XfRFPYE+E0SyRDpdFTbCW7mjS8HzFg7lQ= found in database: true
2018-08-27 00:22:00.911 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-27 00:22:00.911 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 00:22:00.911 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 00:22:00.911 -03:00 [DBG] Getting claims for access token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:22:00.924 -03:00 [DBG] IeOHp6rHZq+HL92IbWoBYBXxthrMQr4qvC6fI4nXGXs= not found in database
2018-08-27 00:22:00.929 -03:00 [DBG] Getting claims for identity token for subject: 42261a5f-a14b-48e5-8533-3b6ca24564e3 and client: UserManagementUI
2018-08-27 00:22:00.930 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 00:22:00.932 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****r4Mw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****681d"
    }
  ],
  "ActivityId": "0HLGBL5CF5VCG:0000001F",
  "TimeStamp": "2018-08-27T03:22:00Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:22:00.933 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "KLbTZQ2cuZpz6Y8azkBdhskE30OREcF0zQK8YnxQ",
  "Scope": "openid profile email"
}
2018-08-27 00:22:00.934 -03:00 [DBG] Augmenting SignInContext
2018-08-27 00:22:00.934 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 00:22:02.593 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:22:02.596 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:22:02.597 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:22:02.597 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:22:02.598 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:22:02.599 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:22:02.599 -03:00 [DBG] Start discovery request
2018-08-27 00:22:02.609 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:22:02.679 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:22:02.682 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:22:02.684 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:22:02.684 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:22:02.684 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:22:02.685 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:22:02.685 -03:00 [DBG] Start key discovery request
2018-08-27 00:22:07.369 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 00:22:07.371 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 00:22:07.372 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 00:22:07.372 -03:00 [DBG] Processing signout request for 42261a5f-a14b-48e5-8533-3b6ca24564e3
2018-08-27 00:22:07.372 -03:00 [DBG] Start end session request validation
2018-08-27 00:22:07.373 -03:00 [DBG] Start identity token validation
2018-08-27 00:22:07.387 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:22:07.387 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 00:22:07.393 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 00:22:07.394 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535340120,
    "exp": 1535340420,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "KLbTZQ2cuZpz6Y8azkBdhskE30OREcF0zQK8YnxQ",
    "iat": 1535340120,
    "at_hash": "9dlrjTOHW10kbvSOp8e2Fg",
    "sid": "18344c3951ffb7204544374da4199161",
    "sub": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
    "auth_time": 1535340120,
    "idp": "Facebook",
    "amr": "external"
  }
}
2018-08-27 00:22:07.394 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzNDAxMjAsImV4cCI6MTUzNTM0MDQyMCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiS0xiVFpRMmN1WnB6Nlk4YXprQmRoc2tFMzBPUkVjRjB6UUs4WW54USIsImlhdCI6MTUzNTM0MDEyMCwiYXRfaGFzaCI6IjlkbHJqVE9IVzEwa2J2U09wOGUyRmciLCJzaWQiOiIxODM0NGMzOTUxZmZiNzIwNDU0NDM3NGRhNDE5OTE2MSIsInN1YiI6IjQyMjYxYTVmLWExNGItNDhlNS04NTMzLTNiNmNhMjQ1NjRlMyIsImF1dGhfdGltZSI6MTUzNTM0MDEyMCwiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.DV3R2LS4bjMXn33laGZ1jNEI_1xVzfE7knoHmM6jUdPdHFl6wX_vul8aNgX3lgoR7hlQNozlqrmN_R_O8bbNSAU2dafVQuwBCQX5AWuQtfb6D5psxWhphiBrhwUXtPjTJWOFakTkIdKo_6i_l60cE1Pay44fLSrG7dvo5OTGWXVOE_c4jnQNdnz7PHtHmR2TNLIIXXtirsPQP3E0DhyIqbB0DndduHJs7Wqu1N1-sjgcA6_TVUOlnkbI8Czms8kbaMZc5LgJODx3Eam9xKQPjDPinsUCMlt9ZGK5E_ajfvdvFFN8lYsJ9NzUJ2jUwGB0_3WuByE5GGOAYb6tonr4Mw",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 00:22:07.395 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 00:22:07.405 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 00:22:07.406 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 00:22:07.406 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 00:22:07.407 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "42261a5f-a14b-48e5-8533-3b6ca24564e3",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGBL5CF5VCG:00000021",
  "TimeStamp": "2018-08-27T03:22:07Z",
  "ProcessId": 27532,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 00:22:07.783 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 00:22:07.785 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 00:22:07.785 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 00:22:07.785 -03:00 [DBG] Processing signout callback request
2018-08-27 00:22:07.798 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:22:07.799 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 00:22:07.800 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 00:22:07.801 -03:00 [INF] Successful signout callback.
2018-08-27 00:22:07.801 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 00:22:07.801 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 00:22:11.014 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:22:11.024 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:22:11.026 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:22:11.027 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:22:11.027 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:22:11.028 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:22:11.028 -03:00 [DBG] Start discovery request
2018-08-27 00:22:11.038 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:22:11.065 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:22:11.069 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:22:11.069 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:22:11.070 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:22:11.070 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:22:11.071 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:22:11.071 -03:00 [DBG] Start key discovery request
2018-08-27 00:22:11.203 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 00:22:11.206 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 00:22:11.207 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 00:22:11.208 -03:00 [DBG] Start authorize request
2018-08-27 00:22:11.208 -03:00 [DBG] No user present in authorize request
2018-08-27 00:22:11.209 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:22:11.223 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:22:11.226 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:22:11.228 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:22:11.232 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:22:11.234 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:22:11.234 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:22:11.234 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "Jrj5A8gg3EzivXORYNb2fe90DiR69lvGgK5S6MYO",
  "Nonce": "Jrj5A8gg3EzivXORYNb2fe90DiR69lvGgK5S6MYO",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "Jrj5A8gg3EzivXORYNb2fe90DiR69lvGgK5S6MYO",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "Jrj5A8gg3EzivXORYNb2fe90DiR69lvGgK5S6MYO"
  }
}
2018-08-27 00:22:11.235 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 00:22:11.249 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:22:11.259 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:22:11.262 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:22:11.264 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:22:11.268 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:22:11.269 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:22:11.269 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:22:11.279 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:22:19.904 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 00:22:19.905 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 00:22:19.906 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 00:22:19.906 -03:00 [DBG] Processing signout callback request
2018-08-27 00:22:19.918 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:22:19.919 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 00:22:19.920 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 00:22:19.921 -03:00 [INF] Successful signout callback.
2018-08-27 00:22:19.921 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 00:22:19.922 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 00:22:25.914 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 00:22:25.922 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:22:25.923 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:22:25.923 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 00:22:25.925 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 00:22:25.926 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 00:22:25.926 -03:00 [DBG] Start discovery request
2018-08-27 00:22:25.936 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 00:22:25.957 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 00:22:25.960 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 00:22:25.960 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 00:22:25.961 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 00:22:25.961 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 00:22:25.962 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 00:22:25.963 -03:00 [DBG] Start key discovery request
2018-08-27 00:22:26.108 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 00:22:26.111 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 00:22:26.112 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 00:22:26.112 -03:00 [DBG] Start authorize request
2018-08-27 00:22:26.113 -03:00 [DBG] No user present in authorize request
2018-08-27 00:22:26.113 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:22:26.133 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:22:26.138 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:22:26.141 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:22:26.144 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:22:26.146 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:22:26.146 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:22:26.146 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "eD958EUmQw9xEzYIMFLn56eXPsOMhQ1Kzof3essB",
  "Nonce": "eD958EUmQw9xEzYIMFLn56eXPsOMhQ1Kzof3essB",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "eD958EUmQw9xEzYIMFLn56eXPsOMhQ1Kzof3essB",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "eD958EUmQw9xEzYIMFLn56eXPsOMhQ1Kzof3essB"
  }
}
2018-08-27 00:22:26.147 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 00:22:26.158 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:22:26.169 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:22:26.174 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:22:26.178 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:22:26.181 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:22:26.185 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:22:26.186 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:22:26.195 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:37:17.020 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 00:37:17.053 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 00:37:17.054 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 00:37:17.054 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 00:37:17.054 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 00:37:17.172 -03:00 [DBG] Starting token cleanup
2018-08-27 00:37:22.058 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:37:22.443 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:37:22.503 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:37:22.565 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:37:22.580 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:37:22.583 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:37:22.591 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:37:22.605 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:38:17.407 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:38:17.426 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:38:17.431 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:38:17.435 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:38:17.440 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:38:17.444 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:38:17.446 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:38:17.461 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:38:37.209 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:38:37.224 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:38:37.229 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:38:37.235 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:38:37.240 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:38:37.243 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:38:37.246 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:38:37.259 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:40:27.197 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 00:40:27.230 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 00:40:27.231 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 00:40:27.231 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 00:40:27.231 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 00:40:27.351 -03:00 [DBG] Starting token cleanup
2018-08-27 00:40:34.903 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 00:40:35.313 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:40:35.382 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:40:35.455 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:40:35.472 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 00:40:35.475 -03:00 [DBG] Found [] API scopes in database
2018-08-27 00:40:35.482 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 00:40:35.496 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 00:46:54.707 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 00:46:54.745 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 00:46:54.746 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 00:46:54.746 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 00:46:54.746 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 00:46:54.879 -03:00 [DBG] Starting token cleanup
2018-08-27 00:47:00.350 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 00:47:06.244 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 00:47:09.504 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 00:47:12.675 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 00:48:43.914 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 00:48:43.945 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 00:48:43.946 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 00:48:43.947 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 00:48:43.947 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 00:48:44.062 -03:00 [DBG] Starting token cleanup
2018-08-27 00:48:50.987 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 00:49:31.544 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 00:49:31.589 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 00:49:31.590 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 00:49:31.591 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 00:49:31.591 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 00:49:31.732 -03:00 [DBG] Starting token cleanup
2018-08-27 00:49:39.429 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 00:50:44.335 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 00:50:44.358 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 00:50:44.358 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 00:50:44.358 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 00:50:44.359 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 00:50:44.440 -03:00 [DBG] Starting token cleanup
2018-08-27 00:51:01.636 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 00:52:07.802 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 00:52:07.828 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 00:52:07.828 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 00:52:07.828 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 00:52:07.828 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 00:52:07.962 -03:00 [DBG] Starting token cleanup
2018-08-27 00:52:10.647 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 00:52:33.929 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 00:52:33.956 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 00:52:33.956 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 00:52:33.956 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 00:52:33.957 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 00:52:34.066 -03:00 [DBG] Starting token cleanup
2018-08-27 00:52:40.935 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 00:53:35.830 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 00:53:35.858 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 00:53:35.858 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 00:53:35.858 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 00:53:35.858 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 00:53:35.974 -03:00 [DBG] Starting token cleanup
2018-08-27 00:53:37.417 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 00:54:53.068 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 00:54:53.095 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 00:54:53.095 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 00:54:53.095 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 00:54:53.096 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 00:54:53.199 -03:00 [DBG] Starting token cleanup
2018-08-27 00:54:53.706 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:03:28.382 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 01:03:28.404 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 01:03:28.404 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 01:03:28.404 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 01:03:28.405 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 01:03:28.484 -03:00 [DBG] Starting token cleanup
2018-08-27 01:03:35.838 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:05:00.482 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 01:05:00.506 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 01:05:00.506 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 01:05:00.507 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 01:05:00.507 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 01:05:00.603 -03:00 [DBG] Starting token cleanup
2018-08-27 01:05:04.226 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:11:19.098 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 01:11:19.124 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 01:11:19.124 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 01:11:19.125 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 01:11:19.125 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 01:11:19.214 -03:00 [DBG] Starting token cleanup
2018-08-27 01:11:40.988 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:12:15.084 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:13:04.371 -03:00 [DBG] CORS request made for path: /Account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:14:33.854 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 01:14:33.878 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 01:14:33.879 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 01:14:33.879 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 01:14:33.879 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 01:14:33.958 -03:00 [DBG] Starting token cleanup
2018-08-27 01:14:35.994 -03:00 [DBG] CORS request made for path: /Account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:15:27.202 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 01:15:27.225 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 01:15:27.225 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 01:15:27.225 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 01:15:27.226 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 01:15:27.309 -03:00 [DBG] Starting token cleanup
2018-08-27 01:15:28.389 -03:00 [DBG] CORS request made for path: /Account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:15:38.871 -03:00 [DBG] CORS request made for path: /Account/login from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:15:52.074 -03:00 [DBG] CORS request made for path: /Account/loginInfo from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:16:11.128 -03:00 [DBG] CORS request made for path: /Account/LoginInfo from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:16:22.787 -03:00 [DBG] CORS request made for path: /Account/Register from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:17:24.315 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 01:17:24.339 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 01:17:24.340 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 01:17:24.340 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 01:17:24.340 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 01:17:24.425 -03:00 [DBG] Starting token cleanup
2018-08-27 01:17:27.259 -03:00 [DBG] CORS request made for path: /Account/Register from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:17:30.425 -03:00 [DBG] CORS request made for path: /Account/Register from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:17:43.436 -03:00 [DBG] CORS request made for path: /Account/Login from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:17:49.109 -03:00 [DBG] CORS request made for path: /Account/Login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:17:54.382 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:21:41.608 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 01:21:41.637 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 01:21:41.637 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 01:21:41.637 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 01:21:41.638 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 01:21:41.724 -03:00 [DBG] Starting token cleanup
2018-08-27 01:21:53.545 -03:00 [DBG] CORS request made for path: /account/login-info from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 01:23:12.037 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 01:23:12.256 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 01:23:12.263 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 01:23:12.276 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 01:23:12.289 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 01:23:12.292 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 01:23:12.298 -03:00 [DBG] Start discovery request
2018-08-27 01:23:12.666 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 01:23:12.703 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 01:23:12.711 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 01:23:12.713 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 01:23:12.716 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 01:23:12.720 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 01:23:12.721 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 01:23:12.725 -03:00 [DBG] Start key discovery request
2018-08-27 01:23:12.767 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 01:23:12.778 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 01:23:12.779 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 01:23:12.785 -03:00 [DBG] Start authorize request
2018-08-27 01:23:12.795 -03:00 [DBG] No user present in authorize request
2018-08-27 01:23:12.802 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 01:23:13.067 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 01:23:13.117 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 01:23:13.158 -03:00 [DBG] Found [] API scopes in database
2018-08-27 01:23:13.168 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 01:23:13.172 -03:00 [DBG] Found [] API scopes in database
2018-08-27 01:23:13.180 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 01:23:13.197 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "yKeW7H5zXZ4MfM6AjvyKwBWeOU4h7lVePVI4ntBy",
  "Nonce": "yKeW7H5zXZ4MfM6AjvyKwBWeOU4h7lVePVI4ntBy",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "yKeW7H5zXZ4MfM6AjvyKwBWeOU4h7lVePVI4ntBy",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "yKeW7H5zXZ4MfM6AjvyKwBWeOU4h7lVePVI4ntBy"
  }
}
2018-08-27 01:23:13.209 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 01:23:13.291 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 01:23:13.305 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 01:23:13.309 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 01:23:13.314 -03:00 [DBG] Found [] API scopes in database
2018-08-27 01:23:13.320 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 01:23:13.325 -03:00 [DBG] Found [] API scopes in database
2018-08-27 01:23:13.328 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 01:23:13.343 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 01:23:23.874 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 01:23:23.878 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 01:23:23.883 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 01:23:23.889 -03:00 [DBG] Start discovery request
2018-08-27 01:23:23.909 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 01:30:46.204 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 01:30:46.227 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 01:30:46.227 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 01:30:46.228 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 01:30:46.228 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 01:30:46.311 -03:00 [DBG] Starting token cleanup
2018-08-27 01:43:43.648 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 01:43:43.677 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 01:43:43.677 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 01:43:43.677 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 01:43:43.677 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 01:43:43.763 -03:00 [DBG] Starting token cleanup
2018-08-27 02:06:31.960 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 02:06:31.992 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 02:06:31.992 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 02:06:31.993 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 02:06:31.993 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 02:06:32.102 -03:00 [DBG] Starting token cleanup
2018-08-27 02:09:32.686 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 02:09:32.712 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 02:09:32.712 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 02:09:32.713 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 02:09:32.713 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 02:09:32.801 -03:00 [DBG] Starting token cleanup
2018-08-27 02:10:47.875 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 02:10:47.904 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 02:10:47.905 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 02:10:47.906 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 02:10:47.906 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 02:10:48.058 -03:00 [DBG] Starting token cleanup
2018-08-27 02:13:38.399 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 02:13:38.422 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 02:13:38.423 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 02:13:38.423 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 02:13:38.423 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 02:13:38.509 -03:00 [DBG] Starting token cleanup
2018-08-27 02:16:18.706 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 02:16:18.736 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 02:16:18.737 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 02:16:18.737 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 02:16:18.737 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 02:16:18.830 -03:00 [DBG] Starting token cleanup
2018-08-27 02:36:25.015 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 02:36:25.042 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 02:36:25.043 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 02:36:25.043 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 02:36:25.043 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 02:36:25.150 -03:00 [DBG] Starting token cleanup
2018-08-27 02:40:49.679 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 02:40:49.715 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 02:40:49.716 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 02:40:49.716 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 02:40:49.716 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 02:40:49.861 -03:00 [DBG] Starting token cleanup
2018-08-27 09:33:06.405 -03:00 [ERR] Failed executing DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Clients] AS [c])
    THEN CAST(1 AS BIT) ELSE CAST(0 AS BIT)
END
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Clients'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
ClientConnectionId:55fc56b8-f15d-4295-95b3-13be7abdcc56
Error Number:208,State:1,Class:16
2018-08-27 09:33:06.463 -03:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.ConfigurationDbContext'.
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Clients'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.QueryMethodProvider.GetResult[TResult](IEnumerable`1 valueBuffers, Boolean throwOnNullResult)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
ClientConnectionId:55fc56b8-f15d-4295-95b3-13be7abdcc56
Error Number:208,State:1,Class:16
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Clients'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.QueryMethodProvider.GetResult[TResult](IEnumerable`1 valueBuffers, Boolean throwOnNullResult)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
ClientConnectionId:55fc56b8-f15d-4295-95b3-13be7abdcc56
Error Number:208,State:1,Class:16
2018-08-27 09:33:06.595 -03:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.ConfigurationDbContext'.
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Clients'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.QueryMethodProvider.GetResult[TResult](IEnumerable`1 valueBuffers, Boolean throwOnNullResult)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
ClientConnectionId:55fc56b8-f15d-4295-95b3-13be7abdcc56
Error Number:208,State:1,Class:16
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Clients'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.QueryMethodProvider.GetResult[TResult](IEnumerable`1 valueBuffers, Boolean throwOnNullResult)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
ClientConnectionId:55fc56b8-f15d-4295-95b3-13be7abdcc56
Error Number:208,State:1,Class:16
2018-08-27 09:33:34.813 -03:00 [ERR] Failed executing DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Clients] AS [c])
    THEN CAST(1 AS BIT) ELSE CAST(0 AS BIT)
END
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Clients'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
ClientConnectionId:9e70e5b9-69db-4893-8bf9-b7d932d6856d
Error Number:208,State:1,Class:16
2018-08-27 09:33:34.867 -03:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.ConfigurationDbContext'.
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Clients'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.QueryMethodProvider.GetResult[TResult](IEnumerable`1 valueBuffers, Boolean throwOnNullResult)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
ClientConnectionId:9e70e5b9-69db-4893-8bf9-b7d932d6856d
Error Number:208,State:1,Class:16
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Clients'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.QueryMethodProvider.GetResult[TResult](IEnumerable`1 valueBuffers, Boolean throwOnNullResult)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
ClientConnectionId:9e70e5b9-69db-4893-8bf9-b7d932d6856d
Error Number:208,State:1,Class:16
2018-08-27 09:33:34.885 -03:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.ConfigurationDbContext'.
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Clients'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.QueryMethodProvider.GetResult[TResult](IEnumerable`1 valueBuffers, Boolean throwOnNullResult)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
ClientConnectionId:9e70e5b9-69db-4893-8bf9-b7d932d6856d
Error Number:208,State:1,Class:16
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Clients'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.QueryMethodProvider.GetResult[TResult](IEnumerable`1 valueBuffers, Boolean throwOnNullResult)
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ResultEnumerable`1.GetEnumerator()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
ClientConnectionId:9e70e5b9-69db-4893-8bf9-b7d932d6856d
Error Number:208,State:1,Class:16
2018-08-27 09:50:36.816 -03:00 [ERR] Failed executing DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PersistedGrants] (
    [Key] nvarchar(200) NOT NULL,
    [Type] nvarchar(50) NOT NULL,
    [SubjectId] nvarchar(200) NULL,
    [ClientId] nvarchar(200) NOT NULL,
    [CreationTime] datetime2 NOT NULL,
    [Expiration] datetime2 NULL,
    [Data] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_PersistedGrants] PRIMARY KEY ([Key])
);
GO


CREATE INDEX [IX_PersistedGrants_SubjectId_ClientId_Type] ON [PersistedGrants] ([SubjectId], [ClientId], [Type]);
GO
System.Data.SqlClient.SqlException (0x80131904): Incorrect syntax near 'GO'.
Incorrect syntax near 'GO'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite, String methodName)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
ClientConnectionId:c731aa00-7588-4954-9535-f7dd5fcaa096
Error Number:102,State:1,Class:15
2018-08-27 09:51:36.305 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 09:51:36.326 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 09:51:36.326 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 09:51:36.327 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 09:51:36.327 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 09:51:36.398 -03:00 [DBG] Starting token cleanup
2018-08-27 11:05:23.929 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 11:05:23.969 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 11:05:23.971 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 11:05:23.971 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 11:05:23.971 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 11:05:24.072 -03:00 [DBG] Starting token cleanup
2018-08-27 11:05:43.868 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 11:05:43.888 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 11:05:43.889 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 11:05:43.889 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 11:05:43.889 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 11:05:43.958 -03:00 [DBG] Starting token cleanup
2018-08-27 11:07:21.327 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 11:07:21.347 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 11:07:21.348 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 11:07:21.348 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 11:07:21.348 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 11:07:21.424 -03:00 [DBG] Starting token cleanup
2018-08-27 11:21:18.483 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:21:18.624 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:21:18.627 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:21:18.640 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:21:18.648 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:21:18.649 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:21:18.652 -03:00 [DBG] Start discovery request
2018-08-27 11:21:18.914 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:21:18.950 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:21:18.956 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:21:18.957 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:21:18.958 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:21:18.959 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:21:18.960 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:21:18.963 -03:00 [DBG] Start key discovery request
2018-08-27 11:21:18.985 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:21:18.990 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:21:18.991 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:21:18.995 -03:00 [DBG] Start authorize request
2018-08-27 11:21:19.001 -03:00 [DBG] No user present in authorize request
2018-08-27 11:21:19.004 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:21:19.187 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:21:19.226 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:21:19.255 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:21:19.265 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:21:19.268 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:21:19.273 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:21:19.281 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "2v8glgZdK5pJ1wnr1EFXUlfOzmLZNDy18O1pEehx",
  "Nonce": "2v8glgZdK5pJ1wnr1EFXUlfOzmLZNDy18O1pEehx",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "2v8glgZdK5pJ1wnr1EFXUlfOzmLZNDy18O1pEehx",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "2v8glgZdK5pJ1wnr1EFXUlfOzmLZNDy18O1pEehx"
  }
}
2018-08-27 11:21:19.291 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 11:21:19.310 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:21:19.319 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:21:19.321 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:21:19.323 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:21:19.325 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:21:19.326 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:21:19.327 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:21:19.335 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:21:37.038 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:21:37.042 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:21:37.043 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:21:37.045 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:21:37.047 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:21:37.048 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:21:37.051 -03:00 [DBG] Start discovery request
2018-08-27 11:21:37.059 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:21:37.088 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:21:37.091 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:21:37.092 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:21:37.093 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:21:37.094 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:21:37.095 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:21:37.097 -03:00 [DBG] Start key discovery request
2018-08-27 11:21:37.143 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:21:37.145 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:21:37.149 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:21:37.150 -03:00 [DBG] Start authorize request
2018-08-27 11:21:37.151 -03:00 [DBG] No user present in authorize request
2018-08-27 11:21:37.152 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:21:37.160 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:21:37.162 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:21:37.166 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:21:37.169 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:21:37.171 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:21:37.172 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:21:37.174 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "VenHHAjgsuBYXJpbajGC36YhOIIGUGNbfY6KsltN",
  "Nonce": "VenHHAjgsuBYXJpbajGC36YhOIIGUGNbfY6KsltN",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "VenHHAjgsuBYXJpbajGC36YhOIIGUGNbfY6KsltN",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "VenHHAjgsuBYXJpbajGC36YhOIIGUGNbfY6KsltN"
  }
}
2018-08-27 11:21:37.178 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 11:21:37.189 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:21:37.196 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:21:37.199 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:21:37.200 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:21:37.202 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:21:37.204 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:21:37.205 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:21:37.211 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:21:58.017 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 11:21:59.034 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 11:21:59.343 -03:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentNullException: Value cannot be null.
Parameter name: password
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user, String password)
   at Equinox.Infra.CrossCutting.Identity.Services.UserService.CreateUser(IDomainUser user, String password, String provider, String providerId) in D:\workspace\JpProject\src\Backend\Equinox.Infra.CrossCutting.Identity\Services\UserService.cs:line 74
   at Equinox.Domain.CommandHandlers.UserCommandHandler.Handle(RegisterNewUserWithoutPassCommand request, CancellationToken cancellationToken) in D:\workspace\JpProject\src\Backend\Equinox.Domain\CommandHandlers\UserCommandHandler.cs:line 77
   at MediatR.Internal.RequestHandlerWrapperImpl`1.<>c__DisplayClass0_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Equinox.UI.SSO.Controllers.Account.AccountController.AutoProvisionUserAsync(String provider, String providerUserId, IEnumerable`1 claims) in D:\workspace\JpProject\src\Frontend\Equinox.UI.SSO\Controllers\Account\AccountController.cs:line 545
   at Equinox.UI.SSO.Controllers.Account.AccountController.ExternalLoginCallback() in D:\workspace\JpProject\src\Frontend\Equinox.UI.SSO\Controllers\Account\AccountController.cs:line 209
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2018-08-27 11:22:06.613 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:22:06.620 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:22:06.622 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:22:06.623 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:22:06.626 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:22:06.627 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:22:06.628 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:22:06.634 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:26:46.563 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 11:26:47.423 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 11:27:25.534 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 11:27:25.554 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 11:27:25.554 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 11:27:25.554 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 11:27:25.554 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 11:27:25.628 -03:00 [DBG] Starting token cleanup
2018-08-27 11:27:55.566 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 11:27:55.587 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 11:27:55.588 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 11:27:55.588 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 11:27:55.588 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 11:27:55.661 -03:00 [DBG] Starting token cleanup
2018-08-27 11:28:09.012 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:28:09.115 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:28:09.118 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:28:09.155 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:28:09.161 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:28:09.163 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:28:09.166 -03:00 [DBG] Start discovery request
2018-08-27 11:28:09.411 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:28:09.441 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:28:09.447 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:28:09.448 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:28:09.449 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:28:09.450 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:28:09.452 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:28:09.457 -03:00 [DBG] Start key discovery request
2018-08-27 11:28:09.492 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:28:09.496 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:28:09.498 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:28:09.501 -03:00 [DBG] Start authorize request
2018-08-27 11:28:09.508 -03:00 [DBG] No user present in authorize request
2018-08-27 11:28:09.511 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:28:09.665 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:28:09.694 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:28:09.719 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:28:09.726 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:28:09.729 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:28:09.734 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:28:09.742 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "kfvoiRMO3s1cv3gRw6Ri03blvyx6qMQmknrPZTV2",
  "Nonce": "kfvoiRMO3s1cv3gRw6Ri03blvyx6qMQmknrPZTV2",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "kfvoiRMO3s1cv3gRw6Ri03blvyx6qMQmknrPZTV2",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "kfvoiRMO3s1cv3gRw6Ri03blvyx6qMQmknrPZTV2"
  }
}
2018-08-27 11:28:09.750 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 11:28:09.835 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:28:09.842 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:28:09.845 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:28:09.846 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:28:09.848 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:28:09.850 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:28:09.850 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:28:09.859 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:28:29.258 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 11:28:30.067 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 11:28:30.330 -03:00 [INF] User created a new account with password.
2018-08-27 11:28:30.368 -03:00 [INF] User created a new account with password.
2018-08-27 11:28:30.687 -03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: Invalid object name 'StoredEvent'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(DbContext _, ValueTuple`2 parameters)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IReadOnlyList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Equinox.Infra.Data.Repository.EventSourcing.EventStoreSQLRepository.Store(StoredEvent theEvent) in D:\workspace\JpProject\src\Backend\Equinox.Infra.Data\Repository\EventSourcing\EventStoreSQLRepository.cs:line 27
   at Equinox.Infra.Data.EventSourcing.SqlEventStore.Save[T](T theEvent) in D:\workspace\JpProject\src\Backend\Equinox.Infra.Data\EventSourcing\SqlEventStore.cs:line 28
   at Equinox.Infra.CrossCutting.Bus.InMemoryBus.RaiseEvent[T](T event) in D:\workspace\JpProject\src\Backend\Equinox.Infra.CrossCutting.Bus\InMemoryBus.cs:line 28
   at Equinox.Domain.CommandHandlers.UserCommandHandler.Handle(RegisterNewUserWithoutPassCommand request, CancellationToken cancellationToken) in D:\workspace\JpProject\src\Backend\Equinox.Domain\CommandHandlers\UserCommandHandler.cs:line 79
   at MediatR.Internal.RequestHandlerWrapperImpl`1.<>c__DisplayClass0_0.<<Handle>g__Handler|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Equinox.UI.SSO.Controllers.Account.AccountController.AutoProvisionUserAsync(String provider, String providerUserId, IEnumerable`1 claims) in D:\workspace\JpProject\src\Frontend\Equinox.UI.SSO\Controllers\Account\AccountController.cs:line 545
   at Equinox.UI.SSO.Controllers.Account.AccountController.ExternalLoginCallback() in D:\workspace\JpProject\src\Frontend\Equinox.UI.SSO\Controllers\Account\AccountController.cs:line 209
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2018-08-27 11:29:24.841 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 11:29:24.861 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 11:29:24.862 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 11:29:24.862 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 11:29:24.862 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 11:29:24.933 -03:00 [DBG] Starting token cleanup
2018-08-27 11:29:29.697 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:29:29.794 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:29:29.797 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:29:29.835 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:29:29.840 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:29:29.841 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:29:29.845 -03:00 [DBG] Start discovery request
2018-08-27 11:29:30.105 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:29:30.135 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:29:30.139 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:29:30.140 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:29:30.141 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:29:30.142 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:29:30.143 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:29:30.146 -03:00 [DBG] Start key discovery request
2018-08-27 11:29:30.182 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:29:30.187 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:29:30.187 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:29:30.191 -03:00 [DBG] Start authorize request
2018-08-27 11:29:30.197 -03:00 [DBG] No user present in authorize request
2018-08-27 11:29:30.200 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:29:30.349 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:29:30.379 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:29:30.404 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:29:30.415 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:29:30.418 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:29:30.424 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:29:30.432 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "4x1N1FGwTiVOYmj987w0mq1yE9ar2ofcDTCszlMO",
  "Nonce": "4x1N1FGwTiVOYmj987w0mq1yE9ar2ofcDTCszlMO",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "4x1N1FGwTiVOYmj987w0mq1yE9ar2ofcDTCszlMO",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "4x1N1FGwTiVOYmj987w0mq1yE9ar2ofcDTCszlMO"
  }
}
2018-08-27 11:29:30.440 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 11:29:30.547 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:29:30.555 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:29:30.558 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:29:30.560 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:29:30.562 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:29:30.563 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:29:30.563 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:29:30.571 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:29:33.601 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 11:29:34.676 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 11:29:34.875 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "f3678226-52c4-4275-9875-8e9aa40d5280",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGC55VIF4SG:00000005",
  "TimeStamp": "2018-08-27T14:29:34Z",
  "ProcessId": 15772,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:29:34.884 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:29:34.885 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 11:29:34.890 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:29:34.894 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:29:34.911 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 11:29:34.912 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 11:29:34.913 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 11:29:34.918 -03:00 [DBG] Start authorize callback request
2018-08-27 11:29:34.921 -03:00 [DBG] User in authorize request: f3678226-52c4-4275-9875-8e9aa40d5280
2018-08-27 11:29:34.922 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:29:34.928 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:29:34.931 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:29:34.933 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:29:34.935 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:29:34.937 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:29:34.937 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:29:34.938 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "f3678226-52c4-4275-9875-8e9aa40d5280",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "4x1N1FGwTiVOYmj987w0mq1yE9ar2ofcDTCszlMO",
  "Nonce": "4x1N1FGwTiVOYmj987w0mq1yE9ar2ofcDTCszlMO",
  "SessionId": "458d590218de7b9a66dd83a6df407257",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "4x1N1FGwTiVOYmj987w0mq1yE9ar2ofcDTCszlMO",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "4x1N1FGwTiVOYmj987w0mq1yE9ar2ofcDTCszlMO"
  }
}
2018-08-27 11:29:34.982 -03:00 [DBG] 082vaEVrlYoRn6FjewlPRq07zgT4HhwyY0Xaefssn3E= found in database: false
2018-08-27 11:29:34.984 -03:00 [DBG] user_consent grant with value: UserManagementUI|f3678226-52c4-4275-9875-8e9aa40d5280 not found in store.
2018-08-27 11:29:34.985 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 11:29:34.985 -03:00 [INF] Showing consent: User has not yet consented
2018-08-27 11:29:35.008 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:29:35.015 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:29:35.018 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:29:35.020 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:29:35.022 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:29:35.025 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:29:35.025 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:29:35.031 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:29:35.033 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:29:35.035 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:30:25.033 -03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 11:30:25.073 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:30:25.085 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:30:25.089 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:30:25.091 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:30:25.094 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:30:25.097 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:30:25.098 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:30:25.114 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 11:30:25.116 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 11:30:25.117 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 11:30:25.118 -03:00 [DBG] Start authorize callback request
2018-08-27 11:30:25.122 -03:00 [DBG] User in authorize request: f3678226-52c4-4275-9875-8e9aa40d5280
2018-08-27 11:30:25.122 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:30:25.132 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:30:25.135 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:30:25.136 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:30:25.140 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:30:25.143 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:30:25.144 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:30:25.145 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "f3678226-52c4-4275-9875-8e9aa40d5280",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "4x1N1FGwTiVOYmj987w0mq1yE9ar2ofcDTCszlMO",
  "Nonce": "4x1N1FGwTiVOYmj987w0mq1yE9ar2ofcDTCszlMO",
  "SessionId": "458d590218de7b9a66dd83a6df407257",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "4x1N1FGwTiVOYmj987w0mq1yE9ar2ofcDTCszlMO",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "4x1N1FGwTiVOYmj987w0mq1yE9ar2ofcDTCszlMO"
  }
}
2018-08-27 11:30:25.152 -03:00 [DBG] 082vaEVrlYoRn6FjewlPRq07zgT4HhwyY0Xaefssn3E= found in database: false
2018-08-27 11:30:25.153 -03:00 [DBG] user_consent grant with value: UserManagementUI|f3678226-52c4-4275-9875-8e9aa40d5280 not found in store.
2018-08-27 11:30:25.154 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 11:30:25.157 -03:00 [INF] User consented to scopes: ["openid","profile","email"]
2018-08-27 11:30:25.161 -03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email"]
2018-08-27 11:30:25.164 -03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: f3678226-52c4-4275-9875-8e9aa40d5280
2018-08-27 11:30:25.175 -03:00 [DBG] 082vaEVrlYoRn6FjewlPRq07zgT4HhwyY0Xaefssn3E= not found in database
2018-08-27 11:30:25.285 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 11:30:25.292 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 11:30:25.307 -03:00 [DBG] Getting claims for access token for subject: f3678226-52c4-4275-9875-8e9aa40d5280
2018-08-27 11:30:25.335 -03:00 [DBG] MyyWNhVyuG9H2VBF/xgM1hd/qqySyGO41Hrpw+0Rrus= not found in database
2018-08-27 11:30:25.349 -03:00 [DBG] Getting claims for identity token for subject: f3678226-52c4-4275-9875-8e9aa40d5280 and client: UserManagementUI
2018-08-27 11:30:25.350 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 11:30:25.397 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "f3678226-52c4-4275-9875-8e9aa40d5280",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****HLbw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****d91f"
    }
  ],
  "ActivityId": "0HLGC55VIF4SJ:00000006",
  "TimeStamp": "2018-08-27T14:30:25Z",
  "ProcessId": 15772,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:30:25.409 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "f3678226-52c4-4275-9875-8e9aa40d5280",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "4x1N1FGwTiVOYmj987w0mq1yE9ar2ofcDTCszlMO",
  "Scope": "openid profile email"
}
2018-08-27 11:30:25.424 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:30:25.424 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:30:26.468 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:30:26.472 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:30:26.473 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:30:26.474 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:30:26.476 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:30:26.479 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:30:26.482 -03:00 [DBG] Start discovery request
2018-08-27 11:30:26.487 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:30:26.502 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:30:26.507 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:30:26.509 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:30:26.510 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:30:26.511 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:30:26.513 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:30:26.515 -03:00 [DBG] Start key discovery request
2018-08-27 11:30:41.126 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 11:30:41.141 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 11:30:41.141 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 11:30:41.164 -03:00 [DBG] Processing signout request for f3678226-52c4-4275-9875-8e9aa40d5280
2018-08-27 11:30:41.169 -03:00 [DBG] Start end session request validation
2018-08-27 11:30:41.174 -03:00 [DBG] Start identity token validation
2018-08-27 11:30:41.189 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:30:41.191 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 11:30:41.229 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 11:30:41.232 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535380225,
    "exp": 1535380525,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "4x1N1FGwTiVOYmj987w0mq1yE9ar2ofcDTCszlMO",
    "iat": 1535380225,
    "at_hash": "_z5mvmUR5ImNkuOYOe062Q",
    "sid": "458d590218de7b9a66dd83a6df407257",
    "sub": "f3678226-52c4-4275-9875-8e9aa40d5280",
    "auth_time": 1535380174,
    "idp": "Facebook",
    "amr": "external"
  }
}
2018-08-27 11:30:41.237 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "f3678226-52c4-4275-9875-8e9aa40d5280",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzODAyMjUsImV4cCI6MTUzNTM4MDUyNSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiNHgxTjFGR3dUaVZPWW1qOTg3dzBtcTF5RTlhcjJvZmNEVENzemxNTyIsImlhdCI6MTUzNTM4MDIyNSwiYXRfaGFzaCI6Il96NW12bVVSNUltTmt1T1lPZTA2MlEiLCJzaWQiOiI0NThkNTkwMjE4ZGU3YjlhNjZkZDgzYTZkZjQwNzI1NyIsInN1YiI6ImYzNjc4MjI2LTUyYzQtNDI3NS05ODc1LThlOWFhNDBkNTI4MCIsImF1dGhfdGltZSI6MTUzNTM4MDE3NCwiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.bqfMPXaIuyt6SlAS-BLm6ut50iJl2zQ1bZMoJJx_gFa7k-wub1n-2KnFcdoz-kX_g6EdjDWevF136Mm-dbBjzGYW0D_2D6nBbzxkl2HxpjwDltdM_ToiaO60gzX4aF6X5Zod5AeOHzNTzKMvQ95IHCD9YkvpJMk_x_lk_Elyub2T18p_-Y1zVNotSjOYaH8F_znAuYAOW-ADlKUhfTkATKPcZQXExS0zaSCFEJBESSxIGHlWxlLYMhCq10T0cWesz8SYfqGODyV6GMa8ABxXBRV4dz0CMjOngTF8ZjlsaJeQsPLBxp-w1_GkmxySOkW2bIQsOLRbd3on2UNzB3HLbw",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 11:30:41.243 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 11:30:41.274 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 11:30:41.275 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:30:41.277 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 11:30:41.280 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "f3678226-52c4-4275-9875-8e9aa40d5280",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGC55VIF4SJ:00000008",
  "TimeStamp": "2018-08-27T14:30:41Z",
  "ProcessId": 15772,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:30:41.344 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 11:30:41.348 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 11:30:41.349 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 11:30:41.353 -03:00 [DBG] Processing signout callback request
2018-08-27 11:30:41.368 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:30:41.369 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 11:30:41.370 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 11:30:41.371 -03:00 [INF] Successful signout callback.
2018-08-27 11:30:41.371 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 11:30:41.372 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 11:30:46.058 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:30:46.062 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:30:46.063 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:30:46.065 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:30:46.070 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:30:46.072 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:30:46.073 -03:00 [DBG] Start discovery request
2018-08-27 11:30:46.082 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:30:46.092 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:30:46.097 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:30:46.099 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:30:46.101 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:30:46.104 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:30:46.106 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:30:46.107 -03:00 [DBG] Start key discovery request
2018-08-27 11:30:46.117 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:30:46.118 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:30:46.119 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:30:46.120 -03:00 [DBG] Start authorize request
2018-08-27 11:30:46.120 -03:00 [DBG] No user present in authorize request
2018-08-27 11:30:46.121 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:30:46.133 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:30:46.136 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:30:46.138 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:30:46.139 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:30:46.141 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:30:46.143 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:30:46.144 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "lEVI3qu9NMDEqgRk79oRKWA6WE8VoPSxbP0jPOF5",
  "Nonce": "lEVI3qu9NMDEqgRk79oRKWA6WE8VoPSxbP0jPOF5",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "lEVI3qu9NMDEqgRk79oRKWA6WE8VoPSxbP0jPOF5",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "lEVI3qu9NMDEqgRk79oRKWA6WE8VoPSxbP0jPOF5"
  }
}
2018-08-27 11:30:46.147 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 11:30:46.152 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:30:46.162 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:30:46.164 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:30:46.166 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:30:46.167 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:30:46.169 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:30:46.169 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:30:46.176 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:31:13.866 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:31:13.872 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:31:13.873 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:31:13.874 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:31:13.875 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:31:13.878 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:31:13.882 -03:00 [DBG] Start discovery request
2018-08-27 11:31:13.888 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:31:13.906 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:31:13.909 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:31:13.911 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:31:13.913 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:31:13.916 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:31:13.919 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:31:13.921 -03:00 [DBG] Start key discovery request
2018-08-27 11:31:13.935 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:31:13.936 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:31:13.938 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:31:13.939 -03:00 [DBG] Start authorize request
2018-08-27 11:31:13.940 -03:00 [DBG] No user present in authorize request
2018-08-27 11:31:13.941 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:31:13.953 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:31:13.955 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:31:13.958 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:31:13.960 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:31:13.964 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:31:13.964 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:31:13.965 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "kHNBbhu3UbktVHiK8Vsr86C9Ad4dIJYCtfHhmsV4",
  "Nonce": "kHNBbhu3UbktVHiK8Vsr86C9Ad4dIJYCtfHhmsV4",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "kHNBbhu3UbktVHiK8Vsr86C9Ad4dIJYCtfHhmsV4",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "kHNBbhu3UbktVHiK8Vsr86C9Ad4dIJYCtfHhmsV4"
  }
}
2018-08-27 11:31:13.969 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 11:31:13.973 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:31:13.980 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:31:13.983 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:31:13.984 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:31:13.986 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:31:13.987 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:31:13.987 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:31:13.994 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:31:17.846 -03:00 [INF] AuthenticationScheme: Google was challenged.
2018-08-27 11:31:22.673 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 11:31:22.765 -03:00 [WRN] User a1070588-2cf4-407c-a19d-713c36dfca65 validation failed: DuplicateUserName.
2018-08-27 11:31:31.805 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 11:31:32.492 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 11:31:32.504 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "f3678226-52c4-4275-9875-8e9aa40d5280",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGC55VIF4SJ:00000016",
  "TimeStamp": "2018-08-27T14:31:32Z",
  "ProcessId": 15772,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:31:32.506 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:31:32.506 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 11:31:32.507 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:31:32.508 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:31:38.917 -03:00 [DBG] 2 persisted grants found for f3678226-52c4-4275-9875-8e9aa40d5280
2018-08-27 11:31:38.941 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:31:38.945 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:31:38.948 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:37:44.513 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 11:37:44.549 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 11:37:44.550 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 11:37:44.551 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 11:37:44.551 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 11:37:44.618 -03:00 [DBG] Starting token cleanup
2018-08-27 11:37:58.871 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 11:37:58.894 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 11:37:58.894 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 11:37:58.894 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 11:37:58.895 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 11:37:58.972 -03:00 [DBG] Starting token cleanup
2018-08-27 11:38:05.682 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:38:05.780 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:38:05.783 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:38:05.821 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:38:05.827 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:38:05.828 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:38:05.831 -03:00 [DBG] Start discovery request
2018-08-27 11:38:06.098 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:38:06.127 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:38:06.133 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:38:06.134 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:38:06.136 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:38:06.138 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:38:06.139 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:38:06.142 -03:00 [DBG] Start key discovery request
2018-08-27 11:38:06.185 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:38:06.190 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:38:06.191 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:38:06.194 -03:00 [DBG] Start authorize request
2018-08-27 11:38:06.202 -03:00 [DBG] User in authorize request: f3678226-52c4-4275-9875-8e9aa40d5280
2018-08-27 11:38:06.207 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:38:06.381 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:38:06.421 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:06.450 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:06.459 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:06.462 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:06.467 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:38:06.476 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "f3678226-52c4-4275-9875-8e9aa40d5280",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "P4SogcveiYlYFqmgP1blrBH12ebVylnr12Osipvz",
  "Nonce": "P4SogcveiYlYFqmgP1blrBH12ebVylnr12Osipvz",
  "SessionId": "b16d534e48e4b5ec422e25fc01624d4d",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "P4SogcveiYlYFqmgP1blrBH12ebVylnr12Osipvz",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "P4SogcveiYlYFqmgP1blrBH12ebVylnr12Osipvz"
  }
}
2018-08-27 11:38:06.508 -03:00 [INF] Showing login: User is not active
2018-08-27 11:38:06.602 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:38:06.610 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:38:06.613 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:06.614 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:06.616 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:06.618 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:06.618 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:38:06.627 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:38:08.227 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 11:38:09.245 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 11:38:09.500 -03:00 [INF] User created a new account with password.
2018-08-27 11:38:09.522 -03:00 [INF] User created a new account with password.
2018-08-27 11:38:09.773 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGC5APL1BVI:00000005",
  "TimeStamp": "2018-08-27T14:38:09Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:38:09.782 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:38:09.784 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 11:38:09.787 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:38:09.792 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:38:09.804 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 11:38:09.805 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 11:38:09.806 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 11:38:09.811 -03:00 [DBG] Start authorize callback request
2018-08-27 11:38:09.813 -03:00 [DBG] User in authorize request: 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:38:09.814 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:38:09.821 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:38:09.823 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:09.825 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:09.826 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:09.828 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:09.829 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:38:09.830 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "P4SogcveiYlYFqmgP1blrBH12ebVylnr12Osipvz",
  "Nonce": "P4SogcveiYlYFqmgP1blrBH12ebVylnr12Osipvz",
  "SessionId": "19ae419baf355668fbe788d60a8f9d52",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "P4SogcveiYlYFqmgP1blrBH12ebVylnr12Osipvz",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "P4SogcveiYlYFqmgP1blrBH12ebVylnr12Osipvz"
  }
}
2018-08-27 11:38:09.857 -03:00 [DBG] BjCbRn2IsE6XiGcYLrF+YzLgsqxzSVmqBE0pjLJmOfc= found in database: false
2018-08-27 11:38:09.859 -03:00 [DBG] user_consent grant with value: UserManagementUI|7b3fb49d-352c-4234-8c74-d83db7ca3964 not found in store.
2018-08-27 11:38:09.860 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 11:38:09.860 -03:00 [INF] Showing consent: User has not yet consented
2018-08-27 11:38:09.880 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:38:09.888 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:38:09.890 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:09.891 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:09.893 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:09.894 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:09.895 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:38:09.900 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:38:09.906 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:09.907 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:15.330 -03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 11:38:15.362 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:38:15.370 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:38:15.373 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:15.375 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:15.376 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:15.378 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:15.378 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:38:15.391 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 11:38:15.393 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 11:38:15.394 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 11:38:15.395 -03:00 [DBG] Start authorize callback request
2018-08-27 11:38:15.397 -03:00 [DBG] User in authorize request: 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:38:15.398 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:38:15.406 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:38:15.408 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:15.410 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:15.412 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:15.416 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:15.417 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:38:15.419 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "P4SogcveiYlYFqmgP1blrBH12ebVylnr12Osipvz",
  "Nonce": "P4SogcveiYlYFqmgP1blrBH12ebVylnr12Osipvz",
  "SessionId": "19ae419baf355668fbe788d60a8f9d52",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "P4SogcveiYlYFqmgP1blrBH12ebVylnr12Osipvz",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "P4SogcveiYlYFqmgP1blrBH12ebVylnr12Osipvz"
  }
}
2018-08-27 11:38:15.430 -03:00 [DBG] BjCbRn2IsE6XiGcYLrF+YzLgsqxzSVmqBE0pjLJmOfc= found in database: false
2018-08-27 11:38:15.431 -03:00 [DBG] user_consent grant with value: UserManagementUI|7b3fb49d-352c-4234-8c74-d83db7ca3964 not found in store.
2018-08-27 11:38:15.432 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 11:38:15.436 -03:00 [INF] User consented to scopes: ["openid","profile","email"]
2018-08-27 11:38:15.438 -03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email"]
2018-08-27 11:38:15.441 -03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:38:15.454 -03:00 [DBG] BjCbRn2IsE6XiGcYLrF+YzLgsqxzSVmqBE0pjLJmOfc= not found in database
2018-08-27 11:38:15.486 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 11:38:15.494 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 11:38:15.494 -03:00 [DBG] Getting claims for access token for subject: 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:38:15.523 -03:00 [DBG] VnLS8bx4ARQKN8n7/RNg2qAa2vrMzGXqiS/FX4UAsC8= not found in database
2018-08-27 11:38:15.533 -03:00 [DBG] Getting claims for identity token for subject: 7b3fb49d-352c-4234-8c74-d83db7ca3964 and client: UserManagementUI
2018-08-27 11:38:15.538 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 11:38:15.582 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****4gYw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****47d5"
    }
  ],
  "ActivityId": "0HLGC5APL1BVI:0000000A",
  "TimeStamp": "2018-08-27T14:38:15Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:38:15.589 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "P4SogcveiYlYFqmgP1blrBH12ebVylnr12Osipvz",
  "Scope": "openid profile email"
}
2018-08-27 11:38:15.602 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:38:15.603 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:38:16.538 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:38:16.541 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:38:16.542 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:38:16.542 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:38:16.544 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:38:16.546 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:38:16.547 -03:00 [DBG] Start discovery request
2018-08-27 11:38:16.555 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:38:16.572 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:38:16.575 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:38:16.577 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:38:16.578 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:38:16.580 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:38:16.581 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:38:16.583 -03:00 [DBG] Start key discovery request
2018-08-27 11:38:23.171 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 11:38:23.175 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 11:38:23.177 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 11:38:23.181 -03:00 [DBG] Processing signout request for 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:38:23.188 -03:00 [DBG] Start end session request validation
2018-08-27 11:38:23.193 -03:00 [DBG] Start identity token validation
2018-08-27 11:38:23.209 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:38:23.211 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 11:38:23.246 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 11:38:23.250 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535380695,
    "exp": 1535380995,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "P4SogcveiYlYFqmgP1blrBH12ebVylnr12Osipvz",
    "iat": 1535380695,
    "at_hash": "g46J0xJ7PlQAWSBSwxplEA",
    "sid": "19ae419baf355668fbe788d60a8f9d52",
    "sub": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
    "auth_time": 1535380689,
    "idp": "Facebook",
    "amr": "external"
  }
}
2018-08-27 11:38:23.258 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzODA2OTUsImV4cCI6MTUzNTM4MDk5NSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiUDRTb2djdmVpWWxZRnFtZ1AxYmxyQkgxMmViVnlsbnIxMk9zaXB2eiIsImlhdCI6MTUzNTM4MDY5NSwiYXRfaGFzaCI6Imc0NkoweEo3UGxRQVdTQlN3eHBsRUEiLCJzaWQiOiIxOWFlNDE5YmFmMzU1NjY4ZmJlNzg4ZDYwYThmOWQ1MiIsInN1YiI6IjdiM2ZiNDlkLTM1MmMtNDIzNC04Yzc0LWQ4M2RiN2NhMzk2NCIsImF1dGhfdGltZSI6MTUzNTM4MDY4OSwiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.x46PDYXh8dTrUC2N5H9WcAmxhYP98tJyW-Nq327M54j8M_uMi9ufQBhiTlrFx29afPKLyaVJ68fhxwBIohtNFOX-WhxE396yMl8cH2nY76RRvAeGj67Mj7qlFSYqbW44zoINVqUPySNs9VauP4eTORyZRY9cTw55jpsApZXVJYjG6ZsRlo68XxO7V6WZKPdp_cI_Deu9y6abCaoBrAsI_NDsuri-msLs3ZLOHnFkQ0otETymPK8RsY2dshY2EOPc7rRnXF1c_XCAc3bbs10CI6wdRVCKcKQmKqYU0NiDFwBqpg3e79A2RFB68H68ihqf3q6M6bHKpQXUc8HzF-4gYw",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 11:38:23.262 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 11:38:23.305 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 11:38:23.308 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:38:23.309 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 11:38:23.313 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGC5APL1BVI:0000000C",
  "TimeStamp": "2018-08-27T14:38:23Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:38:23.452 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 11:38:23.457 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 11:38:23.459 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 11:38:23.465 -03:00 [DBG] Processing signout callback request
2018-08-27 11:38:23.489 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:38:23.490 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 11:38:23.491 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 11:38:23.492 -03:00 [INF] Successful signout callback.
2018-08-27 11:38:23.492 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 11:38:23.493 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 11:38:25.183 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:38:25.187 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:38:25.188 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:38:25.190 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:38:25.192 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:38:25.196 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:38:25.197 -03:00 [DBG] Start discovery request
2018-08-27 11:38:25.206 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:38:25.221 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:38:25.223 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:38:25.225 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:38:25.226 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:38:25.229 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:38:25.231 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:38:25.232 -03:00 [DBG] Start key discovery request
2018-08-27 11:38:25.247 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:38:25.249 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:38:25.250 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:38:25.251 -03:00 [DBG] Start authorize request
2018-08-27 11:38:25.253 -03:00 [DBG] No user present in authorize request
2018-08-27 11:38:25.254 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:38:25.263 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:38:25.268 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:25.271 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:25.273 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:25.275 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:25.276 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:38:25.278 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "ycEzEwRU8XTeR7OGRir9U0MDwa0ZtagJgE7OPdRO",
  "Nonce": "ycEzEwRU8XTeR7OGRir9U0MDwa0ZtagJgE7OPdRO",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "ycEzEwRU8XTeR7OGRir9U0MDwa0ZtagJgE7OPdRO",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "ycEzEwRU8XTeR7OGRir9U0MDwa0ZtagJgE7OPdRO"
  }
}
2018-08-27 11:38:25.281 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 11:38:25.285 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:38:25.292 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:38:25.294 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:25.296 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:25.299 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:25.301 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:38:25.302 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:38:25.308 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:38:50.754 -03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-08-27 11:38:53.095 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 11:38:53.692 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 11:38:53.707 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGC5APL1BVI:00000015",
  "TimeStamp": "2018-08-27T14:38:53Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:38:53.709 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:38:53.709 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 11:38:53.710 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:38:53.711 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:38:53.733 -03:00 [DBG] 2 persisted grants found for 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:38:53.757 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:38:53.759 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:38:53.761 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:39:02.023 -03:00 [DBG] 2 persisted grants found for 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:39:02.045 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:39:02.048 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:39:02.050 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:39:15.865 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 11:39:16.436 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 11:39:16.448 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGC5APL1BVI:0000001C",
  "TimeStamp": "2018-08-27T14:39:16Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:39:16.449 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:39:16.450 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 11:39:16.450 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:39:16.451 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:39:16.454 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 11:39:16.458 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 11:39:16.458 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 11:39:16.459 -03:00 [DBG] Start authorize callback request
2018-08-27 11:39:16.460 -03:00 [DBG] User in authorize request: 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:39:16.461 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:39:16.468 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:39:16.471 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:39:16.473 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:39:16.474 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:39:16.476 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:39:16.477 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:39:16.478 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "ycEzEwRU8XTeR7OGRir9U0MDwa0ZtagJgE7OPdRO",
  "Nonce": "ycEzEwRU8XTeR7OGRir9U0MDwa0ZtagJgE7OPdRO",
  "SessionId": "520fc30917047cb8c0441ab7b5e63888",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "ycEzEwRU8XTeR7OGRir9U0MDwa0ZtagJgE7OPdRO",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "ycEzEwRU8XTeR7OGRir9U0MDwa0ZtagJgE7OPdRO"
  }
}
2018-08-27 11:39:16.485 -03:00 [DBG] BjCbRn2IsE6XiGcYLrF+YzLgsqxzSVmqBE0pjLJmOfc= found in database: true
2018-08-27 11:39:16.490 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-27 11:39:16.491 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 11:39:16.491 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 11:39:16.492 -03:00 [DBG] Getting claims for access token for subject: 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:39:16.502 -03:00 [DBG] pPn0d0PoJ5A/A5nKFuXC3yNYzMyC2LJgsfe9TYDOI/4= not found in database
2018-08-27 11:39:16.513 -03:00 [DBG] Getting claims for identity token for subject: 7b3fb49d-352c-4234-8c74-d83db7ca3964 and client: UserManagementUI
2018-08-27 11:39:16.515 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 11:39:16.518 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****zxvg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****3b0a"
    }
  ],
  "ActivityId": "0HLGC5APL1BVI:0000001D",
  "TimeStamp": "2018-08-27T14:39:16Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:39:16.523 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "ycEzEwRU8XTeR7OGRir9U0MDwa0ZtagJgE7OPdRO",
  "Scope": "openid profile email"
}
2018-08-27 11:39:16.524 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:39:16.524 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:39:17.539 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:39:17.543 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:39:17.545 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:39:17.546 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:39:17.549 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:39:17.554 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:39:17.556 -03:00 [DBG] Start discovery request
2018-08-27 11:39:17.562 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:39:17.576 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:39:17.579 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:39:17.582 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:39:17.583 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:39:17.585 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:39:17.587 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:39:17.588 -03:00 [DBG] Start key discovery request
2018-08-27 11:39:28.076 -03:00 [DBG] 3 persisted grants found for 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:39:28.095 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:39:28.097 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:39:28.099 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:39:29.453 -03:00 [DBG] CORS request made for path: /Grants/Revoke from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 11:39:29.473 -03:00 [DBG] removing 3 persisted grants from database for subject 7b3fb49d-352c-4234-8c74-d83db7ca3964, clientId UserManagementUI
2018-08-27 11:39:29.492 -03:00 [DBG] 0 persisted grants found for 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:39:46.360 -03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 11:39:46.370 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 11:39:46.371 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:39:46.373 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 11:39:46.374 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGC5APL1BVI:00000025",
  "TimeStamp": "2018-08-27T14:39:46Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:39:46.426 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 11:39:46.428 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 11:39:46.430 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 11:39:46.431 -03:00 [DBG] Processing signout callback request
2018-08-27 11:39:46.446 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:39:46.446 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 11:39:46.447 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 11:39:46.448 -03:00 [INF] Successful signout callback.
2018-08-27 11:39:46.448 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 11:39:46.449 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 11:44:33.599 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:44:33.639 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:44:33.640 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:44:33.640 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:44:33.641 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:44:33.642 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:44:33.643 -03:00 [DBG] Start discovery request
2018-08-27 11:44:33.650 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:44:33.666 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:44:33.674 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:44:33.675 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:44:33.676 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:44:33.677 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:44:33.679 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:44:33.681 -03:00 [DBG] Start key discovery request
2018-08-27 11:44:33.688 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:44:33.690 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:44:33.691 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:44:33.692 -03:00 [DBG] Start authorize request
2018-08-27 11:44:33.694 -03:00 [DBG] No user present in authorize request
2018-08-27 11:44:33.694 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:44:33.700 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:44:33.702 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:44:33.705 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:44:33.707 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:44:33.710 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:44:33.710 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:44:33.711 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "ryznRC56d00QWb4ZgKIDxXHgtLAPklDfM1chymaO",
  "Nonce": "ryznRC56d00QWb4ZgKIDxXHgtLAPklDfM1chymaO",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "ryznRC56d00QWb4ZgKIDxXHgtLAPklDfM1chymaO",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "ryznRC56d00QWb4ZgKIDxXHgtLAPklDfM1chymaO"
  }
}
2018-08-27 11:44:33.714 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 11:44:33.717 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:44:33.724 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:44:33.727 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:44:33.728 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:44:33.730 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:44:33.732 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:44:33.732 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:44:33.739 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:44:35.354 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 11:44:36.067 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 11:44:36.079 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGC5APL1BVI:0000002D",
  "TimeStamp": "2018-08-27T14:44:36Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:44:36.081 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:44:36.081 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 11:44:36.082 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:44:36.082 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:44:36.085 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 11:44:36.091 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 11:44:36.092 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 11:44:36.092 -03:00 [DBG] Start authorize callback request
2018-08-27 11:44:36.093 -03:00 [DBG] User in authorize request: 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:44:36.094 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:44:36.100 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:44:36.102 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:44:36.104 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:44:36.106 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:44:36.108 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:44:36.109 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:44:36.110 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "ryznRC56d00QWb4ZgKIDxXHgtLAPklDfM1chymaO",
  "Nonce": "ryznRC56d00QWb4ZgKIDxXHgtLAPklDfM1chymaO",
  "SessionId": "44273fe20224b2b4e2481c7fe045edd9",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "ryznRC56d00QWb4ZgKIDxXHgtLAPklDfM1chymaO",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "ryznRC56d00QWb4ZgKIDxXHgtLAPklDfM1chymaO"
  }
}
2018-08-27 11:44:36.116 -03:00 [DBG] BjCbRn2IsE6XiGcYLrF+YzLgsqxzSVmqBE0pjLJmOfc= found in database: false
2018-08-27 11:44:36.118 -03:00 [DBG] user_consent grant with value: UserManagementUI|7b3fb49d-352c-4234-8c74-d83db7ca3964 not found in store.
2018-08-27 11:44:36.119 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 11:44:36.120 -03:00 [INF] Showing consent: User has not yet consented
2018-08-27 11:44:36.122 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:44:36.128 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:44:36.131 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:44:36.133 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:44:36.135 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:44:36.136 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:44:36.138 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:44:36.143 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:44:36.145 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:44:36.146 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:44:38.217 -03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 11:44:38.220 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:44:38.230 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:44:38.232 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:44:38.234 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:44:38.236 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:44:38.239 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:44:38.240 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:44:38.243 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 11:44:38.243 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 11:44:38.244 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 11:44:38.245 -03:00 [DBG] Start authorize callback request
2018-08-27 11:44:38.246 -03:00 [DBG] User in authorize request: 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:44:38.248 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:44:38.255 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:44:38.258 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:44:38.260 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:44:38.261 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:44:38.263 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:44:38.263 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:44:38.264 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "ryznRC56d00QWb4ZgKIDxXHgtLAPklDfM1chymaO",
  "Nonce": "ryznRC56d00QWb4ZgKIDxXHgtLAPklDfM1chymaO",
  "SessionId": "44273fe20224b2b4e2481c7fe045edd9",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "ryznRC56d00QWb4ZgKIDxXHgtLAPklDfM1chymaO",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "ryznRC56d00QWb4ZgKIDxXHgtLAPklDfM1chymaO"
  }
}
2018-08-27 11:44:38.273 -03:00 [DBG] BjCbRn2IsE6XiGcYLrF+YzLgsqxzSVmqBE0pjLJmOfc= found in database: false
2018-08-27 11:44:38.273 -03:00 [DBG] user_consent grant with value: UserManagementUI|7b3fb49d-352c-4234-8c74-d83db7ca3964 not found in store.
2018-08-27 11:44:38.274 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 11:44:38.275 -03:00 [INF] User consented to scopes: ["openid","profile","email"]
2018-08-27 11:44:38.276 -03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email"]
2018-08-27 11:44:38.277 -03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:44:38.282 -03:00 [DBG] BjCbRn2IsE6XiGcYLrF+YzLgsqxzSVmqBE0pjLJmOfc= not found in database
2018-08-27 11:44:38.290 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 11:44:38.290 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 11:44:38.291 -03:00 [DBG] Getting claims for access token for subject: 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:44:38.300 -03:00 [DBG] VQHRKZ+ZQOwB+0jO3WukYnMTX29miZVdXZeAhwVUtz8= not found in database
2018-08-27 11:44:38.305 -03:00 [DBG] Getting claims for identity token for subject: 7b3fb49d-352c-4234-8c74-d83db7ca3964 and client: UserManagementUI
2018-08-27 11:44:38.305 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 11:44:38.309 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****NP1g"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****6ad9"
    }
  ],
  "ActivityId": "0HLGC5APL1BVT:00000004",
  "TimeStamp": "2018-08-27T14:44:38Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:44:38.311 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "ryznRC56d00QWb4ZgKIDxXHgtLAPklDfM1chymaO",
  "Scope": "openid profile email"
}
2018-08-27 11:44:38.312 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:44:38.313 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:44:38.933 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:44:38.935 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:44:38.938 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:44:38.939 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:44:38.941 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:44:38.941 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:44:38.944 -03:00 [DBG] Start discovery request
2018-08-27 11:44:38.948 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:44:38.962 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:44:38.966 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:44:38.967 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:44:38.968 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:44:38.969 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:44:38.972 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:44:38.975 -03:00 [DBG] Start key discovery request
2018-08-27 11:45:19.023 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:45:19.027 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:45:19.028 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:45:19.029 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:45:19.030 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:45:19.032 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:45:19.033 -03:00 [DBG] Start discovery request
2018-08-27 11:45:19.042 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:45:19.069 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:45:19.074 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:45:19.075 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:45:19.076 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:45:19.077 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:45:19.078 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:45:19.079 -03:00 [DBG] Start key discovery request
2018-08-27 11:45:40.948 -03:00 [DBG] 2 persisted grants found for 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:45:40.965 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:45:40.968 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:45:40.970 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:45:42.254 -03:00 [DBG] CORS request made for path: /Grants/Revoke from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 11:45:42.257 -03:00 [DBG] removing 2 persisted grants from database for subject 7b3fb49d-352c-4234-8c74-d83db7ca3964, clientId UserManagementUI
2018-08-27 11:45:42.271 -03:00 [DBG] 0 persisted grants found for 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:45:55.765 -03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 11:45:55.773 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 11:45:55.774 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:45:55.775 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 11:45:55.777 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGC5APL1BVT:0000000D",
  "TimeStamp": "2018-08-27T14:45:55Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:45:55.825 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 11:45:55.827 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 11:45:55.828 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 11:45:55.829 -03:00 [DBG] Processing signout callback request
2018-08-27 11:45:55.839 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:45:55.839 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 11:45:55.840 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 11:45:55.840 -03:00 [INF] Successful signout callback.
2018-08-27 11:45:55.841 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 11:45:55.841 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 11:48:47.607 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 11:48:48.414 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 11:48:48.428 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGC5APL1BVT:00000013",
  "TimeStamp": "2018-08-27T14:48:48Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:48:48.429 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:48:48.430 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 11:48:48.431 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:48:48.431 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:48:50.294 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:48:50.297 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:48:50.299 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:48:50.300 -03:00 [DBG] Start discovery request
2018-08-27 11:48:50.305 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:48:52.690 -03:00 [DBG] 0 persisted grants found for 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:48:55.852 -03:00 [DBG] 0 persisted grants found for 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:53:22.517 -03:00 [DBG] 0 persisted grants found for 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 11:53:27.501 -03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 11:53:27.508 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 11:53:27.509 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:53:27.510 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 11:53:27.513 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGC5APL1BVT:0000001C",
  "TimeStamp": "2018-08-27T14:53:27Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:54:07.999 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:54:08.003 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:54:08.006 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:54:08.006 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:54:08.007 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:54:08.008 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:54:08.012 -03:00 [DBG] Start discovery request
2018-08-27 11:54:08.019 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:54:08.026 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:54:08.029 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:54:08.030 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:54:08.031 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:54:08.033 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:54:08.034 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:54:08.034 -03:00 [DBG] Start key discovery request
2018-08-27 11:54:08.049 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:54:08.050 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:54:08.052 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:54:08.053 -03:00 [DBG] Start authorize request
2018-08-27 11:54:08.054 -03:00 [DBG] No user present in authorize request
2018-08-27 11:54:08.054 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:54:08.060 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:54:08.065 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:08.070 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:08.072 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:08.073 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:08.074 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:54:08.075 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "w0UH5mGxh86O663PLQKC86kGPgzltYuE0NbTl7xy",
  "Nonce": "w0UH5mGxh86O663PLQKC86kGPgzltYuE0NbTl7xy",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "w0UH5mGxh86O663PLQKC86kGPgzltYuE0NbTl7xy",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "w0UH5mGxh86O663PLQKC86kGPgzltYuE0NbTl7xy"
  }
}
2018-08-27 11:54:08.077 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 11:54:08.081 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:54:08.089 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:54:08.091 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:08.092 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:08.094 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:08.096 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:08.097 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:54:08.103 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:54:17.338 -03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 11:54:17.444 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:54:17.444 -03:00 [DBG] Adding idp claim with value: local
2018-08-27 11:54:17.445 -03:00 [DBG] Adding amr claim with value: pwd
2018-08-27 11:54:17.446 -03:00 [DBG] Adding auth_time claim with value: 1535381657
2018-08-27 11:54:17.447 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:54:17.450 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "bhdebrito",
  "SubjectId": "a4e211ec-86f0-43dd-b102-1413fc89f8a3",
  "DisplayName": "bhdebrito",
  "Endpoint": "UI",
  "ActivityId": "0HLGC5APL1BVT:00000021",
  "TimeStamp": "2018-08-27T14:54:17Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:54:17.455 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 11:54:17.456 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 11:54:17.457 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 11:54:17.458 -03:00 [DBG] Start authorize callback request
2018-08-27 11:54:17.459 -03:00 [DBG] User in authorize request: a4e211ec-86f0-43dd-b102-1413fc89f8a3
2018-08-27 11:54:17.459 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:54:17.467 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:54:17.469 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:17.470 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:17.471 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:17.473 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:17.473 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:54:17.474 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "a4e211ec-86f0-43dd-b102-1413fc89f8a3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "w0UH5mGxh86O663PLQKC86kGPgzltYuE0NbTl7xy",
  "Nonce": "w0UH5mGxh86O663PLQKC86kGPgzltYuE0NbTl7xy",
  "SessionId": "a73793568a8b0e9b06dac84e6c901385",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "w0UH5mGxh86O663PLQKC86kGPgzltYuE0NbTl7xy",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "w0UH5mGxh86O663PLQKC86kGPgzltYuE0NbTl7xy"
  }
}
2018-08-27 11:54:17.482 -03:00 [DBG] 4eOVJ8eTKAfIxHShhIT+yJ4V4j1pro8FxuqDVgOy2Xs= found in database: false
2018-08-27 11:54:17.483 -03:00 [DBG] user_consent grant with value: UserManagementUI|a4e211ec-86f0-43dd-b102-1413fc89f8a3 not found in store.
2018-08-27 11:54:17.484 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 11:54:17.485 -03:00 [INF] Showing consent: User has not yet consented
2018-08-27 11:54:17.489 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:54:17.494 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:54:17.497 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:17.499 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:17.501 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:17.502 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:17.503 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:54:17.508 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:54:17.510 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:17.511 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:19.301 -03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 11:54:19.311 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:54:19.317 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:54:19.319 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:19.321 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:19.322 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:19.324 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:19.325 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:54:19.332 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 11:54:19.332 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 11:54:19.333 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 11:54:19.334 -03:00 [DBG] Start authorize callback request
2018-08-27 11:54:19.334 -03:00 [DBG] User in authorize request: a4e211ec-86f0-43dd-b102-1413fc89f8a3
2018-08-27 11:54:19.335 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:54:19.340 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:54:19.342 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:19.344 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:19.346 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:19.348 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:19.349 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:54:19.350 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "a4e211ec-86f0-43dd-b102-1413fc89f8a3",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "w0UH5mGxh86O663PLQKC86kGPgzltYuE0NbTl7xy",
  "Nonce": "w0UH5mGxh86O663PLQKC86kGPgzltYuE0NbTl7xy",
  "SessionId": "a73793568a8b0e9b06dac84e6c901385",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "w0UH5mGxh86O663PLQKC86kGPgzltYuE0NbTl7xy",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "w0UH5mGxh86O663PLQKC86kGPgzltYuE0NbTl7xy"
  }
}
2018-08-27 11:54:19.357 -03:00 [DBG] 4eOVJ8eTKAfIxHShhIT+yJ4V4j1pro8FxuqDVgOy2Xs= found in database: false
2018-08-27 11:54:19.358 -03:00 [DBG] user_consent grant with value: UserManagementUI|a4e211ec-86f0-43dd-b102-1413fc89f8a3 not found in store.
2018-08-27 11:54:19.359 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 11:54:19.360 -03:00 [INF] User consented to scopes: ["openid","profile","email"]
2018-08-27 11:54:19.361 -03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email"]
2018-08-27 11:54:19.364 -03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: a4e211ec-86f0-43dd-b102-1413fc89f8a3
2018-08-27 11:54:19.368 -03:00 [DBG] 4eOVJ8eTKAfIxHShhIT+yJ4V4j1pro8FxuqDVgOy2Xs= not found in database
2018-08-27 11:54:19.376 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 11:54:19.376 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 11:54:19.377 -03:00 [DBG] Getting claims for access token for subject: a4e211ec-86f0-43dd-b102-1413fc89f8a3
2018-08-27 11:54:19.386 -03:00 [DBG] 2Cz5ni1TFnH47ISfdlHxEjPlmfU5lPYgPtmd/jojC1M= not found in database
2018-08-27 11:54:19.389 -03:00 [DBG] Getting claims for identity token for subject: a4e211ec-86f0-43dd-b102-1413fc89f8a3 and client: UserManagementUI
2018-08-27 11:54:19.390 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 11:54:19.393 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "a4e211ec-86f0-43dd-b102-1413fc89f8a3",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****5Wsw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****cbf7"
    }
  ],
  "ActivityId": "0HLGC5APL1BVT:00000026",
  "TimeStamp": "2018-08-27T14:54:19Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:54:19.395 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "a4e211ec-86f0-43dd-b102-1413fc89f8a3",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "w0UH5mGxh86O663PLQKC86kGPgzltYuE0NbTl7xy",
  "Scope": "openid profile email"
}
2018-08-27 11:54:19.396 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:54:19.396 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:54:20.333 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:54:20.336 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:54:20.337 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:54:20.338 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:54:20.339 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:54:20.340 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:54:20.341 -03:00 [DBG] Start discovery request
2018-08-27 11:54:20.349 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:54:20.372 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:54:20.376 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:54:20.377 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:54:20.378 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:54:20.380 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:54:20.381 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:54:20.386 -03:00 [DBG] Start key discovery request
2018-08-27 11:54:26.334 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 11:54:26.339 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 11:54:26.340 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 11:54:26.342 -03:00 [DBG] Processing signout request for a4e211ec-86f0-43dd-b102-1413fc89f8a3
2018-08-27 11:54:26.344 -03:00 [DBG] Start end session request validation
2018-08-27 11:54:26.344 -03:00 [DBG] Start identity token validation
2018-08-27 11:54:26.351 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:54:26.352 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 11:54:26.357 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 11:54:26.358 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535381659,
    "exp": 1535381959,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "w0UH5mGxh86O663PLQKC86kGPgzltYuE0NbTl7xy",
    "iat": 1535381659,
    "at_hash": "TF6M0yE_XvL7-6AWodXrCA",
    "sid": "a73793568a8b0e9b06dac84e6c901385",
    "sub": "a4e211ec-86f0-43dd-b102-1413fc89f8a3",
    "auth_time": 1535381657,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-08-27 11:54:26.360 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "a4e211ec-86f0-43dd-b102-1413fc89f8a3",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzODE2NTksImV4cCI6MTUzNTM4MTk1OSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoidzBVSDVtR3hoODZPNjYzUExRS0M4NmtHUGd6bHRZdUUwTmJUbDd4eSIsImlhdCI6MTUzNTM4MTY1OSwiYXRfaGFzaCI6IlRGNk0weUVfWHZMNy02QVdvZFhyQ0EiLCJzaWQiOiJhNzM3OTM1NjhhOGIwZTliMDZkYWM4NGU2YzkwMTM4NSIsInN1YiI6ImE0ZTIxMWVjLTg2ZjAtNDNkZC1iMTAyLTE0MTNmYzg5ZjhhMyIsImF1dGhfdGltZSI6MTUzNTM4MTY1NywiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.GPNgv9Pr_SAl72G0KeU5ChhaTAyN6iG-NDKeXhpq_WKVluKaf05UBk2-iXdtb0DS8USKcY0dmC9xMEFUSFqJXSfODvhskStquo_gbU7QZICIFNJDo4XI6bpPD7n9N3cCF5SdpghXhfRwHSJxXpvoDoTtq26-K0FFJQYq77UKNOhyJgnxwjizccvPc6fdS-2D8nuEAKdctpcKJe2FvKLhEh9oV5bV1T_But2exmot-wB6Ask4LR746vcb2zbmHfK280X5oZSrKSVL3KmTe1KufrlPGjXrnF7K1c3yuCKG7EE3UZWnEhgfqoRNqj6FoGbWKNsno7AT7bjOR5oq9k5Wsw",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 11:54:26.362 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 11:54:26.366 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 11:54:26.369 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:54:26.370 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 11:54:26.372 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "a4e211ec-86f0-43dd-b102-1413fc89f8a3",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGC5APL1BVT:00000028",
  "TimeStamp": "2018-08-27T14:54:26Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:54:26.435 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 11:54:26.438 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 11:54:26.439 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 11:54:26.440 -03:00 [DBG] Processing signout callback request
2018-08-27 11:54:26.447 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:54:26.448 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 11:54:26.449 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 11:54:26.449 -03:00 [INF] Successful signout callback.
2018-08-27 11:54:26.450 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 11:54:26.451 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 11:54:28.621 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:54:28.627 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:54:28.629 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:54:28.632 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:54:28.636 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:54:28.637 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:54:28.638 -03:00 [DBG] Start discovery request
2018-08-27 11:54:28.648 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:54:28.662 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:54:28.668 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:54:28.669 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:54:28.670 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:54:28.672 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:54:28.676 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:54:28.679 -03:00 [DBG] Start key discovery request
2018-08-27 11:54:28.697 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:54:28.699 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:54:28.700 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:54:28.701 -03:00 [DBG] Start authorize request
2018-08-27 11:54:28.702 -03:00 [DBG] No user present in authorize request
2018-08-27 11:54:28.703 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:54:28.710 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:54:28.713 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:28.716 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:28.718 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:28.721 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:28.721 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:54:28.723 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "mICUtyIEeDYNGoDBYBpMtm85dUVqzEgwhLx6IuCU",
  "Nonce": "mICUtyIEeDYNGoDBYBpMtm85dUVqzEgwhLx6IuCU",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "mICUtyIEeDYNGoDBYBpMtm85dUVqzEgwhLx6IuCU",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "mICUtyIEeDYNGoDBYBpMtm85dUVqzEgwhLx6IuCU"
  }
}
2018-08-27 11:54:28.725 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 11:54:28.734 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:54:28.741 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:54:28.743 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:28.744 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:28.747 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:54:28.749 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:54:28.750 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:54:28.755 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:55:12.721 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:55:12.725 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:55:12.727 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:55:12.728 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:55:12.730 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:55:12.733 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:55:12.735 -03:00 [DBG] Start discovery request
2018-08-27 11:55:12.740 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:55:12.770 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:55:12.774 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:55:12.775 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:55:12.777 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:55:12.779 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:55:12.780 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:55:12.783 -03:00 [DBG] Start key discovery request
2018-08-27 11:55:12.808 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:55:12.812 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:55:12.819 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:55:12.821 -03:00 [DBG] Start authorize request
2018-08-27 11:55:12.822 -03:00 [DBG] No user present in authorize request
2018-08-27 11:55:12.822 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:55:12.829 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:55:12.832 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:55:12.837 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:55:12.839 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:55:12.840 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:55:12.840 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:55:12.841 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "bkq6ZFhow6yaINN9UPseEWcCl2rtCNKpWbEzGYLI",
  "Nonce": "bkq6ZFhow6yaINN9UPseEWcCl2rtCNKpWbEzGYLI",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "bkq6ZFhow6yaINN9UPseEWcCl2rtCNKpWbEzGYLI",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "bkq6ZFhow6yaINN9UPseEWcCl2rtCNKpWbEzGYLI"
  }
}
2018-08-27 11:55:12.844 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 11:55:12.854 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:55:12.860 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:55:12.862 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:55:12.864 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:55:12.866 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:55:12.867 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:55:12.869 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:55:12.874 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:56:12.788 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:56:12.801 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:56:12.803 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:56:12.804 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:56:12.807 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:56:12.810 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:56:12.811 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:56:12.817 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:56:16.301 -03:00 [INF] AuthenticationScheme: Google was challenged.
2018-08-27 11:56:56.023 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 11:56:56.047 -03:00 [INF] User created a new account with password.
2018-08-27 11:56:56.048 -03:00 [INF] User created a new account with password.
2018-08-27 11:56:56.069 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Google",
  "ProviderUserId": "106800735291513176099",
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "DisplayName": "Marco Aurelio",
  "Endpoint": "UI",
  "ActivityId": "0HLGC5APL1C06:00000005",
  "TimeStamp": "2018-08-27T14:56:56Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:56:56.071 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:56:56.072 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 11:56:56.072 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:56:56.073 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:56:56.076 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 11:56:56.076 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 11:56:56.077 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 11:56:56.078 -03:00 [DBG] Start authorize callback request
2018-08-27 11:56:56.079 -03:00 [DBG] User in authorize request: 175c6391-f8be-47f3-9c57-b14016ca51c6
2018-08-27 11:56:56.080 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:56:56.091 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:56:56.093 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:56:56.094 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:56:56.096 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:56:56.098 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:56:56.098 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:56:56.099 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "bkq6ZFhow6yaINN9UPseEWcCl2rtCNKpWbEzGYLI",
  "Nonce": "bkq6ZFhow6yaINN9UPseEWcCl2rtCNKpWbEzGYLI",
  "SessionId": "2078b61e6504cdcd9cf5ddb7e0da4f50",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "bkq6ZFhow6yaINN9UPseEWcCl2rtCNKpWbEzGYLI",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "bkq6ZFhow6yaINN9UPseEWcCl2rtCNKpWbEzGYLI"
  }
}
2018-08-27 11:56:56.107 -03:00 [DBG] okPngKVxmvIXIhYy36G9Z9Hr/bKawntUL7TsxKX0rOA= found in database: false
2018-08-27 11:56:56.107 -03:00 [DBG] user_consent grant with value: UserManagementUI|175c6391-f8be-47f3-9c57-b14016ca51c6 not found in store.
2018-08-27 11:56:56.108 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 11:56:56.108 -03:00 [INF] Showing consent: User has not yet consented
2018-08-27 11:56:56.110 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:56:56.117 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:56:56.119 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:56:56.121 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:56:56.123 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:56:56.124 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:56:56.125 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:56:56.130 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:56:56.133 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:56:56.134 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:20.918 -03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 11:57:20.921 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:57:20.930 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:57:20.934 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:20.936 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:20.939 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:20.941 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:20.942 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:57:20.949 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 11:57:20.951 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 11:57:20.953 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 11:57:20.954 -03:00 [DBG] Start authorize callback request
2018-08-27 11:57:20.954 -03:00 [DBG] User in authorize request: 175c6391-f8be-47f3-9c57-b14016ca51c6
2018-08-27 11:57:20.955 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:57:20.961 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:57:20.963 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:20.966 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:20.968 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:20.970 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:20.970 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:57:20.971 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "bkq6ZFhow6yaINN9UPseEWcCl2rtCNKpWbEzGYLI",
  "Nonce": "bkq6ZFhow6yaINN9UPseEWcCl2rtCNKpWbEzGYLI",
  "SessionId": "2078b61e6504cdcd9cf5ddb7e0da4f50",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "bkq6ZFhow6yaINN9UPseEWcCl2rtCNKpWbEzGYLI",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "bkq6ZFhow6yaINN9UPseEWcCl2rtCNKpWbEzGYLI"
  }
}
2018-08-27 11:57:20.978 -03:00 [DBG] okPngKVxmvIXIhYy36G9Z9Hr/bKawntUL7TsxKX0rOA= found in database: false
2018-08-27 11:57:20.979 -03:00 [DBG] user_consent grant with value: UserManagementUI|175c6391-f8be-47f3-9c57-b14016ca51c6 not found in store.
2018-08-27 11:57:20.980 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 11:57:20.981 -03:00 [INF] User consented to scopes: ["openid","profile","email"]
2018-08-27 11:57:20.982 -03:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 175c6391-f8be-47f3-9c57-b14016ca51c6
2018-08-27 11:57:20.986 -03:00 [DBG] no okPngKVxmvIXIhYy36G9Z9Hr/bKawntUL7TsxKX0rOA= persisted grant found in database
2018-08-27 11:57:20.988 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 11:57:20.989 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 11:57:20.990 -03:00 [DBG] Getting claims for access token for subject: 175c6391-f8be-47f3-9c57-b14016ca51c6
2018-08-27 11:57:20.999 -03:00 [DBG] 8SIrP663pZt6hkzQP2ZbkoFHE69oaV0azj1I8pDwGKU= not found in database
2018-08-27 11:57:21.006 -03:00 [DBG] Getting claims for identity token for subject: 175c6391-f8be-47f3-9c57-b14016ca51c6 and client: UserManagementUI
2018-08-27 11:57:21.008 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 11:57:21.012 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****96vg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****5521"
    }
  ],
  "ActivityId": "0HLGC5APL1C06:0000000B",
  "TimeStamp": "2018-08-27T14:57:21Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:57:21.014 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "bkq6ZFhow6yaINN9UPseEWcCl2rtCNKpWbEzGYLI",
  "Scope": "openid profile email"
}
2018-08-27 11:57:21.016 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:57:21.017 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:57:22.101 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:57:22.105 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:57:22.106 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:57:22.108 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:57:22.110 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:57:22.113 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:57:22.114 -03:00 [DBG] Start discovery request
2018-08-27 11:57:22.120 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:57:22.123 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:57:22.125 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:57:22.126 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:57:22.126 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:57:22.127 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:57:22.128 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:57:22.129 -03:00 [DBG] Start key discovery request
2018-08-27 11:57:22.135 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:57:22.136 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:57:22.137 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:57:22.137 -03:00 [DBG] Start authorize request
2018-08-27 11:57:22.138 -03:00 [DBG] User in authorize request: 175c6391-f8be-47f3-9c57-b14016ca51c6
2018-08-27 11:57:22.138 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:57:22.144 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:57:22.146 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:22.148 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:22.150 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:22.151 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:22.152 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:57:22.154 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "RVhNNSRBUnkSJZojlkGBPHs6RzaKygu5WuS9He78",
  "Nonce": "RVhNNSRBUnkSJZojlkGBPHs6RzaKygu5WuS9He78",
  "SessionId": "2078b61e6504cdcd9cf5ddb7e0da4f50",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "RVhNNSRBUnkSJZojlkGBPHs6RzaKygu5WuS9He78",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "RVhNNSRBUnkSJZojlkGBPHs6RzaKygu5WuS9He78"
  }
}
2018-08-27 11:57:22.159 -03:00 [DBG] okPngKVxmvIXIhYy36G9Z9Hr/bKawntUL7TsxKX0rOA= found in database: false
2018-08-27 11:57:22.160 -03:00 [DBG] user_consent grant with value: UserManagementUI|175c6391-f8be-47f3-9c57-b14016ca51c6 not found in store.
2018-08-27 11:57:22.161 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 11:57:22.161 -03:00 [INF] Showing consent: User has not yet consented
2018-08-27 11:57:22.163 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:57:22.169 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:57:22.171 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:22.172 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:22.174 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:22.176 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:22.176 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:57:22.182 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:57:22.184 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:22.185 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:37.809 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:57:37.813 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:57:37.814 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:57:37.815 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:57:37.816 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:57:37.817 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:57:37.818 -03:00 [DBG] Start discovery request
2018-08-27 11:57:37.825 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:57:37.833 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:57:37.836 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:57:37.837 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:57:37.838 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:57:37.839 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:57:37.839 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:57:37.840 -03:00 [DBG] Start key discovery request
2018-08-27 11:57:37.848 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:57:37.850 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:57:37.853 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:57:37.854 -03:00 [DBG] Start authorize request
2018-08-27 11:57:37.854 -03:00 [DBG] User in authorize request: 175c6391-f8be-47f3-9c57-b14016ca51c6
2018-08-27 11:57:37.855 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:57:37.861 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:57:37.863 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:37.865 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:37.867 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:37.868 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:37.869 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:57:37.871 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "YytX7BqtsErbpwnWrqPFvKnKYgku9wyuEyVXFfrR",
  "Nonce": "YytX7BqtsErbpwnWrqPFvKnKYgku9wyuEyVXFfrR",
  "SessionId": "2078b61e6504cdcd9cf5ddb7e0da4f50",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "YytX7BqtsErbpwnWrqPFvKnKYgku9wyuEyVXFfrR",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "YytX7BqtsErbpwnWrqPFvKnKYgku9wyuEyVXFfrR"
  }
}
2018-08-27 11:57:37.877 -03:00 [DBG] okPngKVxmvIXIhYy36G9Z9Hr/bKawntUL7TsxKX0rOA= found in database: false
2018-08-27 11:57:37.877 -03:00 [DBG] user_consent grant with value: UserManagementUI|175c6391-f8be-47f3-9c57-b14016ca51c6 not found in store.
2018-08-27 11:57:37.878 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 11:57:37.879 -03:00 [INF] Showing consent: User has not yet consented
2018-08-27 11:57:37.881 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:57:37.889 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:57:37.892 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:37.894 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:37.896 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:37.897 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:37.898 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:57:37.904 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:57:37.906 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:37.908 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:39.822 -03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 11:57:39.826 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:57:39.835 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:57:39.837 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:39.838 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:39.840 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:39.841 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:39.842 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:57:39.844 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 11:57:39.845 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 11:57:39.846 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 11:57:39.846 -03:00 [DBG] Start authorize callback request
2018-08-27 11:57:39.848 -03:00 [DBG] User in authorize request: 175c6391-f8be-47f3-9c57-b14016ca51c6
2018-08-27 11:57:39.849 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:57:39.854 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:57:39.857 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:39.858 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:39.860 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:57:39.861 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:57:39.862 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:57:39.864 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "YytX7BqtsErbpwnWrqPFvKnKYgku9wyuEyVXFfrR",
  "Nonce": "YytX7BqtsErbpwnWrqPFvKnKYgku9wyuEyVXFfrR",
  "SessionId": "2078b61e6504cdcd9cf5ddb7e0da4f50",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "YytX7BqtsErbpwnWrqPFvKnKYgku9wyuEyVXFfrR",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "YytX7BqtsErbpwnWrqPFvKnKYgku9wyuEyVXFfrR"
  }
}
2018-08-27 11:57:39.870 -03:00 [DBG] okPngKVxmvIXIhYy36G9Z9Hr/bKawntUL7TsxKX0rOA= found in database: false
2018-08-27 11:57:39.871 -03:00 [DBG] user_consent grant with value: UserManagementUI|175c6391-f8be-47f3-9c57-b14016ca51c6 not found in store.
2018-08-27 11:57:39.872 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 11:57:39.872 -03:00 [INF] User consented to scopes: ["openid","profile","email"]
2018-08-27 11:57:39.873 -03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email"]
2018-08-27 11:57:39.876 -03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 175c6391-f8be-47f3-9c57-b14016ca51c6
2018-08-27 11:57:39.880 -03:00 [DBG] okPngKVxmvIXIhYy36G9Z9Hr/bKawntUL7TsxKX0rOA= not found in database
2018-08-27 11:57:39.886 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 11:57:39.886 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 11:57:39.886 -03:00 [DBG] Getting claims for access token for subject: 175c6391-f8be-47f3-9c57-b14016ca51c6
2018-08-27 11:57:39.895 -03:00 [DBG] /QFqXShBoT6EvdspovBdYgxt4R/Hi9jOdD/YhnbN1L8= not found in database
2018-08-27 11:57:39.900 -03:00 [DBG] Getting claims for identity token for subject: 175c6391-f8be-47f3-9c57-b14016ca51c6 and client: UserManagementUI
2018-08-27 11:57:39.901 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 11:57:39.904 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Fe3A"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****b129"
    }
  ],
  "ActivityId": "0HLGC5APL1C06:00000011",
  "TimeStamp": "2018-08-27T14:57:39Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:57:39.906 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "YytX7BqtsErbpwnWrqPFvKnKYgku9wyuEyVXFfrR",
  "Scope": "openid profile email"
}
2018-08-27 11:57:40.380 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:57:40.385 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:57:40.386 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:57:40.387 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:57:40.388 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:57:40.390 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:57:40.392 -03:00 [DBG] Start discovery request
2018-08-27 11:57:40.402 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:57:40.407 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:57:40.409 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:57:40.409 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:57:40.409 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:57:40.410 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:57:40.413 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:57:40.414 -03:00 [DBG] Start key discovery request
2018-08-27 11:57:46.883 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:57:46.886 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:57:46.887 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:57:46.888 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:57:46.890 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:57:46.891 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:57:46.895 -03:00 [DBG] Start discovery request
2018-08-27 11:57:46.904 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:57:46.911 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:57:46.914 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:57:46.916 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:57:46.917 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:57:46.917 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:57:46.918 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:57:46.919 -03:00 [DBG] Start key discovery request
2018-08-27 11:57:50.587 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:57:50.591 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:57:50.592 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:57:50.594 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:57:50.595 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:57:50.596 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:57:50.601 -03:00 [DBG] Start discovery request
2018-08-27 11:57:50.612 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:57:50.619 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:57:50.622 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:57:50.622 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:57:50.623 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:57:50.624 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:57:50.625 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:57:50.625 -03:00 [DBG] Start key discovery request
2018-08-27 11:57:54.507 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:57:54.511 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:57:54.513 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:57:54.514 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:57:54.516 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:57:54.517 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:57:54.519 -03:00 [DBG] Start discovery request
2018-08-27 11:57:54.528 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:57:54.532 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:57:54.534 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:57:54.535 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:57:54.536 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:57:54.536 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:57:54.537 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:57:54.538 -03:00 [DBG] Start key discovery request
2018-08-27 11:57:57.247 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:57:57.250 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:57:57.251 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:57:57.252 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:57:57.254 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:57:57.255 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:57:57.256 -03:00 [DBG] Start discovery request
2018-08-27 11:57:57.261 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:57:57.267 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:57:57.270 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:57:57.270 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:57:57.271 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:57:57.272 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:57:57.272 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:57:57.273 -03:00 [DBG] Start key discovery request
2018-08-27 11:58:00.092 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:58:00.096 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:58:00.097 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:58:00.098 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:58:00.101 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:58:00.104 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:58:00.106 -03:00 [DBG] Start discovery request
2018-08-27 11:58:00.114 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:58:00.123 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:58:00.125 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:58:00.126 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:58:00.127 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:58:00.127 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:58:00.128 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:58:00.129 -03:00 [DBG] Start key discovery request
2018-08-27 11:58:03.432 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:58:03.436 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:58:03.437 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:58:03.438 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:58:03.441 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:58:03.442 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:58:03.445 -03:00 [DBG] Start discovery request
2018-08-27 11:58:03.455 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:58:03.462 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:58:03.465 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:58:03.467 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:58:03.468 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:58:03.469 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:58:03.470 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:58:03.471 -03:00 [DBG] Start key discovery request
2018-08-27 11:58:04.436 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:58:04.437 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:58:04.439 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:58:04.440 -03:00 [DBG] Start authorize request
2018-08-27 11:58:04.441 -03:00 [DBG] User in authorize request: 175c6391-f8be-47f3-9c57-b14016ca51c6
2018-08-27 11:58:04.442 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:58:04.447 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:58:04.451 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:58:04.453 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:58:04.455 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:58:04.456 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:58:04.456 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:58:04.459 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "eZXx6Gq30OGwi5xeBOyrAaj8wCBnoCu3dIvlcl46;login",
  "Nonce": "eZXx6Gq30OGwi5xeBOyrAaj8wCBnoCu3dIvlcl46",
  "SessionId": "2078b61e6504cdcd9cf5ddb7e0da4f50",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "eZXx6Gq30OGwi5xeBOyrAaj8wCBnoCu3dIvlcl46;login",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "eZXx6Gq30OGwi5xeBOyrAaj8wCBnoCu3dIvlcl46"
  }
}
2018-08-27 11:58:04.465 -03:00 [DBG] okPngKVxmvIXIhYy36G9Z9Hr/bKawntUL7TsxKX0rOA= found in database: true
2018-08-27 11:58:04.469 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-27 11:58:04.470 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 11:58:04.470 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 11:58:04.471 -03:00 [DBG] Getting claims for access token for subject: 175c6391-f8be-47f3-9c57-b14016ca51c6
2018-08-27 11:58:04.480 -03:00 [DBG] 5oY3WikpnCLio1mLKBXXwqwawGCmOZw4kFORBMY9aGM= not found in database
2018-08-27 11:58:04.491 -03:00 [DBG] Getting claims for identity token for subject: 175c6391-f8be-47f3-9c57-b14016ca51c6 and client: UserManagementUI
2018-08-27 11:58:04.493 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 11:58:04.496 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****2rvA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****0624"
    }
  ],
  "ActivityId": "0HLGC5APL1C06:00000012",
  "TimeStamp": "2018-08-27T14:58:04Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:58:04.500 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "eZXx6Gq30OGwi5xeBOyrAaj8wCBnoCu3dIvlcl46;login",
  "Scope": "openid profile email"
}
2018-08-27 11:58:05.875 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:58:05.880 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:58:05.881 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:58:05.882 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:58:05.885 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:58:05.886 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:58:05.887 -03:00 [DBG] Start discovery request
2018-08-27 11:58:05.892 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:58:05.895 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:58:05.896 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:58:05.897 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:58:05.898 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:58:05.901 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:58:05.902 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:58:05.902 -03:00 [DBG] Start key discovery request
2018-08-27 11:58:09.736 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:58:09.740 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:58:09.741 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:58:09.742 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:58:09.744 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:58:09.745 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:58:09.749 -03:00 [DBG] Start discovery request
2018-08-27 11:58:09.757 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:58:09.764 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:58:09.768 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:58:09.769 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:58:09.770 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:58:09.771 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:58:09.772 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:58:09.772 -03:00 [DBG] Start key discovery request
2018-08-27 11:58:13.583 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:58:13.587 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:58:13.588 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:58:13.588 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:58:13.589 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:58:13.590 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:58:13.592 -03:00 [DBG] Start discovery request
2018-08-27 11:58:13.601 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:58:13.611 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:58:13.612 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:58:13.613 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:58:13.613 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:58:13.616 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:58:13.617 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:58:13.618 -03:00 [DBG] Start key discovery request
2018-08-27 11:58:19.382 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:58:19.387 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:58:19.388 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:58:19.389 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:58:19.391 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:58:19.392 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:58:19.395 -03:00 [DBG] Start discovery request
2018-08-27 11:58:19.406 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:58:19.413 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:58:19.416 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:58:19.417 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:58:19.420 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:58:19.421 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:58:19.422 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:58:19.424 -03:00 [DBG] Start key discovery request
2018-08-27 11:59:13.354 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:59:13.360 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:59:13.361 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:59:13.362 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:59:13.363 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:59:13.364 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:59:13.366 -03:00 [DBG] Start discovery request
2018-08-27 11:59:13.375 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:59:13.379 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:59:13.381 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:59:13.383 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:59:13.384 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:59:13.385 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:59:13.387 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:59:13.389 -03:00 [DBG] Start key discovery request
2018-08-27 11:59:19.674 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 11:59:19.675 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 11:59:19.678 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 11:59:19.679 -03:00 [DBG] Processing signout request for 175c6391-f8be-47f3-9c57-b14016ca51c6
2018-08-27 11:59:19.680 -03:00 [DBG] Start end session request validation
2018-08-27 11:59:19.680 -03:00 [DBG] Start identity token validation
2018-08-27 11:59:19.687 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:59:19.688 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 11:59:19.692 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 11:59:19.693 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535381884,
    "exp": 1535382184,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "eZXx6Gq30OGwi5xeBOyrAaj8wCBnoCu3dIvlcl46",
    "iat": 1535381884,
    "at_hash": "HJm2L66cx-qeu7U66Eh7fA",
    "sid": "2078b61e6504cdcd9cf5ddb7e0da4f50",
    "sub": "175c6391-f8be-47f3-9c57-b14016ca51c6",
    "auth_time": 1535381816,
    "idp": "Google",
    "amr": "external"
  }
}
2018-08-27 11:59:19.696 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzODE4ODQsImV4cCI6MTUzNTM4MjE4NCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiZVpYeDZHcTMwT0d3aTV4ZUJPeXJBYWo4d0NCbm9DdTNkSXZsY2w0NiIsImlhdCI6MTUzNTM4MTg4NCwiYXRfaGFzaCI6IkhKbTJMNjZjeC1xZXU3VTY2RWg3ZkEiLCJzaWQiOiIyMDc4YjYxZTY1MDRjZGNkOWNmNWRkYjdlMGRhNGY1MCIsInN1YiI6IjE3NWM2MzkxLWY4YmUtNDdmMy05YzU3LWIxNDAxNmNhNTFjNiIsImF1dGhfdGltZSI6MTUzNTM4MTgxNiwiaWRwIjoiR29vZ2xlIiwiYW1yIjpbImV4dGVybmFsIl19.CyR67eB2E7oJ0BoSI-pocuYdDtvNCr8BkjOCgMO8k_QMQ3YtsYE2eC5Ag3jEWhs4vE2rM0B2onQbxH7Y4w-h5Zo9I5KvBMzf6ZUe50ozRTIASCuOj0gFhdb2fnbFth48l92Z7vS_mwdGtjI_RbUBJs-4o0AbyuBsTvQQFgDc4EuHywobTY9qt-E9XZxydsXAR5zO9yzgMFDojY4I3ipcYjSqJgz0evBPWm0eeq9gHA-yNDr2VSY5O9rcc2VkYr0-C--O-CfKBczS0QQz3j133jFUgPHcCMsOx5gqmr9Kn4aJRNIhtID4mPJCaJHyHGOiLTQ0eX1hw-09XVAhZV2rvA",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 11:59:19.698 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 11:59:19.701 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 11:59:19.702 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:59:19.703 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 11:59:19.704 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "DisplayName": "Marco Aurelio",
  "ActivityId": "0HLGC5APL1C06:00000014",
  "TimeStamp": "2018-08-27T14:59:19Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:59:19.724 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 11:59:19.726 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 11:59:19.728 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 11:59:19.729 -03:00 [DBG] Processing signout callback request
2018-08-27 11:59:19.741 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:59:19.742 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 11:59:19.742 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 11:59:19.743 -03:00 [INF] Successful signout callback.
2018-08-27 11:59:19.743 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 11:59:19.744 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 11:59:23.103 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:59:23.107 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:59:23.109 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:59:23.109 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:59:23.111 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:59:23.112 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:59:23.113 -03:00 [DBG] Start discovery request
2018-08-27 11:59:23.120 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:59:23.128 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:59:23.131 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:59:23.132 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:59:23.134 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:59:23.135 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:59:23.136 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:59:23.136 -03:00 [DBG] Start key discovery request
2018-08-27 11:59:23.141 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:59:23.142 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:59:23.146 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:59:23.147 -03:00 [DBG] Start authorize request
2018-08-27 11:59:23.147 -03:00 [DBG] No user present in authorize request
2018-08-27 11:59:23.148 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:59:23.154 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:59:23.156 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:59:23.158 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:59:23.160 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:59:23.162 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:59:23.163 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:59:23.165 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "LLtms0qzJwQv5s8xzYekpgXG5ffYAPCVFBURzqPx",
  "Nonce": "LLtms0qzJwQv5s8xzYekpgXG5ffYAPCVFBURzqPx",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "LLtms0qzJwQv5s8xzYekpgXG5ffYAPCVFBURzqPx",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "LLtms0qzJwQv5s8xzYekpgXG5ffYAPCVFBURzqPx"
  }
}
2018-08-27 11:59:23.168 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 11:59:23.174 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:59:23.182 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:59:23.186 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:59:23.188 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:59:23.190 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:59:23.192 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:59:23.193 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:59:23.200 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:59:26.360 -03:00 [INF] AuthenticationScheme: Google was challenged.
2018-08-27 11:59:27.950 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 11:59:27.965 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Google",
  "ProviderUserId": "106800735291513176099",
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "DisplayName": "Marco Aurelio",
  "Endpoint": "UI",
  "ActivityId": "0HLGC5APL1C06:0000001A",
  "TimeStamp": "2018-08-27T14:59:27Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:59:27.966 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:59:27.967 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 11:59:27.967 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:59:27.968 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:59:27.972 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 11:59:27.973 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 11:59:27.974 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 11:59:27.975 -03:00 [DBG] Start authorize callback request
2018-08-27 11:59:27.975 -03:00 [DBG] User in authorize request: 175c6391-f8be-47f3-9c57-b14016ca51c6
2018-08-27 11:59:27.976 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:59:27.983 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:59:27.986 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:59:27.988 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:59:27.991 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:59:27.993 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:59:27.994 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:59:27.995 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "LLtms0qzJwQv5s8xzYekpgXG5ffYAPCVFBURzqPx",
  "Nonce": "LLtms0qzJwQv5s8xzYekpgXG5ffYAPCVFBURzqPx",
  "SessionId": "e623b7492e4c8aa457d768b413706ce9",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "LLtms0qzJwQv5s8xzYekpgXG5ffYAPCVFBURzqPx",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "LLtms0qzJwQv5s8xzYekpgXG5ffYAPCVFBURzqPx"
  }
}
2018-08-27 11:59:28.004 -03:00 [DBG] okPngKVxmvIXIhYy36G9Z9Hr/bKawntUL7TsxKX0rOA= found in database: true
2018-08-27 11:59:28.007 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-27 11:59:28.008 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 11:59:28.009 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 11:59:28.010 -03:00 [DBG] Getting claims for access token for subject: 175c6391-f8be-47f3-9c57-b14016ca51c6
2018-08-27 11:59:28.018 -03:00 [DBG] 4hz48/Za8TkIIA4ub7qNBmoMwZTOSAdN9oQbvCdPiMQ= not found in database
2018-08-27 11:59:28.026 -03:00 [DBG] Getting claims for identity token for subject: 175c6391-f8be-47f3-9c57-b14016ca51c6 and client: UserManagementUI
2018-08-27 11:59:28.027 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 11:59:28.030 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****FgHg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****2cff"
    }
  ],
  "ActivityId": "0HLGC5APL1C06:0000001B",
  "TimeStamp": "2018-08-27T14:59:28Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:59:28.034 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "LLtms0qzJwQv5s8xzYekpgXG5ffYAPCVFBURzqPx",
  "Scope": "openid profile email"
}
2018-08-27 11:59:28.035 -03:00 [DBG] Augmenting SignInContext
2018-08-27 11:59:28.035 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 11:59:28.515 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:59:28.520 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:59:28.521 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:59:28.523 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:59:28.524 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:59:28.525 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:59:28.526 -03:00 [DBG] Start discovery request
2018-08-27 11:59:28.532 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:59:28.536 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:59:28.539 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:59:28.540 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:59:28.540 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:59:28.541 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:59:28.542 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:59:28.543 -03:00 [DBG] Start key discovery request
2018-08-27 11:59:32.680 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:59:32.685 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:59:32.686 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:59:32.687 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:59:32.689 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:59:32.690 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:59:32.694 -03:00 [DBG] Start discovery request
2018-08-27 11:59:32.703 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:59:32.708 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:59:32.711 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:59:32.712 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:59:32.713 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:59:32.714 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:59:32.715 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:59:32.715 -03:00 [DBG] Start key discovery request
2018-08-27 11:59:36.903 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:59:36.905 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:59:36.907 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:59:36.909 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:59:36.910 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:59:36.912 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:59:36.916 -03:00 [DBG] Start discovery request
2018-08-27 11:59:36.927 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:59:36.931 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:59:36.934 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:59:36.935 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:59:36.936 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:59:36.936 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:59:36.938 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:59:36.938 -03:00 [DBG] Start key discovery request
2018-08-27 11:59:43.112 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 11:59:43.115 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 11:59:43.117 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 11:59:43.117 -03:00 [DBG] Processing signout request for 175c6391-f8be-47f3-9c57-b14016ca51c6
2018-08-27 11:59:43.118 -03:00 [DBG] Start end session request validation
2018-08-27 11:59:43.118 -03:00 [DBG] Start identity token validation
2018-08-27 11:59:43.125 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:59:43.125 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 11:59:43.130 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 11:59:43.131 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535381968,
    "exp": 1535382268,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "LLtms0qzJwQv5s8xzYekpgXG5ffYAPCVFBURzqPx",
    "iat": 1535381968,
    "at_hash": "xV6NNL34s8Hz3hEn4yFNuw",
    "sid": "e623b7492e4c8aa457d768b413706ce9",
    "sub": "175c6391-f8be-47f3-9c57-b14016ca51c6",
    "auth_time": 1535381967,
    "idp": "Google",
    "amr": "external"
  }
}
2018-08-27 11:59:43.134 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzODE5NjgsImV4cCI6MTUzNTM4MjI2OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiTEx0bXMwcXpKd1F2NXM4eHpZZWtwZ1hHNWZmWUFQQ1ZGQlVSenFQeCIsImlhdCI6MTUzNTM4MTk2OCwiYXRfaGFzaCI6InhWNk5OTDM0czhIejNoRW40eUZOdXciLCJzaWQiOiJlNjIzYjc0OTJlNGM4YWE0NTdkNzY4YjQxMzcwNmNlOSIsInN1YiI6IjE3NWM2MzkxLWY4YmUtNDdmMy05YzU3LWIxNDAxNmNhNTFjNiIsImF1dGhfdGltZSI6MTUzNTM4MTk2NywiaWRwIjoiR29vZ2xlIiwiYW1yIjpbImV4dGVybmFsIl19.Qe3GmuKzq0DcnKUm8xwNKbv_zg3LoyH3AhZxCQlHkMtq4MVly-7VdLJeBPK13cdh6Sh06C0J5vqI0WxDKyl1HlgED-YcNuW2YuLuFdpAmSgeN61ICqgMRGCw24SVO9KwLjgP1ymqn6QplfM18twR6L4aGgn8S2jctesdyHGOEI2cPDRIjGH2yyBzkd6GoBVljjSI_ngamuz0jmUMWzTfo17cLtS4bKACeMJmmK5tT2oE4v8Q1VtCZBVHmI9Q7Ezdtax3ODrM6f1WjF3P2Kkej8n9JwLPO2til3MiraWInbmc3-J94VlnRLvZtd4Ko8_jowJVXxiFLuxYRYSy2JFgHg",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 11:59:43.136 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 11:59:43.141 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 11:59:43.142 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 11:59:43.145 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 11:59:43.146 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "175c6391-f8be-47f3-9c57-b14016ca51c6",
  "DisplayName": "Marco Aurelio",
  "ActivityId": "0HLGC5APL1C06:0000001D",
  "TimeStamp": "2018-08-27T14:59:43Z",
  "ProcessId": 14596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 11:59:43.163 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 11:59:43.166 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 11:59:43.171 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 11:59:43.172 -03:00 [DBG] Processing signout callback request
2018-08-27 11:59:43.179 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:59:43.179 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 11:59:43.180 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 11:59:43.180 -03:00 [INF] Successful signout callback.
2018-08-27 11:59:43.181 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 11:59:43.182 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 11:59:46.674 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 11:59:46.678 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:59:46.679 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:59:46.680 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 11:59:46.681 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 11:59:46.683 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 11:59:46.684 -03:00 [DBG] Start discovery request
2018-08-27 11:59:46.691 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 11:59:46.695 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 11:59:46.696 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 11:59:46.697 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 11:59:46.698 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 11:59:46.703 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 11:59:46.704 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 11:59:46.705 -03:00 [DBG] Start key discovery request
2018-08-27 11:59:46.710 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 11:59:46.712 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 11:59:46.713 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 11:59:46.714 -03:00 [DBG] Start authorize request
2018-08-27 11:59:46.715 -03:00 [DBG] No user present in authorize request
2018-08-27 11:59:46.716 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:59:46.722 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:59:46.724 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:59:46.726 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:59:46.728 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:59:46.729 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:59:46.730 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:59:46.731 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "1zVEuQYCks5XRi280YcXTnxZCDiadBlmiEL7Izw5",
  "Nonce": "1zVEuQYCks5XRi280YcXTnxZCDiadBlmiEL7Izw5",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "1zVEuQYCks5XRi280YcXTnxZCDiadBlmiEL7Izw5",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "1zVEuQYCks5XRi280YcXTnxZCDiadBlmiEL7Izw5"
  }
}
2018-08-27 11:59:46.733 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 11:59:46.735 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 11:59:46.741 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 11:59:46.743 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:59:46.745 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:59:46.747 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 11:59:46.748 -03:00 [DBG] Found [] API scopes in database
2018-08-27 11:59:46.749 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 11:59:46.755 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 12:37:59.042 -03:00 [INF] Clearing 0 tokens
2018-08-27 13:19:37.221 -03:00 [INF] AuthenticationScheme: Google was challenged.
2018-08-27 13:29:25.222 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 13:29:25.243 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 13:29:25.244 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 13:29:25.244 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 13:29:25.244 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 13:29:25.321 -03:00 [DBG] Starting token cleanup
2018-08-27 13:29:36.405 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 13:29:36.512 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 13:29:36.515 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 13:29:36.554 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 13:29:36.560 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 13:29:36.560 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 13:29:36.564 -03:00 [DBG] Start discovery request
2018-08-27 13:29:36.815 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 13:29:36.845 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 13:29:36.851 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 13:29:36.854 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 13:29:36.855 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 13:29:36.856 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 13:29:36.858 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 13:29:36.861 -03:00 [DBG] Start key discovery request
2018-08-27 13:29:36.902 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 13:29:36.908 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 13:29:36.910 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 13:29:36.914 -03:00 [DBG] Start authorize request
2018-08-27 13:29:36.922 -03:00 [DBG] No user present in authorize request
2018-08-27 13:29:36.925 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 13:29:37.079 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:29:37.110 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:37.136 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:37.146 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:37.148 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:37.154 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 13:29:37.162 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "qU3KLrFEQEJLyBm5Ahx9hfI3sNl1aj7SsmGwkxnY",
  "Nonce": "qU3KLrFEQEJLyBm5Ahx9hfI3sNl1aj7SsmGwkxnY",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "qU3KLrFEQEJLyBm5Ahx9hfI3sNl1aj7SsmGwkxnY",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "qU3KLrFEQEJLyBm5Ahx9hfI3sNl1aj7SsmGwkxnY"
  }
}
2018-08-27 13:29:37.173 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 13:29:37.271 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 13:29:37.278 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:29:37.281 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:37.282 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:37.285 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:37.287 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:37.288 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 13:29:37.296 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:29:39.389 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 13:29:40.678 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 13:29:40.858 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGC793KHKC0:00000006",
  "TimeStamp": "2018-08-27T16:29:40Z",
  "ProcessId": 20768,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 13:29:40.868 -03:00 [DBG] Augmenting SignInContext
2018-08-27 13:29:40.870 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 13:29:40.873 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 13:29:40.878 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 13:29:40.895 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 13:29:40.897 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 13:29:40.898 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 13:29:40.902 -03:00 [DBG] Start authorize callback request
2018-08-27 13:29:40.905 -03:00 [DBG] User in authorize request: 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 13:29:40.907 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 13:29:40.914 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:29:40.917 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:40.919 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:40.925 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:40.928 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:40.928 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 13:29:40.929 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "qU3KLrFEQEJLyBm5Ahx9hfI3sNl1aj7SsmGwkxnY",
  "Nonce": "qU3KLrFEQEJLyBm5Ahx9hfI3sNl1aj7SsmGwkxnY",
  "SessionId": "91bf1b6b8535d2ce04d99020bc8e539d",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "qU3KLrFEQEJLyBm5Ahx9hfI3sNl1aj7SsmGwkxnY",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "qU3KLrFEQEJLyBm5Ahx9hfI3sNl1aj7SsmGwkxnY"
  }
}
2018-08-27 13:29:40.972 -03:00 [DBG] BjCbRn2IsE6XiGcYLrF+YzLgsqxzSVmqBE0pjLJmOfc= found in database: false
2018-08-27 13:29:40.974 -03:00 [DBG] user_consent grant with value: UserManagementUI|7b3fb49d-352c-4234-8c74-d83db7ca3964 not found in store.
2018-08-27 13:29:40.975 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 13:29:40.976 -03:00 [INF] Showing consent: User has not yet consented
2018-08-27 13:29:40.998 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 13:29:41.009 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:29:41.011 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:41.012 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:41.014 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:41.015 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:41.016 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 13:29:41.024 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:29:41.026 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:41.027 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:43.219 -03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 13:29:43.253 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 13:29:43.261 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:29:43.263 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:43.265 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:43.266 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:43.268 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:43.269 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 13:29:43.282 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 13:29:43.283 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 13:29:43.285 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 13:29:43.287 -03:00 [DBG] Start authorize callback request
2018-08-27 13:29:43.290 -03:00 [DBG] User in authorize request: 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 13:29:43.292 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 13:29:43.298 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:29:43.303 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:43.306 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:43.309 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:43.311 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:43.313 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 13:29:43.314 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "qU3KLrFEQEJLyBm5Ahx9hfI3sNl1aj7SsmGwkxnY",
  "Nonce": "qU3KLrFEQEJLyBm5Ahx9hfI3sNl1aj7SsmGwkxnY",
  "SessionId": "91bf1b6b8535d2ce04d99020bc8e539d",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "qU3KLrFEQEJLyBm5Ahx9hfI3sNl1aj7SsmGwkxnY",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "qU3KLrFEQEJLyBm5Ahx9hfI3sNl1aj7SsmGwkxnY"
  }
}
2018-08-27 13:29:43.322 -03:00 [DBG] BjCbRn2IsE6XiGcYLrF+YzLgsqxzSVmqBE0pjLJmOfc= found in database: false
2018-08-27 13:29:43.323 -03:00 [DBG] user_consent grant with value: UserManagementUI|7b3fb49d-352c-4234-8c74-d83db7ca3964 not found in store.
2018-08-27 13:29:43.324 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 13:29:43.329 -03:00 [INF] User consented to scopes: ["openid","profile","email"]
2018-08-27 13:29:43.331 -03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email"]
2018-08-27 13:29:43.335 -03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 13:29:43.346 -03:00 [DBG] BjCbRn2IsE6XiGcYLrF+YzLgsqxzSVmqBE0pjLJmOfc= not found in database
2018-08-27 13:29:43.454 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 13:29:43.461 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 13:29:43.462 -03:00 [DBG] Getting claims for access token for subject: 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 13:29:43.499 -03:00 [DBG] BxXpNDBM/dS2LylhUwIjKbowFrwT7aCjyapBpHzNsb8= not found in database
2018-08-27 13:29:43.515 -03:00 [DBG] Getting claims for identity token for subject: 7b3fb49d-352c-4234-8c74-d83db7ca3964 and client: UserManagementUI
2018-08-27 13:29:43.516 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 13:29:43.563 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Melg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****afad"
    }
  ],
  "ActivityId": "0HLGC793KHKBV:00000006",
  "TimeStamp": "2018-08-27T16:29:43Z",
  "ProcessId": 20768,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 13:29:43.571 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "qU3KLrFEQEJLyBm5Ahx9hfI3sNl1aj7SsmGwkxnY",
  "Scope": "openid profile email"
}
2018-08-27 13:29:43.583 -03:00 [DBG] Augmenting SignInContext
2018-08-27 13:29:43.584 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 13:29:44.717 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 13:29:44.721 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 13:29:44.722 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 13:29:44.723 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 13:29:44.725 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 13:29:44.726 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 13:29:44.728 -03:00 [DBG] Start discovery request
2018-08-27 13:29:44.737 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 13:29:44.772 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 13:29:44.776 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 13:29:44.777 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 13:29:44.777 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 13:29:44.779 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 13:29:44.781 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 13:29:44.782 -03:00 [DBG] Start key discovery request
2018-08-27 13:29:48.454 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 13:29:48.458 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 13:29:48.459 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 13:29:48.464 -03:00 [DBG] Processing signout request for 7b3fb49d-352c-4234-8c74-d83db7ca3964
2018-08-27 13:29:48.474 -03:00 [DBG] Start end session request validation
2018-08-27 13:29:48.482 -03:00 [DBG] Start identity token validation
2018-08-27 13:29:48.501 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:29:48.503 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 13:29:48.537 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 13:29:48.542 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535387383,
    "exp": 1535387683,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "qU3KLrFEQEJLyBm5Ahx9hfI3sNl1aj7SsmGwkxnY",
    "iat": 1535387383,
    "at_hash": "bqOHjfhKectYGbgozJiLvA",
    "sid": "91bf1b6b8535d2ce04d99020bc8e539d",
    "sub": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
    "auth_time": 1535387380,
    "idp": "Facebook",
    "amr": "external"
  }
}
2018-08-27 13:29:48.549 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzODczODMsImV4cCI6MTUzNTM4NzY4MywiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoicVUzS0xyRkVRRUpMeUJtNUFoeDloZkkzc05sMWFqN1NzbUd3a3huWSIsImlhdCI6MTUzNTM4NzM4MywiYXRfaGFzaCI6ImJxT0hqZmhLZWN0WUdiZ296SmlMdkEiLCJzaWQiOiI5MWJmMWI2Yjg1MzVkMmNlMDRkOTkwMjBiYzhlNTM5ZCIsInN1YiI6IjdiM2ZiNDlkLTM1MmMtNDIzNC04Yzc0LWQ4M2RiN2NhMzk2NCIsImF1dGhfdGltZSI6MTUzNTM4NzM4MCwiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.eRquYRb5AUnWHFxL3QJOxCPfUYD6neyTKCpmjog-DS7WVXqsvuCczqY-4I4qcEm86vOHdcrfdaJSO8rk7XbwJcE7SJYmwaFfzZdLepxrGKTM_7xoQoTxx7V9pS0p9vSvdLDdccnDlDvFjGoYtHa1Sr_LYO-s8K5uJ6aPnY-LbSmrYcxL0_B7BINwvz_BvEqOz3Pee0t8-Sy7Ts7BWfv3QDpIDkwmUnWGa9Pe4pbcDuhX1X49ZxYWldX0wrF3v3OXBtYU0ce5KZ8vtNhVFvQBjEvXt-klSXwY4otwIuOkoyUS2yWDkhOn3zap_sH3HG41YqP2HRhHO76c_FF6MAMelg",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 13:29:48.553 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 13:29:48.589 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 13:29:48.592 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 13:29:48.593 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 13:29:48.597 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "7b3fb49d-352c-4234-8c74-d83db7ca3964",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGC793KHKBV:00000008",
  "TimeStamp": "2018-08-27T16:29:48Z",
  "ProcessId": 20768,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 13:29:48.765 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 13:29:48.769 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 13:29:48.771 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 13:29:48.775 -03:00 [DBG] Processing signout callback request
2018-08-27 13:29:48.794 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:29:48.795 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 13:29:48.796 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 13:29:48.796 -03:00 [INF] Successful signout callback.
2018-08-27 13:29:48.797 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 13:29:48.798 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 13:29:51.388 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 13:29:51.393 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 13:29:51.394 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 13:29:51.396 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 13:29:51.397 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 13:29:51.398 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 13:29:51.401 -03:00 [DBG] Start discovery request
2018-08-27 13:29:51.413 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 13:29:51.462 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 13:29:51.466 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 13:29:51.467 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 13:29:51.468 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 13:29:51.470 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 13:29:51.471 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 13:29:51.474 -03:00 [DBG] Start key discovery request
2018-08-27 13:29:51.507 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 13:29:51.511 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 13:29:51.512 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 13:29:51.514 -03:00 [DBG] Start authorize request
2018-08-27 13:29:51.515 -03:00 [DBG] No user present in authorize request
2018-08-27 13:29:51.516 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 13:29:51.528 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:29:51.531 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:51.534 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:51.538 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:51.542 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:51.542 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 13:29:51.543 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "WtxPVtjv0OeATGXFttVi0BOIAqkQDdNk56I9z11R",
  "Nonce": "WtxPVtjv0OeATGXFttVi0BOIAqkQDdNk56I9z11R",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "WtxPVtjv0OeATGXFttVi0BOIAqkQDdNk56I9z11R",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "WtxPVtjv0OeATGXFttVi0BOIAqkQDdNk56I9z11R"
  }
}
2018-08-27 13:29:51.546 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 13:29:51.557 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 13:29:51.564 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:29:51.566 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:51.570 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:51.573 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:29:51.578 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:29:51.578 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 13:29:51.589 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:29:52.898 -03:00 [INF] AuthenticationScheme: Google was challenged.
2018-08-27 13:30:02.850 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 13:30:03.026 -03:00 [INF] User created a new account with password.
2018-08-27 13:30:03.061 -03:00 [INF] User created a new account with password.
2018-08-27 13:30:03.173 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Google",
  "ProviderUserId": "100165260137603692915",
  "SubjectId": "d89fa705-5791-4bd1-a7fa-9ee57084bde7",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGC793KHKC0:0000000F",
  "TimeStamp": "2018-08-27T16:30:03Z",
  "ProcessId": 20768,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 13:30:03.175 -03:00 [DBG] Augmenting SignInContext
2018-08-27 13:30:03.176 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 13:30:03.176 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 13:30:03.177 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 13:30:03.181 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 13:30:03.182 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 13:30:03.183 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 13:30:03.184 -03:00 [DBG] Start authorize callback request
2018-08-27 13:30:03.188 -03:00 [DBG] User in authorize request: d89fa705-5791-4bd1-a7fa-9ee57084bde7
2018-08-27 13:30:03.189 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 13:30:03.195 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:30:03.198 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:30:03.199 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:30:03.201 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:30:03.204 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:30:03.206 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 13:30:03.207 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "d89fa705-5791-4bd1-a7fa-9ee57084bde7",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "WtxPVtjv0OeATGXFttVi0BOIAqkQDdNk56I9z11R",
  "Nonce": "WtxPVtjv0OeATGXFttVi0BOIAqkQDdNk56I9z11R",
  "SessionId": "c7978267f3c82ad7870db56cd99fbd3c",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "WtxPVtjv0OeATGXFttVi0BOIAqkQDdNk56I9z11R",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "WtxPVtjv0OeATGXFttVi0BOIAqkQDdNk56I9z11R"
  }
}
2018-08-27 13:30:03.214 -03:00 [DBG] Zh0xtvsJeztb3IMeQ691HeMRxIGotFBUB2cHshCaWQg= found in database: false
2018-08-27 13:30:03.217 -03:00 [DBG] user_consent grant with value: UserManagementUI|d89fa705-5791-4bd1-a7fa-9ee57084bde7 not found in store.
2018-08-27 13:30:03.218 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 13:30:03.220 -03:00 [INF] Showing consent: User has not yet consented
2018-08-27 13:30:03.223 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 13:30:03.230 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:30:03.232 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:30:03.234 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:30:03.237 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:30:03.239 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:30:03.239 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 13:30:03.246 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:30:03.248 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:30:03.250 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:30:05.501 -03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 13:30:05.505 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 13:30:05.517 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:30:05.521 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:30:05.523 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:30:05.526 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:30:05.528 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:30:05.529 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 13:30:05.533 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 13:30:05.534 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 13:30:05.535 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 13:30:05.537 -03:00 [DBG] Start authorize callback request
2018-08-27 13:30:05.540 -03:00 [DBG] User in authorize request: d89fa705-5791-4bd1-a7fa-9ee57084bde7
2018-08-27 13:30:05.541 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 13:30:05.551 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:30:05.555 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:30:05.557 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:30:05.560 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:30:05.562 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:30:05.563 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 13:30:05.564 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "d89fa705-5791-4bd1-a7fa-9ee57084bde7",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "WtxPVtjv0OeATGXFttVi0BOIAqkQDdNk56I9z11R",
  "Nonce": "WtxPVtjv0OeATGXFttVi0BOIAqkQDdNk56I9z11R",
  "SessionId": "c7978267f3c82ad7870db56cd99fbd3c",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "WtxPVtjv0OeATGXFttVi0BOIAqkQDdNk56I9z11R",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "WtxPVtjv0OeATGXFttVi0BOIAqkQDdNk56I9z11R"
  }
}
2018-08-27 13:30:05.572 -03:00 [DBG] Zh0xtvsJeztb3IMeQ691HeMRxIGotFBUB2cHshCaWQg= found in database: false
2018-08-27 13:30:05.574 -03:00 [DBG] user_consent grant with value: UserManagementUI|d89fa705-5791-4bd1-a7fa-9ee57084bde7 not found in store.
2018-08-27 13:30:05.575 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 13:30:05.575 -03:00 [INF] User consented to scopes: ["openid","profile","email"]
2018-08-27 13:30:05.576 -03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email"]
2018-08-27 13:30:05.577 -03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: d89fa705-5791-4bd1-a7fa-9ee57084bde7
2018-08-27 13:30:05.580 -03:00 [DBG] Zh0xtvsJeztb3IMeQ691HeMRxIGotFBUB2cHshCaWQg= not found in database
2018-08-27 13:30:05.588 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 13:30:05.588 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 13:30:05.589 -03:00 [DBG] Getting claims for access token for subject: d89fa705-5791-4bd1-a7fa-9ee57084bde7
2018-08-27 13:30:05.598 -03:00 [DBG] oFLK18IJoaRmqte/b10sXSKw3L7JSC1UH5l32jkzTDM= not found in database
2018-08-27 13:30:05.603 -03:00 [DBG] Getting claims for identity token for subject: d89fa705-5791-4bd1-a7fa-9ee57084bde7 and client: UserManagementUI
2018-08-27 13:30:05.605 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 13:30:05.608 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "d89fa705-5791-4bd1-a7fa-9ee57084bde7",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****AmUw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****31d3"
    }
  ],
  "ActivityId": "0HLGC793KHKBT:0000000D",
  "TimeStamp": "2018-08-27T16:30:05Z",
  "ProcessId": 20768,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 13:30:05.611 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "d89fa705-5791-4bd1-a7fa-9ee57084bde7",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "WtxPVtjv0OeATGXFttVi0BOIAqkQDdNk56I9z11R",
  "Scope": "openid profile email"
}
2018-08-27 13:30:05.614 -03:00 [DBG] Augmenting SignInContext
2018-08-27 13:30:05.614 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 13:30:07.051 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 13:30:07.054 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 13:30:07.055 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 13:30:07.056 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 13:30:07.058 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 13:30:07.059 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 13:30:07.061 -03:00 [DBG] Start discovery request
2018-08-27 13:30:07.068 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 13:30:07.107 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 13:30:07.109 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 13:30:07.110 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 13:30:07.111 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 13:30:07.113 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 13:30:07.114 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 13:30:07.115 -03:00 [DBG] Start key discovery request
2018-08-27 13:30:18.388 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 13:30:18.390 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 13:30:18.393 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 13:30:18.395 -03:00 [DBG] Processing signout request for d89fa705-5791-4bd1-a7fa-9ee57084bde7
2018-08-27 13:30:18.397 -03:00 [DBG] Start end session request validation
2018-08-27 13:30:18.399 -03:00 [DBG] Start identity token validation
2018-08-27 13:30:18.417 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:30:18.418 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 13:30:18.428 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 13:30:18.429 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535387405,
    "exp": 1535387705,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "WtxPVtjv0OeATGXFttVi0BOIAqkQDdNk56I9z11R",
    "iat": 1535387405,
    "at_hash": "968eINYmyRZ9MkVXVJnk-A",
    "sid": "c7978267f3c82ad7870db56cd99fbd3c",
    "sub": "d89fa705-5791-4bd1-a7fa-9ee57084bde7",
    "auth_time": 1535387403,
    "idp": "Google",
    "amr": "external"
  }
}
2018-08-27 13:30:18.431 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "d89fa705-5791-4bd1-a7fa-9ee57084bde7",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzODc0MDUsImV4cCI6MTUzNTM4NzcwNSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiV3R4UFZ0anYwT2VBVEdYRnR0VmkwQk9JQXFrUURkTms1Nkk5ejExUiIsImlhdCI6MTUzNTM4NzQwNSwiYXRfaGFzaCI6Ijk2OGVJTllteVJaOU1rVlhWSm5rLUEiLCJzaWQiOiJjNzk3ODI2N2YzYzgyYWQ3ODcwZGI1NmNkOTlmYmQzYyIsInN1YiI6ImQ4OWZhNzA1LTU3OTEtNGJkMS1hN2ZhLTllZTU3MDg0YmRlNyIsImF1dGhfdGltZSI6MTUzNTM4NzQwMywiaWRwIjoiR29vZ2xlIiwiYW1yIjpbImV4dGVybmFsIl19.D5jEAEkmWhkF_kymy4fcq_RLTc3CoPWM7MpmE_LuqKEFVNbt5nH4UsxFp2Ik2NR2l_FFTmbyLadvDAW9pzvNavUAtf9cUQ84aKxkazuu0iV08q43P8-YP1auIcsIqWBHtxS1z0SPsSyhKENvi4yV6BggPpe1AO2avIBZ-T8B6VN2MMHxQtXjbw5eJI5Un51ryr4-7Ir0iDA3bLGQMFAgb2HYh5NNNkK7xvi1h2_NO39FmY_fUncM1MchoioJz4qFDv7LA0xtZ2LgN3yykZLBpfp8NtCIgiYi3MXGdtItkSA8NFplSv55GTvgmGId6T4dWfrnLLymEzBg2nmqixAmUw",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 13:30:18.433 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 13:30:18.439 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 13:30:18.441 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 13:30:18.442 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 13:30:18.444 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "d89fa705-5791-4bd1-a7fa-9ee57084bde7",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGC793KHKBT:0000000F",
  "TimeStamp": "2018-08-27T16:30:18Z",
  "ProcessId": 20768,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 13:30:18.631 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 13:30:18.632 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 13:30:18.634 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 13:30:18.636 -03:00 [DBG] Processing signout callback request
2018-08-27 13:30:18.647 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:30:18.648 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 13:30:18.650 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 13:30:18.651 -03:00 [INF] Successful signout callback.
2018-08-27 13:30:18.652 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 13:30:18.659 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 13:30:21.444 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 13:30:21.447 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 13:30:21.449 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 13:30:21.450 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 13:30:21.452 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 13:30:21.454 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 13:30:21.458 -03:00 [DBG] Start discovery request
2018-08-27 13:30:21.468 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 13:30:21.514 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 13:30:21.517 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 13:30:21.520 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 13:30:21.521 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 13:30:21.522 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 13:30:21.523 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 13:30:21.528 -03:00 [DBG] Start key discovery request
2018-08-27 13:30:21.565 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 13:30:21.568 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 13:30:21.569 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 13:30:21.570 -03:00 [DBG] Start authorize request
2018-08-27 13:30:21.571 -03:00 [DBG] No user present in authorize request
2018-08-27 13:30:21.572 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 13:30:21.580 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:30:21.582 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:30:21.584 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:30:21.587 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:30:21.590 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:30:21.591 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 13:30:21.592 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "G47mapCzTPEIeYL1JPJr9zYK0ecfLiGZwos59GKI",
  "Nonce": "G47mapCzTPEIeYL1JPJr9zYK0ecfLiGZwos59GKI",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "G47mapCzTPEIeYL1JPJr9zYK0ecfLiGZwos59GKI",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "G47mapCzTPEIeYL1JPJr9zYK0ecfLiGZwos59GKI"
  }
}
2018-08-27 13:30:21.594 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 13:30:21.598 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 13:30:21.608 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:30:21.611 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:30:21.612 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:30:21.614 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:30:21.616 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:30:21.617 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 13:30:21.626 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:38:50.900 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 13:38:50.939 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 13:38:50.941 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:38:50.944 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:38:50.946 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 13:38:50.948 -03:00 [DBG] Found [] API scopes in database
2018-08-27 13:38:50.948 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 13:38:50.955 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 14:02:57.248 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 14:02:57.269 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 14:02:57.270 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 14:02:57.270 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 14:02:57.271 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 14:02:57.349 -03:00 [DBG] Starting token cleanup
2018-08-27 14:09:02.376 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 14:09:02.397 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 14:09:02.398 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 14:09:02.398 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 14:09:02.399 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 14:09:02.472 -03:00 [DBG] Starting token cleanup
2018-08-27 14:34:46.122 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 14:34:46.253 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 14:34:46.256 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 14:34:46.299 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 14:34:46.318 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 14:34:46.319 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 14:34:46.323 -03:00 [DBG] Start discovery request
2018-08-27 14:34:46.587 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 14:34:46.621 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 14:34:46.626 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 14:34:46.626 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 14:34:46.628 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 14:34:46.630 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 14:34:46.632 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 14:34:46.635 -03:00 [DBG] Start key discovery request
2018-08-27 14:34:46.689 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 14:34:46.693 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 14:34:46.694 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 14:34:46.697 -03:00 [DBG] Start authorize request
2018-08-27 14:34:46.704 -03:00 [DBG] No user present in authorize request
2018-08-27 14:34:46.707 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 14:34:46.863 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 14:34:46.894 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 14:34:46.918 -03:00 [DBG] Found [] API scopes in database
2018-08-27 14:34:46.927 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 14:34:46.930 -03:00 [DBG] Found [] API scopes in database
2018-08-27 14:34:46.936 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 14:34:46.943 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "D19FeHJeQwpa2gpvLYROymPctla9jf9Ie5BtxVPO",
  "Nonce": "D19FeHJeQwpa2gpvLYROymPctla9jf9Ie5BtxVPO",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "D19FeHJeQwpa2gpvLYROymPctla9jf9Ie5BtxVPO",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "D19FeHJeQwpa2gpvLYROymPctla9jf9Ie5BtxVPO"
  }
}
2018-08-27 14:34:46.951 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 14:34:47.059 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 14:34:47.067 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 14:34:47.073 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 14:34:47.075 -03:00 [DBG] Found [] API scopes in database
2018-08-27 14:34:47.077 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 14:34:47.079 -03:00 [DBG] Found [] API scopes in database
2018-08-27 14:34:47.080 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 14:34:47.089 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 15:13:23.322 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 15:13:23.343 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 15:13:23.343 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 15:13:23.343 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 15:13:23.344 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 15:13:23.412 -03:00 [DBG] Starting token cleanup
2018-08-27 15:14:27.675 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 15:14:27.697 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 15:14:27.697 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 15:14:27.697 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 15:14:27.697 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 15:14:27.768 -03:00 [DBG] Starting token cleanup
2018-08-27 15:15:22.826 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 15:15:22.849 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 15:15:22.849 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 15:15:22.849 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 15:15:22.850 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 15:15:22.920 -03:00 [DBG] Starting token cleanup
2018-08-27 15:15:59.072 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 15:15:59.093 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 15:15:59.093 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 15:15:59.093 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 15:15:59.093 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 15:15:59.163 -03:00 [DBG] Starting token cleanup
2018-08-27 15:17:11.755 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 15:17:11.867 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 15:17:11.870 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 15:17:11.912 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 15:17:11.929 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 15:17:11.931 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 15:17:11.935 -03:00 [DBG] Start discovery request
2018-08-27 15:17:12.201 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 15:17:12.234 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 15:17:12.244 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 15:17:12.246 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 15:17:12.248 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 15:17:12.256 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 15:17:12.256 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 15:17:12.260 -03:00 [DBG] Start key discovery request
2018-08-27 15:17:12.301 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 15:17:12.306 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 15:17:12.307 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 15:17:12.310 -03:00 [DBG] Start authorize request
2018-08-27 15:17:12.319 -03:00 [DBG] No user present in authorize request
2018-08-27 15:17:12.322 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 15:17:12.484 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 15:17:12.514 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 15:17:12.543 -03:00 [DBG] Found [] API scopes in database
2018-08-27 15:17:12.552 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 15:17:12.554 -03:00 [DBG] Found [] API scopes in database
2018-08-27 15:17:12.559 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 15:17:12.567 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "rCynYdiopkpxVJBp8ZpQeevUbnzKnpxVjXEYWhIo",
  "Nonce": "rCynYdiopkpxVJBp8ZpQeevUbnzKnpxVjXEYWhIo",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "rCynYdiopkpxVJBp8ZpQeevUbnzKnpxVjXEYWhIo",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "rCynYdiopkpxVJBp8ZpQeevUbnzKnpxVjXEYWhIo"
  }
}
2018-08-27 15:17:12.575 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 15:17:12.677 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 15:17:12.685 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 15:17:12.687 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 15:17:12.689 -03:00 [DBG] Found [] API scopes in database
2018-08-27 15:17:12.691 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 15:17:12.692 -03:00 [DBG] Found [] API scopes in database
2018-08-27 15:17:12.693 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 15:17:12.702 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 15:51:35.952 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 15:51:35.974 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 15:51:35.974 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 15:51:35.974 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 15:51:35.974 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 15:51:36.049 -03:00 [DBG] Starting token cleanup
2018-08-27 15:53:54.915 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 15:53:54.936 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 15:53:54.936 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 15:53:54.936 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 15:53:54.937 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 15:53:55.008 -03:00 [DBG] Starting token cleanup
2018-08-27 15:54:50.944 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 15:54:50.965 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 15:54:50.966 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 15:54:50.966 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 15:54:50.966 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 15:54:51.034 -03:00 [DBG] Starting token cleanup
2018-08-27 15:56:58.079 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 15:56:58.101 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 15:56:58.101 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 15:56:58.102 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 15:56:58.102 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 15:56:58.179 -03:00 [DBG] Starting token cleanup
2018-08-27 15:57:22.623 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 15:57:22.644 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 15:57:22.645 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 15:57:22.645 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 15:57:22.645 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 15:57:22.717 -03:00 [DBG] Starting token cleanup
2018-08-27 16:06:17.529 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 16:06:17.671 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:06:17.675 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:06:17.718 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 16:06:17.728 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 16:06:17.730 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 16:06:17.733 -03:00 [DBG] Start discovery request
2018-08-27 16:06:18.004 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 16:06:18.036 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 16:06:18.044 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:06:18.045 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:06:18.051 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 16:06:18.056 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 16:06:18.057 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 16:06:18.060 -03:00 [DBG] Start key discovery request
2018-08-27 16:06:18.099 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 16:06:18.103 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 16:06:18.104 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 16:06:18.108 -03:00 [DBG] Start authorize request
2018-08-27 16:06:18.115 -03:00 [DBG] No user present in authorize request
2018-08-27 16:06:18.119 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:06:18.271 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:06:18.305 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:06:18.330 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:06:18.339 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:06:18.342 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:06:18.347 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:06:18.355 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "KouIUNeViM29I1oW28HqwcDrllcYFT335PGIZkI1",
  "Nonce": "KouIUNeViM29I1oW28HqwcDrllcYFT335PGIZkI1",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "KouIUNeViM29I1oW28HqwcDrllcYFT335PGIZkI1",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "KouIUNeViM29I1oW28HqwcDrllcYFT335PGIZkI1"
  }
}
2018-08-27 16:06:18.365 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 16:06:18.470 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:06:18.477 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:06:18.479 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:06:18.481 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:06:18.483 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:06:18.485 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:06:18.485 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:06:18.494 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:06:28.263 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:06:28.270 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:06:28.274 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:06:28.277 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:06:28.279 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:06:28.281 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:06:28.283 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:06:28.292 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:08:41.630 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 16:08:41.652 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 16:08:41.652 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 16:08:41.652 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 16:08:41.652 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 16:08:41.728 -03:00 [DBG] Starting token cleanup
2018-08-27 16:08:55.442 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:08:55.818 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:08:55.870 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:08:55.925 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:08:55.937 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:08:55.940 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:08:55.946 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:08:55.960 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:11:08.583 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 16:11:08.605 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 16:11:08.605 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 16:11:08.605 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 16:11:08.605 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 16:11:08.676 -03:00 [DBG] Starting token cleanup
2018-08-27 16:11:15.463 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 16:11:15.559 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:11:15.565 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:11:15.606 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 16:11:15.612 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 16:11:15.613 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 16:11:15.617 -03:00 [DBG] Start discovery request
2018-08-27 16:11:15.851 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 16:11:15.888 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 16:11:15.895 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:11:15.896 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:11:15.898 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 16:11:15.903 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 16:11:15.905 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 16:11:15.908 -03:00 [DBG] Start key discovery request
2018-08-27 16:11:15.943 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 16:11:15.947 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 16:11:15.948 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 16:11:15.951 -03:00 [DBG] Start authorize request
2018-08-27 16:11:15.958 -03:00 [DBG] No user present in authorize request
2018-08-27 16:11:15.961 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:11:16.122 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:11:16.163 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:11:16.192 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:11:16.201 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:11:16.203 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:11:16.210 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:11:16.218 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "hBYpFn4ER0wkQTIpaNhfimjqHJ4g7bOG0mwULpdk",
  "Nonce": "hBYpFn4ER0wkQTIpaNhfimjqHJ4g7bOG0mwULpdk",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "hBYpFn4ER0wkQTIpaNhfimjqHJ4g7bOG0mwULpdk",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "hBYpFn4ER0wkQTIpaNhfimjqHJ4g7bOG0mwULpdk"
  }
}
2018-08-27 16:11:16.229 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 16:11:16.319 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:11:16.326 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:11:16.328 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:11:16.330 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:11:16.333 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:11:16.335 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:11:16.335 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:11:16.344 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:11:19.835 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 16:11:20.699 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 16:11:20.868 -03:00 [INF] Provider Facebook associated.
2018-08-27 16:11:21.029 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "b705d555-3adb-4cfd-9b37-861702faba83",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGCA3E61U6K:00000005",
  "TimeStamp": "2018-08-27T19:11:21Z",
  "ProcessId": 30964,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 16:11:21.038 -03:00 [DBG] Augmenting SignInContext
2018-08-27 16:11:21.042 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 16:11:21.046 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 16:11:21.051 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 16:11:21.068 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 16:11:21.070 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 16:11:21.071 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 16:11:21.076 -03:00 [DBG] Start authorize callback request
2018-08-27 16:11:21.079 -03:00 [DBG] User in authorize request: b705d555-3adb-4cfd-9b37-861702faba83
2018-08-27 16:11:21.080 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:11:21.088 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:11:21.090 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:11:21.094 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:11:21.096 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:11:21.099 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:11:21.099 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:11:21.100 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "b705d555-3adb-4cfd-9b37-861702faba83",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "hBYpFn4ER0wkQTIpaNhfimjqHJ4g7bOG0mwULpdk",
  "Nonce": "hBYpFn4ER0wkQTIpaNhfimjqHJ4g7bOG0mwULpdk",
  "SessionId": "6aeb34d6fdd6b132f14f9c9bd8405793",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "hBYpFn4ER0wkQTIpaNhfimjqHJ4g7bOG0mwULpdk",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "hBYpFn4ER0wkQTIpaNhfimjqHJ4g7bOG0mwULpdk"
  }
}
2018-08-27 16:11:21.144 -03:00 [DBG] IGee+XC5sjVMMWeAHNQd4akQJfKzIK4I9mi+BfyajYc= found in database: false
2018-08-27 16:11:21.146 -03:00 [DBG] user_consent grant with value: UserManagementUI|b705d555-3adb-4cfd-9b37-861702faba83 not found in store.
2018-08-27 16:11:21.147 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 16:11:21.148 -03:00 [INF] Showing consent: User has not yet consented
2018-08-27 16:11:21.172 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:11:21.182 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:11:21.185 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:11:21.194 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:11:21.197 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:11:21.199 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:11:21.200 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:11:21.212 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:11:21.215 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:11:21.217 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:11:58.259 -03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 16:11:58.302 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 16:11:58.304 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 16:11:58.305 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 16:11:58.309 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "b705d555-3adb-4cfd-9b37-861702faba83",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGCA3E61U6K:00000010",
  "TimeStamp": "2018-08-27T19:11:58Z",
  "ProcessId": 30964,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 16:12:33.844 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 16:12:33.865 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 16:12:33.865 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 16:12:33.865 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 16:12:33.865 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 16:12:33.937 -03:00 [DBG] Starting token cleanup
2018-08-27 16:12:37.788 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 16:12:37.908 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:12:37.912 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:12:37.952 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 16:12:37.958 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 16:12:37.959 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 16:12:37.962 -03:00 [DBG] Start discovery request
2018-08-27 16:12:38.185 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 16:12:38.218 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 16:12:38.222 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:12:38.222 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:12:38.224 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 16:12:38.227 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 16:12:38.232 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 16:12:38.238 -03:00 [DBG] Start key discovery request
2018-08-27 16:12:38.279 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 16:12:38.287 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 16:12:38.288 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 16:12:38.292 -03:00 [DBG] Start authorize request
2018-08-27 16:12:38.299 -03:00 [DBG] No user present in authorize request
2018-08-27 16:12:38.302 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:12:38.456 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:12:38.493 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:12:38.519 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:12:38.539 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:12:38.542 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:12:38.547 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:12:38.555 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "3GydvoYmkDVVkDxjfSAkzZ3QlV0K6JMlPK7ZFbKO",
  "Nonce": "3GydvoYmkDVVkDxjfSAkzZ3QlV0K6JMlPK7ZFbKO",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "3GydvoYmkDVVkDxjfSAkzZ3QlV0K6JMlPK7ZFbKO",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "3GydvoYmkDVVkDxjfSAkzZ3QlV0K6JMlPK7ZFbKO"
  }
}
2018-08-27 16:12:38.568 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 16:12:38.660 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:12:38.666 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:12:38.668 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:12:38.670 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:12:38.672 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:12:38.674 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:12:38.675 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:12:38.683 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:12:43.494 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 16:12:44.234 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 16:14:20.433 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 16:14:20.454 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 16:14:20.454 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 16:14:20.455 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 16:14:20.455 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 16:14:20.524 -03:00 [DBG] Starting token cleanup
2018-08-27 16:14:45.089 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 16:14:45.110 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 16:14:45.110 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 16:14:45.111 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 16:14:45.111 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 16:14:45.181 -03:00 [DBG] Starting token cleanup
2018-08-27 16:14:53.050 -03:00 [ERR] An unhandled exception has occurred while executing the request.
System.OperationCanceledException: The operation was canceled.
   at System.Threading.CancellationToken.ThrowOperationCanceledException()
   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore`9.FindByLoginAsync(String loginProvider, String providerKey, CancellationToken cancellationToken)
   at Equinox.UI.SSO.Controllers.Account.AccountController.FindUserFromExternalProviderAsync(AuthenticateResult result) in D:\workspace\JpProject\src\Frontend\Equinox.UI.SSO\Controllers\Account\AccountController.cs:line 496
   at Equinox.UI.SSO.Controllers.Account.AccountController.ExternalLoginCallback() in D:\workspace\JpProject\src\Frontend\Equinox.UI.SSO\Controllers\Account\AccountController.cs:line 207
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2018-08-27 16:14:54.325 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 16:14:54.435 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:14:54.439 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:14:54.441 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 16:14:54.446 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 16:14:54.447 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 16:14:54.450 -03:00 [DBG] Start discovery request
2018-08-27 16:14:54.706 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 16:14:54.733 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 16:14:54.736 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:14:54.738 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:14:54.740 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 16:14:54.742 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 16:14:54.744 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 16:14:54.748 -03:00 [DBG] Start key discovery request
2018-08-27 16:14:54.778 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 16:14:54.783 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 16:14:54.783 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 16:14:54.787 -03:00 [DBG] Start authorize request
2018-08-27 16:14:54.793 -03:00 [DBG] No user present in authorize request
2018-08-27 16:14:54.798 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:14:54.961 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:14:54.999 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:14:55.026 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:14:55.034 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:14:55.037 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:14:55.042 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:14:55.051 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "N4WJe2X8AuqoBI8ZSeDB6riPcQBPAzpEGuVsJnmU",
  "Nonce": "N4WJe2X8AuqoBI8ZSeDB6riPcQBPAzpEGuVsJnmU",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "N4WJe2X8AuqoBI8ZSeDB6riPcQBPAzpEGuVsJnmU",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "N4WJe2X8AuqoBI8ZSeDB6riPcQBPAzpEGuVsJnmU"
  }
}
2018-08-27 16:14:55.062 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 16:14:55.101 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:14:55.109 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:14:55.112 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:14:55.114 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:14:55.116 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:14:55.117 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:14:55.118 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:14:55.126 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:15:02.263 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 16:15:03.123 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 16:15:37.098 -03:00 [INF] Provider Facebook associated.
2018-08-27 16:15:40.424 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGCA5EVEAE7:00000008",
  "TimeStamp": "2018-08-27T19:15:40Z",
  "ProcessId": 29796,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 16:15:40.435 -03:00 [DBG] Augmenting SignInContext
2018-08-27 16:15:40.437 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 16:15:40.441 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 16:15:40.445 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 16:15:40.463 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 16:15:40.465 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 16:15:40.466 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 16:15:40.470 -03:00 [DBG] Start authorize callback request
2018-08-27 16:15:40.472 -03:00 [DBG] User in authorize request: 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 16:15:40.473 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:15:40.484 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:15:40.486 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:15:40.488 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:15:40.490 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:15:40.492 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:15:40.494 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:15:40.495 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "N4WJe2X8AuqoBI8ZSeDB6riPcQBPAzpEGuVsJnmU",
  "Nonce": "N4WJe2X8AuqoBI8ZSeDB6riPcQBPAzpEGuVsJnmU",
  "SessionId": "b1d8a07daaa7bfa23a2bd0201bf3160c",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "N4WJe2X8AuqoBI8ZSeDB6riPcQBPAzpEGuVsJnmU",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "N4WJe2X8AuqoBI8ZSeDB6riPcQBPAzpEGuVsJnmU"
  }
}
2018-08-27 16:15:40.534 -03:00 [DBG] yCTQeKD0JfQrTvLr+4TZa3gAId8q725c47uE670gM3Q= found in database: false
2018-08-27 16:15:40.536 -03:00 [DBG] user_consent grant with value: UserManagementUI|68202b22-d09d-442c-8bb2-325d922ed55c not found in store.
2018-08-27 16:15:40.537 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 16:15:40.537 -03:00 [INF] Showing consent: User has not yet consented
2018-08-27 16:15:40.561 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:15:40.570 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:15:40.574 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:15:40.577 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:15:40.580 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:15:40.581 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:15:40.582 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:15:40.587 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:15:40.589 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:15:40.591 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:15:46.504 -03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 16:15:46.536 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:15:46.544 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:15:46.548 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:15:46.550 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:15:46.552 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:15:46.553 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:15:46.554 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:15:46.569 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 16:15:46.571 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 16:15:46.572 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 16:15:46.573 -03:00 [DBG] Start authorize callback request
2018-08-27 16:15:46.580 -03:00 [DBG] User in authorize request: 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 16:15:46.581 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:15:46.589 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:15:46.592 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:15:46.594 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:15:46.598 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:15:46.600 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:15:46.601 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:15:46.602 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "N4WJe2X8AuqoBI8ZSeDB6riPcQBPAzpEGuVsJnmU",
  "Nonce": "N4WJe2X8AuqoBI8ZSeDB6riPcQBPAzpEGuVsJnmU",
  "SessionId": "b1d8a07daaa7bfa23a2bd0201bf3160c",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "N4WJe2X8AuqoBI8ZSeDB6riPcQBPAzpEGuVsJnmU",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "N4WJe2X8AuqoBI8ZSeDB6riPcQBPAzpEGuVsJnmU"
  }
}
2018-08-27 16:15:46.609 -03:00 [DBG] yCTQeKD0JfQrTvLr+4TZa3gAId8q725c47uE670gM3Q= found in database: false
2018-08-27 16:15:46.610 -03:00 [DBG] user_consent grant with value: UserManagementUI|68202b22-d09d-442c-8bb2-325d922ed55c not found in store.
2018-08-27 16:15:46.611 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 16:15:46.615 -03:00 [INF] User consented to scopes: ["openid","profile","email"]
2018-08-27 16:15:46.617 -03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email"]
2018-08-27 16:15:46.620 -03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 16:15:46.635 -03:00 [DBG] yCTQeKD0JfQrTvLr+4TZa3gAId8q725c47uE670gM3Q= not found in database
2018-08-27 16:15:46.665 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 16:15:46.673 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 16:15:46.673 -03:00 [DBG] Getting claims for access token for subject: 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 16:15:46.702 -03:00 [DBG] IhITqDWfNOOj1irWZCIC09GmjqQMambpaQtfkokBkZg= not found in database
2018-08-27 16:15:46.715 -03:00 [DBG] Getting claims for identity token for subject: 68202b22-d09d-442c-8bb2-325d922ed55c and client: UserManagementUI
2018-08-27 16:15:46.716 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 16:15:46.765 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****vrWA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****2bfe"
    }
  ],
  "ActivityId": "0HLGCA5EVEAE9:00000005",
  "TimeStamp": "2018-08-27T19:15:46Z",
  "ProcessId": 29796,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 16:15:46.771 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "N4WJe2X8AuqoBI8ZSeDB6riPcQBPAzpEGuVsJnmU",
  "Scope": "openid profile email"
}
2018-08-27 16:15:46.785 -03:00 [DBG] Augmenting SignInContext
2018-08-27 16:15:46.786 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 16:15:48.282 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 16:15:48.288 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:15:48.288 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:15:48.290 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 16:15:48.292 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 16:15:48.294 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 16:15:48.297 -03:00 [DBG] Start discovery request
2018-08-27 16:15:48.306 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 16:15:48.332 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 16:15:48.335 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:15:48.336 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:15:48.337 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 16:15:48.339 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 16:15:48.340 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 16:15:48.344 -03:00 [DBG] Start key discovery request
2018-08-27 16:16:13.659 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 16:16:13.664 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 16:16:13.666 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 16:16:13.669 -03:00 [DBG] Processing signout request for 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 16:16:13.674 -03:00 [DBG] Start end session request validation
2018-08-27 16:16:13.680 -03:00 [DBG] Start identity token validation
2018-08-27 16:16:13.695 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:16:13.696 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 16:16:13.734 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 16:16:13.737 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535397346,
    "exp": 1535397646,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "N4WJe2X8AuqoBI8ZSeDB6riPcQBPAzpEGuVsJnmU",
    "iat": 1535397346,
    "at_hash": "bMVC1luBdRHuB7E9wU6FZA",
    "sid": "b1d8a07daaa7bfa23a2bd0201bf3160c",
    "sub": "68202b22-d09d-442c-8bb2-325d922ed55c",
    "auth_time": 1535397340,
    "idp": "Facebook",
    "amr": "external"
  }
}
2018-08-27 16:16:13.743 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzOTczNDYsImV4cCI6MTUzNTM5NzY0NiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiTjRXSmUyWDhBdXFvQkk4WlNlREI2cmlQY1FCUEF6cEVHdVZzSm5tVSIsImlhdCI6MTUzNTM5NzM0NiwiYXRfaGFzaCI6ImJNVkMxbHVCZFJIdUI3RTl3VTZGWkEiLCJzaWQiOiJiMWQ4YTA3ZGFhYTdiZmEyM2EyYmQwMjAxYmYzMTYwYyIsInN1YiI6IjY4MjAyYjIyLWQwOWQtNDQyYy04YmIyLTMyNWQ5MjJlZDU1YyIsImF1dGhfdGltZSI6MTUzNTM5NzM0MCwiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.SL3ApsUUb_OXpMLiRGDlkYPqDGHshwY7OolElo9i23jG72bEgzanyzuslwJpySPxX7VihzXkLkz2-MT-xFzo43W6pr4yTg9NYXQdc7Psc9-FajrsuwWAaK5L05EH1jMumhkf73Qf8jiB2Pb6vMlC2WPe6KRY2GHyVWHzQ8Zo2RxR9a31LCmJgOILyqd5qzDurFAMrR5vCxirfY1uNmGGo3_qrNdIBip-idJ99kFC9ZD3c7G31k0cOlyD1mhObVRFQ6KjSFsZurEyHKeiQ1rJu1yEVtCj-JfvEmafzW14TrvizUFI3Ou-cK2j-mheUNgYQmfhRhKUA7tU1d35S-vrWA",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 16:16:13.749 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 16:16:13.783 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 16:16:13.785 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 16:16:13.786 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 16:16:13.789 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGCA5EVEAE9:00000007",
  "TimeStamp": "2018-08-27T19:16:13Z",
  "ProcessId": 29796,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 16:16:13.967 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 16:16:13.971 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 16:16:13.972 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 16:16:13.978 -03:00 [DBG] Processing signout callback request
2018-08-27 16:16:13.995 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:16:13.996 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 16:16:13.997 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 16:16:13.997 -03:00 [INF] Successful signout callback.
2018-08-27 16:16:13.999 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 16:16:14.000 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 16:16:17.074 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 16:16:17.077 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:16:17.078 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:16:17.080 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 16:16:17.081 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 16:16:17.083 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 16:16:17.086 -03:00 [DBG] Start discovery request
2018-08-27 16:16:17.094 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 16:16:17.103 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 16:16:17.106 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:16:17.107 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:16:17.109 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 16:16:17.110 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 16:16:17.112 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 16:16:17.115 -03:00 [DBG] Start key discovery request
2018-08-27 16:16:17.186 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 16:16:17.188 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 16:16:17.189 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 16:16:17.190 -03:00 [DBG] Start authorize request
2018-08-27 16:16:17.191 -03:00 [DBG] No user present in authorize request
2018-08-27 16:16:17.191 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:16:17.203 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:16:17.206 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:16:17.208 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:16:17.211 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:16:17.215 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:16:17.216 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:16:17.218 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "pC6wQjqNsOgblEfoYjPFBbQ4A7G7avZ9UUZf0Pul",
  "Nonce": "pC6wQjqNsOgblEfoYjPFBbQ4A7G7avZ9UUZf0Pul",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "pC6wQjqNsOgblEfoYjPFBbQ4A7G7avZ9UUZf0Pul",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "pC6wQjqNsOgblEfoYjPFBbQ4A7G7avZ9UUZf0Pul"
  }
}
2018-08-27 16:16:17.221 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 16:16:17.227 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:16:17.237 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:16:17.240 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:16:17.242 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:16:17.245 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:16:17.248 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:16:17.249 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:16:17.255 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:35:15.196 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 16:35:15.217 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 16:35:15.217 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 16:35:15.217 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 16:35:15.217 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 16:35:15.290 -03:00 [DBG] Starting token cleanup
2018-08-27 16:39:49.823 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 16:39:49.944 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:39:49.947 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:39:49.986 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 16:39:50.004 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 16:39:50.004 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 16:39:50.009 -03:00 [DBG] Start discovery request
2018-08-27 16:39:50.270 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 16:39:50.302 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 16:39:50.308 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:39:50.309 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:39:50.322 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 16:39:50.326 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 16:39:50.327 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 16:39:50.330 -03:00 [DBG] Start key discovery request
2018-08-27 16:39:50.370 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 16:39:50.375 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 16:39:50.377 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 16:39:50.380 -03:00 [DBG] Start authorize request
2018-08-27 16:39:50.387 -03:00 [DBG] No user present in authorize request
2018-08-27 16:39:50.390 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:39:50.545 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:39:50.581 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:39:50.608 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:39:50.618 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:39:50.622 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:39:50.628 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:39:50.638 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "SkvnWDRkMardAMpsnUfu6LcxqcSlJTKp1689gXQG",
  "Nonce": "SkvnWDRkMardAMpsnUfu6LcxqcSlJTKp1689gXQG",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "SkvnWDRkMardAMpsnUfu6LcxqcSlJTKp1689gXQG",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "SkvnWDRkMardAMpsnUfu6LcxqcSlJTKp1689gXQG"
  }
}
2018-08-27 16:39:50.648 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 16:39:50.745 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:39:50.753 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:39:50.756 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:39:50.758 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:39:50.761 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:39:50.763 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:39:50.764 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:39:50.774 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:41:55.339 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 16:41:55.345 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:41:55.346 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:41:55.347 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 16:41:55.348 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 16:41:55.350 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 16:41:55.351 -03:00 [DBG] Start discovery request
2018-08-27 16:41:55.377 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 16:43:06.868 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 16:43:06.891 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 16:43:06.891 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 16:43:06.891 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 16:43:06.891 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 16:43:06.962 -03:00 [DBG] Starting token cleanup
2018-08-27 16:46:19.742 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 16:46:19.763 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 16:46:19.764 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 16:46:19.765 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 16:46:19.765 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 16:46:19.842 -03:00 [DBG] Starting token cleanup
2018-08-27 16:50:56.253 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 16:50:56.274 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 16:50:56.274 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 16:50:56.274 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 16:50:56.274 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 16:50:56.348 -03:00 [DBG] Starting token cleanup
2018-08-27 16:51:36.969 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 16:51:36.991 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 16:51:36.991 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 16:51:36.992 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 16:51:36.992 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 16:51:37.065 -03:00 [DBG] Starting token cleanup
2018-08-27 16:52:33.159 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 16:52:33.179 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 16:52:33.179 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 16:52:33.180 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 16:52:33.180 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 16:52:33.255 -03:00 [DBG] Starting token cleanup
2018-08-27 16:52:43.868 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 16:52:43.968 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:52:43.972 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:52:44.015 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 16:52:44.023 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 16:52:44.024 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 16:52:44.028 -03:00 [DBG] Start discovery request
2018-08-27 16:52:44.303 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 16:52:44.337 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 16:52:44.342 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:52:44.343 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:52:44.344 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 16:52:44.346 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 16:52:44.347 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 16:52:44.351 -03:00 [DBG] Start key discovery request
2018-08-27 16:52:44.398 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 16:52:44.402 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 16:52:44.403 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 16:52:44.406 -03:00 [DBG] Start authorize request
2018-08-27 16:52:44.414 -03:00 [DBG] No user present in authorize request
2018-08-27 16:52:44.419 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:52:44.579 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:52:44.611 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:52:44.636 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:52:44.645 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:52:44.647 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:52:44.653 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:52:44.661 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "ir1WWVWTbUqyZhN2Z1uTiHPZJawcmw3kMULouq70",
  "Nonce": "ir1WWVWTbUqyZhN2Z1uTiHPZJawcmw3kMULouq70",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "ir1WWVWTbUqyZhN2Z1uTiHPZJawcmw3kMULouq70",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "ir1WWVWTbUqyZhN2Z1uTiHPZJawcmw3kMULouq70"
  }
}
2018-08-27 16:52:44.671 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 16:52:44.771 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:52:44.779 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:52:44.782 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:52:44.783 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:52:44.785 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:52:44.787 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:52:44.787 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:52:44.798 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:52:46.749 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 16:52:47.635 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 16:52:47.821 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGCAQJP9TOV:00000007",
  "TimeStamp": "2018-08-27T19:52:47Z",
  "ProcessId": 28172,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 16:52:47.830 -03:00 [DBG] Augmenting SignInContext
2018-08-27 16:52:47.832 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 16:52:47.837 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 16:52:47.841 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 16:52:47.860 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 16:52:47.863 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 16:52:47.864 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 16:52:47.869 -03:00 [DBG] Start authorize callback request
2018-08-27 16:52:47.872 -03:00 [DBG] User in authorize request: 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 16:52:47.873 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:52:47.881 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:52:47.883 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:52:47.885 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:52:47.887 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:52:47.888 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:52:47.889 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:52:47.891 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "ir1WWVWTbUqyZhN2Z1uTiHPZJawcmw3kMULouq70",
  "Nonce": "ir1WWVWTbUqyZhN2Z1uTiHPZJawcmw3kMULouq70",
  "SessionId": "503daf2b3e09162b84d4a6a6c28a14d7",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "ir1WWVWTbUqyZhN2Z1uTiHPZJawcmw3kMULouq70",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "ir1WWVWTbUqyZhN2Z1uTiHPZJawcmw3kMULouq70"
  }
}
2018-08-27 16:52:47.956 -03:00 [DBG] yCTQeKD0JfQrTvLr+4TZa3gAId8q725c47uE670gM3Q= found in database: true
2018-08-27 16:52:47.962 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-27 16:52:47.968 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 16:52:47.975 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 16:52:47.975 -03:00 [DBG] Getting claims for access token for subject: 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 16:52:48.009 -03:00 [DBG] BhXkuw6neD8NbRffB1nGcb0Z+V7PPznKT3ev/XO5aX0= not found in database
2018-08-27 16:52:48.111 -03:00 [DBG] Getting claims for identity token for subject: 68202b22-d09d-442c-8bb2-325d922ed55c and client: UserManagementUI
2018-08-27 16:52:48.113 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 16:52:48.157 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****xPOg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****3e8b"
    }
  ],
  "ActivityId": "0HLGCAQJP9TOV:00000008",
  "TimeStamp": "2018-08-27T19:52:48Z",
  "ProcessId": 28172,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 16:52:48.164 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "ir1WWVWTbUqyZhN2Z1uTiHPZJawcmw3kMULouq70",
  "Scope": "openid profile email"
}
2018-08-27 16:52:48.176 -03:00 [DBG] Augmenting SignInContext
2018-08-27 16:52:48.176 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 16:52:49.353 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 16:52:49.356 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:52:49.357 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:52:49.359 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 16:52:49.360 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 16:52:49.362 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 16:52:49.365 -03:00 [DBG] Start discovery request
2018-08-27 16:52:49.375 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 16:52:49.407 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 16:52:49.410 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:52:49.412 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:52:49.413 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 16:52:49.414 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 16:52:49.416 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 16:52:49.417 -03:00 [DBG] Start key discovery request
2018-08-27 16:52:56.787 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 16:52:56.790 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 16:52:56.791 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 16:52:56.798 -03:00 [DBG] Processing signout request for 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 16:52:56.804 -03:00 [DBG] Start end session request validation
2018-08-27 16:52:56.809 -03:00 [DBG] Start identity token validation
2018-08-27 16:52:56.825 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:52:56.828 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 16:52:56.862 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 16:52:56.866 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535399568,
    "exp": 1535399868,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "ir1WWVWTbUqyZhN2Z1uTiHPZJawcmw3kMULouq70",
    "iat": 1535399568,
    "at_hash": "Yw3dkKPZ_Zdmo4v3bsxolA",
    "sid": "503daf2b3e09162b84d4a6a6c28a14d7",
    "sub": "68202b22-d09d-442c-8bb2-325d922ed55c",
    "auth_time": 1535399567,
    "idp": "Facebook",
    "amr": "external"
  }
}
2018-08-27 16:52:56.871 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzUzOTk1NjgsImV4cCI6MTUzNTM5OTg2OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiaXIxV1dWV1RiVXF5WmhOMloxdVRpSFBaSmF3Y213M2tNVUxvdXE3MCIsImlhdCI6MTUzNTM5OTU2OCwiYXRfaGFzaCI6Ill3M2RrS1BaX1pkbW80djNic3hvbEEiLCJzaWQiOiI1MDNkYWYyYjNlMDkxNjJiODRkNGE2YTZjMjhhMTRkNyIsInN1YiI6IjY4MjAyYjIyLWQwOWQtNDQyYy04YmIyLTMyNWQ5MjJlZDU1YyIsImF1dGhfdGltZSI6MTUzNTM5OTU2NywiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.v6YfvvK1Jn1W62dpUfxVi4z1ozuA-ixbqspjH70at84azPOqNkYoL4gBUB-tKgJ0fwcJLSSZE_u4tzTnLmWvqvOMZpy60y2IoeXPQMKPBzr_9GP46hWga0Y1sy1xjsTadBtAH-mGPJtvVroADl9uzpl5ac-VX7QVZegTYHwcv3HryjYLUCR-6LvWEiCtZPKzJ1lpk7hGqwtHltp68YlOGy9DFB_Lv_zMFpU91UZLuyx0qXeOAfYkLpiXn94w1ZxORXigktX9b6MLUpPL4y4Tawskbut6DgWmxmd9uaJrgNc-lqBVN-ng-BHN-sfht_TjlrykAcLqUBmoB-XKBSxPOg",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 16:52:56.876 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 16:52:56.913 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 16:52:56.915 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 16:52:56.917 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 16:52:56.920 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGCAQJP9TOV:0000000A",
  "TimeStamp": "2018-08-27T19:52:56Z",
  "ProcessId": 28172,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 16:52:57.091 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 16:52:57.095 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 16:52:57.097 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 16:52:57.103 -03:00 [DBG] Processing signout callback request
2018-08-27 16:52:57.121 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:52:57.122 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 16:52:57.122 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 16:52:57.124 -03:00 [INF] Successful signout callback.
2018-08-27 16:52:57.125 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 16:52:57.126 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 16:53:00.106 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 16:53:00.109 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:53:00.111 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:53:00.112 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 16:53:00.114 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 16:53:00.118 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 16:53:00.120 -03:00 [DBG] Start discovery request
2018-08-27 16:53:00.129 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 16:53:00.163 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 16:53:00.168 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 16:53:00.170 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 16:53:00.171 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 16:53:00.173 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 16:53:00.177 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 16:53:00.179 -03:00 [DBG] Start key discovery request
2018-08-27 16:53:00.225 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 16:53:00.227 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 16:53:00.228 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 16:53:00.229 -03:00 [DBG] Start authorize request
2018-08-27 16:53:00.230 -03:00 [DBG] No user present in authorize request
2018-08-27 16:53:00.230 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:53:00.239 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:53:00.244 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:53:00.247 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:53:00.251 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:53:00.254 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:53:00.254 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:53:00.255 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "KYlC7dwPsNO2rhOqD1c4hclbHIL0rnOGRythgFQW",
  "Nonce": "KYlC7dwPsNO2rhOqD1c4hclbHIL0rnOGRythgFQW",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "KYlC7dwPsNO2rhOqD1c4hclbHIL0rnOGRythgFQW",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "KYlC7dwPsNO2rhOqD1c4hclbHIL0rnOGRythgFQW"
  }
}
2018-08-27 16:53:00.259 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 16:53:00.265 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 16:53:00.274 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 16:53:00.278 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:53:00.280 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:53:00.282 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 16:53:00.283 -03:00 [DBG] Found [] API scopes in database
2018-08-27 16:53:00.284 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 16:53:00.290 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:03:01.251 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 17:03:01.282 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 17:03:01.284 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 17:03:01.285 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 17:03:01.285 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 17:03:01.286 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 17:03:01.287 -03:00 [DBG] Start discovery request
2018-08-27 17:03:01.292 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 17:03:01.301 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 17:03:01.302 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 17:03:01.304 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 17:03:01.304 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 17:03:01.305 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 17:03:01.306 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 17:03:01.307 -03:00 [DBG] Start key discovery request
2018-08-27 17:03:01.321 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 17:03:01.323 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 17:03:01.326 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 17:03:01.326 -03:00 [DBG] Start authorize request
2018-08-27 17:03:01.327 -03:00 [DBG] No user present in authorize request
2018-08-27 17:03:01.327 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 17:03:01.334 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:03:01.336 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:01.340 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:01.343 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:01.345 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:01.346 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 17:03:01.347 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "QACBlCuzL93GyPoCnFm25pDdcFhHPNcjfFWLCtRp",
  "Nonce": "QACBlCuzL93GyPoCnFm25pDdcFhHPNcjfFWLCtRp",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "QACBlCuzL93GyPoCnFm25pDdcFhHPNcjfFWLCtRp",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "QACBlCuzL93GyPoCnFm25pDdcFhHPNcjfFWLCtRp"
  }
}
2018-08-27 17:03:01.350 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 17:03:01.363 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 17:03:01.369 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:03:01.372 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:01.374 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:01.378 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:01.380 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:01.380 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 17:03:01.388 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:03:26.894 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 17:03:26.897 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 17:03:26.898 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 17:03:26.899 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 17:03:26.900 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 17:03:26.901 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 17:03:26.902 -03:00 [DBG] Start discovery request
2018-08-27 17:03:26.907 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 17:03:26.916 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 17:03:26.919 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 17:03:26.919 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 17:03:26.920 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 17:03:26.921 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 17:03:26.922 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 17:03:26.926 -03:00 [DBG] Start key discovery request
2018-08-27 17:03:26.935 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 17:03:26.936 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 17:03:26.938 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 17:03:26.940 -03:00 [DBG] Start authorize request
2018-08-27 17:03:26.941 -03:00 [DBG] No user present in authorize request
2018-08-27 17:03:26.942 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 17:03:26.952 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:03:26.954 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:26.956 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:26.959 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:26.960 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:26.961 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 17:03:26.962 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "3Ne5ae8Lxkv74Vj3aSgJZcQOYSAV2SpEV1O08vZb",
  "Nonce": "3Ne5ae8Lxkv74Vj3aSgJZcQOYSAV2SpEV1O08vZb",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "3Ne5ae8Lxkv74Vj3aSgJZcQOYSAV2SpEV1O08vZb",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "3Ne5ae8Lxkv74Vj3aSgJZcQOYSAV2SpEV1O08vZb"
  }
}
2018-08-27 17:03:26.965 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 17:03:26.970 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 17:03:26.976 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:03:26.978 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:26.980 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:26.981 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:26.983 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:26.983 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 17:03:26.990 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:03:29.349 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 17:03:30.070 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 17:03:30.082 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGCAQJP9TP6:0000000A",
  "TimeStamp": "2018-08-27T20:03:30Z",
  "ProcessId": 28172,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 17:03:30.083 -03:00 [DBG] Augmenting SignInContext
2018-08-27 17:03:30.084 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 17:03:30.084 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 17:03:30.085 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 17:03:30.088 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 17:03:30.089 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 17:03:30.092 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 17:03:30.093 -03:00 [DBG] Start authorize callback request
2018-08-27 17:03:30.094 -03:00 [DBG] User in authorize request: 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 17:03:30.095 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 17:03:30.101 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:03:30.105 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:30.108 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:30.110 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:30.112 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:30.113 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 17:03:30.114 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "3Ne5ae8Lxkv74Vj3aSgJZcQOYSAV2SpEV1O08vZb",
  "Nonce": "3Ne5ae8Lxkv74Vj3aSgJZcQOYSAV2SpEV1O08vZb",
  "SessionId": "ea836b066853b9fb08fc88295bf0791e",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "3Ne5ae8Lxkv74Vj3aSgJZcQOYSAV2SpEV1O08vZb",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "3Ne5ae8Lxkv74Vj3aSgJZcQOYSAV2SpEV1O08vZb"
  }
}
2018-08-27 17:03:30.121 -03:00 [DBG] yCTQeKD0JfQrTvLr+4TZa3gAId8q725c47uE670gM3Q= found in database: true
2018-08-27 17:03:30.125 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-08-27 17:03:30.125 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 17:03:30.126 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 17:03:30.126 -03:00 [DBG] Getting claims for access token for subject: 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 17:03:30.134 -03:00 [DBG] r9j5bA8NfXAnHHyzGCsEGO1C8rP7koMPmjn+GG8esfo= not found in database
2018-08-27 17:03:30.146 -03:00 [DBG] Getting claims for identity token for subject: 68202b22-d09d-442c-8bb2-325d922ed55c and client: UserManagementUI
2018-08-27 17:03:30.147 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 17:03:30.150 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****UOkg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****0b03"
    }
  ],
  "ActivityId": "0HLGCAQJP9TP6:0000000B",
  "TimeStamp": "2018-08-27T20:03:30Z",
  "ProcessId": 28172,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 17:03:30.152 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "3Ne5ae8Lxkv74Vj3aSgJZcQOYSAV2SpEV1O08vZb",
  "Scope": "openid profile email"
}
2018-08-27 17:03:30.154 -03:00 [DBG] Augmenting SignInContext
2018-08-27 17:03:30.154 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 17:03:31.295 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 17:03:31.299 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 17:03:31.300 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 17:03:31.301 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 17:03:31.303 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 17:03:31.304 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 17:03:31.306 -03:00 [DBG] Start discovery request
2018-08-27 17:03:31.317 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 17:03:31.338 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 17:03:31.342 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 17:03:31.344 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 17:03:31.344 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 17:03:31.346 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 17:03:31.347 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 17:03:31.348 -03:00 [DBG] Start key discovery request
2018-08-27 17:03:35.472 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-08-27 17:03:35.474 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-08-27 17:03:35.475 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-08-27 17:03:35.477 -03:00 [DBG] Processing signout request for 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 17:03:35.478 -03:00 [DBG] Start end session request validation
2018-08-27 17:03:35.479 -03:00 [DBG] Start identity token validation
2018-08-27 17:03:35.485 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:03:35.486 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-08-27 17:03:35.493 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-08-27 17:03:35.494 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1535400210,
    "exp": 1535400510,
    "iss": "http://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "3Ne5ae8Lxkv74Vj3aSgJZcQOYSAV2SpEV1O08vZb",
    "iat": 1535400210,
    "at_hash": "kVeOJ8YOYegS-u8zHa6fwg",
    "sid": "ea836b066853b9fb08fc88295bf0791e",
    "sub": "68202b22-d09d-442c-8bb2-325d922ed55c",
    "auth_time": 1535400210,
    "idp": "Facebook",
    "amr": "external"
  }
}
2018-08-27 17:03:35.496 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "PostLogOutUri": "http://localhost:4200/",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImIwMzg4M2ZhMjcwNmRiM2IzZTdiNjI4ZWE0YmE5MjdkIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzU0MDAyMTAsImV4cCI6MTUzNTQwMDUxMCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoiVXNlck1hbmFnZW1lbnRVSSIsIm5vbmNlIjoiM05lNWFlOEx4a3Y3NFZqM2FTZ0paY1FPWVNBVjJTcEVWMU8wOHZaYiIsImlhdCI6MTUzNTQwMDIxMCwiYXRfaGFzaCI6ImtWZU9KOFlPWWVnUy11OHpIYTZmd2ciLCJzaWQiOiJlYTgzNmIwNjY4NTNiOWZiMDhmYzg4Mjk1YmYwNzkxZSIsInN1YiI6IjY4MjAyYjIyLWQwOWQtNDQyYy04YmIyLTMyNWQ5MjJlZDU1YyIsImF1dGhfdGltZSI6MTUzNTQwMDIxMCwiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.Q43ZR3O1RwnospKv_tqYsYEKuPdyWyhW2lcXbo8sy1vmRnMueCzkC2CASaHssHjbzcCqBMhDeVmjeukP8Px3EucmfjWdQxGfG2kxHIJpf-OJS2N0fm-dNCvTDUY21JvLS5qg4KoAM8bNNjCBn75fK4gaScxElxI0MSdbE369hgeQu5ITciJV9hnW6UL97wwsDErTI6P9V-MJb0po0ADI5BgFIsW4SkI9IGWtL5QFzhaYc-WR_yQ6dK4D_VcnYNGall2lVuGO6QlNJTR39ehGz_h67mnsb7j0C_bHS5luCQG5zqe99Q7jgtL5R6QmgpVfpfPz60Bi9KAslB4np5UOkg",
    "post_logout_redirect_uri": "http://localhost:4200/"
  }
}
2018-08-27 17:03:35.499 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-08-27 17:03:35.505 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 17:03:35.506 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 17:03:35.506 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 17:03:35.508 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGCAQJP9TP6:0000000D",
  "TimeStamp": "2018-08-27T20:03:35Z",
  "ProcessId": 28172,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 17:03:35.675 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 17:03:35.677 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 17:03:35.679 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 17:03:35.681 -03:00 [DBG] Processing signout callback request
2018-08-27 17:03:35.698 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:03:35.700 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 17:03:35.702 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 17:03:35.703 -03:00 [INF] Successful signout callback.
2018-08-27 17:03:35.704 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 17:03:35.706 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 17:03:38.355 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 17:03:38.359 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 17:03:38.361 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 17:03:38.363 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 17:03:38.365 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 17:03:38.368 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 17:03:38.370 -03:00 [DBG] Start discovery request
2018-08-27 17:03:38.380 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 17:03:38.422 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 17:03:38.436 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 17:03:38.437 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 17:03:38.438 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 17:03:38.440 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 17:03:38.441 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 17:03:38.443 -03:00 [DBG] Start key discovery request
2018-08-27 17:03:38.490 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 17:03:38.492 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 17:03:38.494 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 17:03:38.495 -03:00 [DBG] Start authorize request
2018-08-27 17:03:38.495 -03:00 [DBG] No user present in authorize request
2018-08-27 17:03:38.496 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 17:03:38.504 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:03:38.507 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:38.510 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:38.530 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:38.532 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:38.532 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 17:03:38.534 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "riwCRl67i3GrROIt0DGQNInwLZBHTAZJuC0mIy19",
  "Nonce": "riwCRl67i3GrROIt0DGQNInwLZBHTAZJuC0mIy19",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "riwCRl67i3GrROIt0DGQNInwLZBHTAZJuC0mIy19",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "riwCRl67i3GrROIt0DGQNInwLZBHTAZJuC0mIy19"
  }
}
2018-08-27 17:03:38.539 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 17:03:38.544 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 17:03:38.552 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:03:38.558 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:38.562 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:38.565 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:38.568 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:38.570 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 17:03:38.582 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:03:44.207 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 17:03:44.215 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:03:44.217 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:44.219 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:44.221 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:03:44.222 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:03:44.223 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 17:03:44.230 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:03:45.479 -03:00 [INF] AuthenticationScheme: Google was challenged.
2018-08-27 17:03:51.244 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 17:03:56.322 -03:00 [WRN] User a6fd6db7-f6c8-4646-8b94-172affc28bbe validation failed: DuplicateUserName.
2018-08-27 17:04:03.206 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 17:04:03.757 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 17:04:03.770 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGCAQJP9TP4:00000016",
  "TimeStamp": "2018-08-27T20:04:03Z",
  "ProcessId": 28172,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 17:04:03.771 -03:00 [DBG] Augmenting SignInContext
2018-08-27 17:04:03.772 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 17:04:03.772 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 17:04:03.773 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 17:04:06.117 -03:00 [DBG] 4 persisted grants found for 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 17:04:06.137 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:04:06.140 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:04:06.142 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:04:20.555 -03:00 [DBG] 4 persisted grants found for 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 17:04:20.578 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:04:20.582 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:04:20.584 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:10:13.385 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 17:10:13.406 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 17:10:13.407 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 17:10:13.407 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 17:10:13.408 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 17:10:13.479 -03:00 [DBG] Starting token cleanup
2018-08-27 17:10:21.089 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 17:10:21.093 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 17:10:21.094 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 17:10:21.096 -03:00 [DBG] Start discovery request
2018-08-27 17:10:21.422 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 17:10:24.164 -03:00 [DBG] 4 persisted grants found for 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 17:10:24.347 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:10:24.367 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:10:24.392 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:10:38.454 -03:00 [DBG] 4 persisted grants found for 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 17:10:38.470 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:10:38.473 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:10:38.474 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:10:41.679 -03:00 [DBG] 4 persisted grants found for 68202b22-d09d-442c-8bb2-325d922ed55c
2018-08-27 17:10:41.694 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:10:41.698 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:10:41.699 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:10:53.794 -03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 17:10:53.839 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 17:10:53.842 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 17:10:53.845 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 17:10:53.863 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "68202b22-d09d-442c-8bb2-325d922ed55c",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGCB4E7DUOL:00000012",
  "TimeStamp": "2018-08-27T20:10:53Z",
  "ProcessId": 9384,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 17:11:26.428 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 17:11:26.450 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 17:11:26.450 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 17:11:26.450 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 17:11:26.451 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 17:11:26.520 -03:00 [DBG] Starting token cleanup
2018-08-27 17:12:01.648 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 17:12:01.741 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 17:12:01.745 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 17:12:01.747 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 17:12:01.750 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 17:12:01.751 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 17:12:01.754 -03:00 [DBG] Start discovery request
2018-08-27 17:12:01.971 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 17:12:01.993 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 17:12:01.997 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 17:12:01.998 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 17:12:01.998 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 17:12:01.999 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 17:12:02.000 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 17:12:02.002 -03:00 [DBG] Start key discovery request
2018-08-27 17:12:02.022 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-08-27 17:12:02.028 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-08-27 17:12:02.029 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-08-27 17:12:02.038 -03:00 [DBG] Start authorize request
2018-08-27 17:12:02.044 -03:00 [DBG] No user present in authorize request
2018-08-27 17:12:02.048 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 17:12:02.200 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:12:02.238 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:12:02.266 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:12:02.273 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:12:02.276 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:12:02.282 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 17:12:02.290 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "wn8ro1xWjnKVPCNByiadAYNBgAX6a0EyHNL5uiF8",
  "Nonce": "wn8ro1xWjnKVPCNByiadAYNBgAX6a0EyHNL5uiF8",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "wn8ro1xWjnKVPCNByiadAYNBgAX6a0EyHNL5uiF8",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "wn8ro1xWjnKVPCNByiadAYNBgAX6a0EyHNL5uiF8"
  }
}
2018-08-27 17:12:02.302 -03:00 [INF] Showing login: User is not authenticated
2018-08-27 17:12:02.317 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 17:12:02.327 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:12:02.330 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:12:02.331 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:12:02.333 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:12:02.335 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:12:02.336 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 17:12:02.344 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:12:09.284 -03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 17:12:09.476 -03:00 [DBG] Augmenting SignInContext
2018-08-27 17:12:09.478 -03:00 [DBG] Adding idp claim with value: local
2018-08-27 17:12:09.478 -03:00 [DBG] Adding amr claim with value: pwd
2018-08-27 17:12:09.479 -03:00 [DBG] Adding auth_time claim with value: 1535400729
2018-08-27 17:12:09.487 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 17:12:09.507 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "bhdebrito",
  "SubjectId": "c5fca25b-d337-4e02-892d-68ec7d8e808f",
  "DisplayName": "bhdebrito",
  "Endpoint": "UI",
  "ActivityId": "0HLGCB53BPUCV:0000000A",
  "TimeStamp": "2018-08-27T20:12:09Z",
  "ProcessId": 29088,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 17:12:09.532 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 17:12:09.534 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 17:12:09.535 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 17:12:09.539 -03:00 [DBG] Start authorize callback request
2018-08-27 17:12:09.542 -03:00 [DBG] User in authorize request: c5fca25b-d337-4e02-892d-68ec7d8e808f
2018-08-27 17:12:09.543 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 17:12:09.550 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:12:09.553 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:12:09.556 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:12:09.562 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:12:09.566 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:12:09.567 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 17:12:09.568 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "c5fca25b-d337-4e02-892d-68ec7d8e808f",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "wn8ro1xWjnKVPCNByiadAYNBgAX6a0EyHNL5uiF8",
  "Nonce": "wn8ro1xWjnKVPCNByiadAYNBgAX6a0EyHNL5uiF8",
  "SessionId": "b3063432ff30e344aa7c26ddb8b9a873",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "wn8ro1xWjnKVPCNByiadAYNBgAX6a0EyHNL5uiF8",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "wn8ro1xWjnKVPCNByiadAYNBgAX6a0EyHNL5uiF8"
  }
}
2018-08-27 17:12:09.612 -03:00 [DBG] 1aIPKUuL7GR4JBWPKGeymKkdAfFCBtZEOwNAlVVyfu0= found in database: false
2018-08-27 17:12:09.614 -03:00 [DBG] user_consent grant with value: UserManagementUI|c5fca25b-d337-4e02-892d-68ec7d8e808f not found in store.
2018-08-27 17:12:09.615 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 17:12:09.616 -03:00 [INF] Showing consent: User has not yet consented
2018-08-27 17:12:09.639 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 17:12:09.645 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:12:09.648 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:12:09.649 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:12:09.651 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:12:09.653 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:12:09.654 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 17:12:09.659 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:12:09.662 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:12:09.664 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:12:12.662 -03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 17:12:12.676 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 17:12:12.683 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:12:12.685 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:12:12.687 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:12:12.689 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:12:12.690 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:12:12.692 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 17:12:12.704 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-08-27 17:12:12.706 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-08-27 17:12:12.707 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-08-27 17:12:12.708 -03:00 [DBG] Start authorize callback request
2018-08-27 17:12:12.711 -03:00 [DBG] User in authorize request: c5fca25b-d337-4e02-892d-68ec7d8e808f
2018-08-27 17:12:12.712 -03:00 [DBG] Start authorize request protocol validation
2018-08-27 17:12:12.718 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:12:12.721 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:12:12.723 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:12:12.727 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-08-27 17:12:12.729 -03:00 [DBG] Found [] API scopes in database
2018-08-27 17:12:12.730 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-08-27 17:12:12.731 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback",
    "https://localhost:5003/swagger/oauth2-redirect.html"
  ],
  "SubjectId": "c5fca25b-d337-4e02-892d-68ec7d8e808f",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email",
  "State": "wn8ro1xWjnKVPCNByiadAYNBgAX6a0EyHNL5uiF8",
  "Nonce": "wn8ro1xWjnKVPCNByiadAYNBgAX6a0EyHNL5uiF8",
  "SessionId": "b3063432ff30e344aa7c26ddb8b9a873",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "wn8ro1xWjnKVPCNByiadAYNBgAX6a0EyHNL5uiF8",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email",
    "nonce": "wn8ro1xWjnKVPCNByiadAYNBgAX6a0EyHNL5uiF8"
  }
}
2018-08-27 17:12:12.737 -03:00 [DBG] 1aIPKUuL7GR4JBWPKGeymKkdAfFCBtZEOwNAlVVyfu0= found in database: false
2018-08-27 17:12:12.738 -03:00 [DBG] user_consent grant with value: UserManagementUI|c5fca25b-d337-4e02-892d-68ec7d8e808f not found in store.
2018-08-27 17:12:12.741 -03:00 [DBG] Found no prior consent from consent store, consent is required
2018-08-27 17:12:12.744 -03:00 [INF] User consented to scopes: ["openid","profile","email"]
2018-08-27 17:12:12.746 -03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email"]
2018-08-27 17:12:12.749 -03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: c5fca25b-d337-4e02-892d-68ec7d8e808f
2018-08-27 17:12:12.760 -03:00 [DBG] 1aIPKUuL7GR4JBWPKGeymKkdAfFCBtZEOwNAlVVyfu0= not found in database
2018-08-27 17:12:12.797 -03:00 [DBG] Creating Implicit Flow response.
2018-08-27 17:12:12.805 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-08-27 17:12:12.805 -03:00 [DBG] Getting claims for access token for subject: c5fca25b-d337-4e02-892d-68ec7d8e808f
2018-08-27 17:12:12.837 -03:00 [DBG] PDIDqKzwm2ZS6cYg/bAOjBWmKjbureO5EGrGsV6D8D0= not found in database
2018-08-27 17:12:12.849 -03:00 [DBG] Getting claims for identity token for subject: c5fca25b-d337-4e02-892d-68ec7d8e808f and client: UserManagementUI
2018-08-27 17:12:12.850 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-08-27 17:12:12.894 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "c5fca25b-d337-4e02-892d-68ec7d8e808f",
  "Scopes": "openid profile email",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****xc-w"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****c774"
    }
  ],
  "ActivityId": "0HLGCB53BPUCV:00000010",
  "TimeStamp": "2018-08-27T20:12:12Z",
  "ProcessId": 29088,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 17:12:12.901 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "c5fca25b-d337-4e02-892d-68ec7d8e808f",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "wn8ro1xWjnKVPCNByiadAYNBgAX6a0EyHNL5uiF8",
  "Scope": "openid profile email"
}
2018-08-27 17:12:12.914 -03:00 [DBG] Augmenting SignInContext
2018-08-27 17:12:12.915 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 17:12:14.387 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 17:12:14.391 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 17:12:14.392 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 17:12:14.393 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 17:12:14.394 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 17:12:14.395 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 17:12:14.400 -03:00 [DBG] Start discovery request
2018-08-27 17:12:14.411 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 17:12:14.457 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 17:12:14.461 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 17:12:14.462 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 17:12:14.463 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 17:12:14.465 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 17:12:14.465 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 17:12:14.467 -03:00 [DBG] Start key discovery request
2018-08-27 17:15:32.504 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-08-27 17:15:32.525 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-08-27 17:15:32.525 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-08-27 17:15:32.525 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-08-27 17:15:32.525 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-08-27 17:15:32.609 -03:00 [DBG] Starting token cleanup
2018-08-27 17:15:40.359 -03:00 [DBG] 0 persisted grants found for c5fca25b-d337-4e02-892d-68ec7d8e808f
2018-08-27 17:15:44.714 -03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-08-27 17:15:44.757 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-08-27 17:15:44.758 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 17:15:44.760 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-08-27 17:15:44.778 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "c5fca25b-d337-4e02-892d-68ec7d8e808f",
  "DisplayName": "Bruno Brito",
  "ActivityId": "0HLGCB7C3FO21:00000008",
  "TimeStamp": "2018-08-27T20:15:44Z",
  "ProcessId": 11992,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 17:15:44.946 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-08-27 17:15:44.951 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-08-27 17:15:44.952 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-08-27 17:15:44.956 -03:00 [DBG] Processing signout callback request
2018-08-27 17:15:45.281 -03:00 [DBG] UserManagementUI found in database: true
2018-08-27 17:15:45.284 -03:00 [DBG] No client front-channel logout URLs
2018-08-27 17:15:45.285 -03:00 [DBG] No client back-channel logout URLs
2018-08-27 17:15:45.285 -03:00 [INF] Successful signout callback.
2018-08-27 17:15:45.286 -03:00 [DBG] No client front-channel iframe urls
2018-08-27 17:15:45.286 -03:00 [DBG] No client back-channel iframe urls
2018-08-27 17:16:05.841 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-08-27 17:16:05.879 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 17:16:05.880 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 17:16:05.883 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-08-27 17:16:05.884 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-08-27 17:16:05.885 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-08-27 17:16:05.888 -03:00 [DBG] Start discovery request
2018-08-27 17:16:06.027 -03:00 [DBG] Found ["openid","profile","email","custom.profile","roles","api1","UserManagementApi.full_access","UserManagementApi.read_access","UserManagementApi.write_access"] as all scopes in database
2018-08-27 17:16:06.048 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-08-27 17:16:06.051 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-08-27 17:16:06.052 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-08-27 17:16:06.053 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-08-27 17:16:06.055 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-08-27 17:16:06.055 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-08-27 17:16:06.058 -03:00 [DBG] Start key discovery request
2018-08-27 17:16:19.264 -03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-08-27 17:16:21.664 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-08-27 17:16:22.428 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-08-27 17:16:22.598 -03:00 [INF] Provider Facebook associated.
2018-08-27 17:16:22.747 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Facebook",
  "ProviderUserId": "1832756710095231",
  "SubjectId": "e71ac70f-e78d-44c5-becb-bee7d655923c",
  "DisplayName": "Bruno Brito",
  "Endpoint": "UI",
  "ActivityId": "0HLGCB7C3FO21:00000013",
  "TimeStamp": "2018-08-27T20:16:22Z",
  "ProcessId": 11992,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-08-27 17:16:22.756 -03:00 [DBG] Augmenting SignInContext
2018-08-27 17:16:22.758 -03:00 [DBG] Adding amr claim with value: external
2018-08-27 17:16:22.761 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-08-27 17:16:22.762 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-08-27 17:16:22.776 -03:00 [DBG] 0 persisted grants found for e71ac70f-e78d-44c5-becb-bee7d655923c
2018-08-27 17:16:42.690 -03:00 [DBG] 0 persisted grants found for e71ac70f-e78d-44c5-becb-bee7d655923c
2018-08-27 17:16:50.826 -03:00 [DBG] 0 persisted grants found for e71ac70f-e78d-44c5-becb-bee7d655923c
