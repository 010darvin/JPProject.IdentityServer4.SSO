2018-10-14 02:00:39.878 -03:00 [INF] SigninCredentialExtension keyType is Temporary
2018-10-14 02:00:40.052 -03:00 [INF] SigninCredentialExtension added
2018-10-14 02:03:08.523 -03:00 [INF] SigninCredentialExtension keyType is Temporary
2018-10-14 02:03:08.689 -03:00 [INF] SigninCredentialExtension added
2018-10-14 02:06:40.844 -03:00 [INF] SigninCredentialExtension keyType is Temporary
2018-10-14 02:06:40.994 -03:00 [INF] SigninCredentialExtension added
2018-10-14 02:07:00.238 -03:00 [INF] SigninCredentialExtension keyType is Temporary
2018-10-14 02:07:00.376 -03:00 [INF] SigninCredentialExtension added
2018-10-14 02:07:04.576 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-10-14 02:07:04.594 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-10-14 02:07:04.602 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-10-14 02:07:04.604 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-10-14 02:07:04.609 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-10-14 02:07:58.416 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 02:07:58.538 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:07:58.546 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:07:58.588 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 02:07:58.596 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 02:07:58.599 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 02:07:58.605 -03:00 [DBG] Start discovery request
2018-10-14 02:07:58.964 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 02:07:59.016 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 02:07:59.025 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:07:59.028 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:07:59.031 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 02:07:59.036 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 02:07:59.040 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 02:07:59.045 -03:00 [DBG] Start key discovery request
2018-10-14 02:07:59.299 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-10-14 02:07:59.305 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-10-14 02:07:59.308 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-10-14 02:07:59.313 -03:00 [DBG] Start authorize request
2018-10-14 02:07:59.333 -03:00 [DBG] User in authorize request: d36b7160-b58b-4e68-8d0a-fe959d445f4b
2018-10-14 02:07:59.339 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:07:59.523 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:07:59.565 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:07:59.611 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:07:59.629 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:07:59.651 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:07:59.664 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:07:59.674 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback"
  ],
  "SubjectId": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email jp_api.user",
  "State": "Hj087NzhkbqI9ULTekFPpGqbsjiZsH2RjrJOdFFs",
  "Nonce": "Hj087NzhkbqI9ULTekFPpGqbsjiZsH2RjrJOdFFs",
  "SessionId": "0dccd73a004af1081acf892161ce5982",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "Hj087NzhkbqI9ULTekFPpGqbsjiZsH2RjrJOdFFs",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email jp_api.user",
    "nonce": "Hj087NzhkbqI9ULTekFPpGqbsjiZsH2RjrJOdFFs"
  }
}
2018-10-14 02:07:59.751 -03:00 [DBG] CQw7PQZzv0X/POAfOZXAe9WpvFJDwBmfVs0+A8o4zoM= found in database: true
2018-10-14 02:07:59.760 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-10-14 02:07:59.773 -03:00 [DBG] Creating Implicit Flow response.
2018-10-14 02:07:59.785 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-10-14 02:07:59.788 -03:00 [DBG] Getting claims for access token for subject: d36b7160-b58b-4e68-8d0a-fe959d445f4b
2018-10-14 02:07:59.854 -03:00 [DBG] Getting claims for identity token for subject: d36b7160-b58b-4e68-8d0a-fe959d445f4b and client: UserManagementUI
2018-10-14 02:07:59.858 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-10-14 02:07:59.895 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
  "Scopes": "openid profile email jp_api.user",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****C4Zw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****iAtg"
    }
  ],
  "ActivityId": "0HLHHIBHIQQJD:00000001",
  "TimeStamp": "2018-10-14T05:07:59Z",
  "ProcessId": 16536,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-10-14 02:07:59.908 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "Hj087NzhkbqI9ULTekFPpGqbsjiZsH2RjrJOdFFs",
  "Scope": "openid profile email jp_api.user"
}
2018-10-14 02:08:01.151 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 02:08:01.159 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:08:01.166 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:08:01.180 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 02:08:01.190 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 02:08:01.199 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 02:08:01.212 -03:00 [DBG] Start discovery request
2018-10-14 02:08:01.233 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 02:08:01.259 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 02:08:01.268 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:08:01.271 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:08:01.275 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 02:08:01.278 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 02:08:01.283 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 02:08:01.286 -03:00 [DBG] Start key discovery request
2018-10-14 02:08:02.399 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 02:08:02.408 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:08:02.411 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:08:02.472 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 02:08:02.478 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:08:02.483 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:08:02.485 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 02:08:02.490 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 02:08:02.492 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 02:08:02.501 -03:00 [DBG] Start userinfo request
2018-10-14 02:08:02.506 -03:00 [DBG] Bearer token found in header
2018-10-14 02:08:02.540 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:08:02.559 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:08:02.569 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 02:08:02.575 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539493679,
    "exp": 1539497279,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "UserManagementUI",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539466548,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.user"
    ],
    "amr": "external"
  }
}
2018-10-14 02:08:02.586 -03:00 [DBG] Creating userinfo response
2018-10-14 02:08:02.591 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:08:02.595 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:08:02.603 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:08:02.606 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 02:08:02.609 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:08:02.614 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:08:02.625 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 02:08:02.629 -03:00 [DBG] End userinfo request
2018-10-14 02:08:32.431 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 02:08:32.438 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:08:32.442 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:08:32.446 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 02:08:32.449 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 02:08:32.453 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 02:08:32.461 -03:00 [DBG] Start discovery request
2018-10-14 02:08:32.477 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 02:08:32.494 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 02:08:32.502 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:08:32.507 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:08:32.510 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 02:08:32.514 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 02:08:32.517 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 02:08:32.521 -03:00 [DBG] Start key discovery request
2018-10-14 02:08:32.743 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 02:08:32.749 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:08:32.753 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:08:32.839 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 02:08:32.846 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:08:32.850 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:08:32.852 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 02:08:32.855 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 02:08:32.859 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 02:08:32.866 -03:00 [DBG] Start userinfo request
2018-10-14 02:08:32.868 -03:00 [DBG] Bearer token found in header
2018-10-14 02:08:32.898 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:08:32.918 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:08:32.930 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 02:08:32.934 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539493679,
    "exp": 1539497279,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "UserManagementUI",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539466548,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.user"
    ],
    "amr": "external"
  }
}
2018-10-14 02:08:32.943 -03:00 [DBG] Creating userinfo response
2018-10-14 02:08:32.945 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:08:32.947 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:08:32.952 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:08:32.955 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 02:08:32.957 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:08:32.963 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:08:32.980 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 02:08:32.985 -03:00 [DBG] End userinfo request
2018-10-14 02:08:34.221 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-10-14 02:08:34.227 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-10-14 02:08:34.230 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-10-14 02:08:34.240 -03:00 [DBG] Processing signout request for d36b7160-b58b-4e68-8d0a-fe959d445f4b
2018-10-14 02:08:34.247 -03:00 [DBG] Start end session request validation
2018-10-14 02:08:34.254 -03:00 [DBG] Start identity token validation
2018-10-14 02:08:34.276 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:08:34.279 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-10-14 02:08:34.290 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 02:08:34.293 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1539493679,
    "exp": 1539493979,
    "iss": "https://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "Hj087NzhkbqI9ULTekFPpGqbsjiZsH2RjrJOdFFs",
    "iat": 1539493679,
    "at_hash": "hj7NYr7CytV7I1PHHZjmMg",
    "sid": "0dccd73a004af1081acf892161ce5982",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539466548,
    "idp": "Google",
    "amr": "external"
  }
}
2018-10-14 02:08:34.304 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
  "PostLogOutUri": "http://localhost:4200",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjM1Y2JkMjU0NmQ0Mjc5MmI3MTVhYTRhN2U4MGRmODczIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1Mzk0OTM2NzksImV4cCI6MTUzOTQ5Mzk3OSwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NTAwMCIsImF1ZCI6IlVzZXJNYW5hZ2VtZW50VUkiLCJub25jZSI6IkhqMDg3Tnpoa2JxSTlVTFRla0ZQcEdxYnNqaVpzSDJSanJKT2RGRnMiLCJpYXQiOjE1Mzk0OTM2NzksImF0X2hhc2giOiJoajdOWXI3Q3l0VjdJMVBISFpqbU1nIiwic2lkIjoiMGRjY2Q3M2EwMDRhZjEwODFhY2Y4OTIxNjFjZTU5ODIiLCJzdWIiOiJkMzZiNzE2MC1iNThiLTRlNjgtOGQwYS1mZTk1OWQ0NDVmNGIiLCJhdXRoX3RpbWUiOjE1Mzk0NjY1NDgsImlkcCI6Ikdvb2dsZSIsImFtciI6WyJleHRlcm5hbCJdfQ.NqZjeC5B5OGuxK0xnTyE9gCwyIz2g43GMJo4cYxbTIG5dtZ0gikADe83vH9rhXY8oJZoGSPapNAhuHwVohfRcJYlG6F94PLSPkhPRoighfNAVIqPjhFHrilrhjW6eSCbNONBd2Mt9e9MLkhUc5VZ4XHyYTghjZ4qKLYeOhn19ehd_MlK63aDL-OgHCcC_g-YQe3N67HNWJXbj3OOFKpw14ka41L2LQKX6qXVmMv0bWzjXyJuKtfDp_xVUMMs9CZ-ZDngEwrcNxzFhPQLbyTm8xRtxYexqyFsjWRYTMDz8mKilWIwpKXrpR7auttOxvn5Zymb1w9wHS1u4yFQMvC4Zw",
    "post_logout_redirect_uri": "http://localhost:4200"
  }
}
2018-10-14 02:08:34.312 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-10-14 02:08:34.494 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-10-14 02:08:34.498 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-10-14 02:08:34.501 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-10-14 02:08:34.507 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
  "DisplayName": "bhdebrito@gmail.com",
  "ActivityId": "0HLHHIBHIQQJD:00000003",
  "TimeStamp": "2018-10-14T05:08:34Z",
  "ProcessId": 16536,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-10-14 02:08:34.771 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-10-14 02:08:34.777 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-10-14 02:08:34.782 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-10-14 02:08:34.789 -03:00 [DBG] Processing signout callback request
2018-10-14 02:08:34.815 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:08:34.846 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 02:08:34.848 -03:00 [DBG] No client front-channel logout URLs
2018-10-14 02:08:34.851 -03:00 [DBG] No client back-channel logout URLs
2018-10-14 02:08:34.853 -03:00 [INF] Successful signout callback.
2018-10-14 02:08:34.855 -03:00 [DBG] No client front-channel iframe urls
2018-10-14 02:08:34.860 -03:00 [DBG] No client back-channel iframe urls
2018-10-14 02:08:37.310 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 02:08:37.318 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:08:37.325 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:08:37.347 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 02:08:37.353 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 02:08:37.359 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 02:08:37.364 -03:00 [DBG] Start discovery request
2018-10-14 02:08:37.388 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 02:08:37.432 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 02:08:37.440 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:08:37.443 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:08:37.446 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 02:08:37.451 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 02:08:37.454 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 02:08:37.457 -03:00 [DBG] Start key discovery request
2018-10-14 02:08:37.504 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-10-14 02:08:37.511 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-10-14 02:08:37.516 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-10-14 02:08:37.520 -03:00 [DBG] Start authorize request
2018-10-14 02:08:37.523 -03:00 [DBG] No user present in authorize request
2018-10-14 02:08:37.525 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:08:37.548 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:08:37.556 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:08:37.568 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:08:37.574 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:08:37.585 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:08:37.589 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:08:37.592 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email jp_api.user",
  "State": "ldAcYLbLppZaaVulLHsFCw5jydllxjgY1YCHvVD8",
  "Nonce": "ldAcYLbLppZaaVulLHsFCw5jydllxjgY1YCHvVD8",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "ldAcYLbLppZaaVulLHsFCw5jydllxjgY1YCHvVD8",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email jp_api.user",
    "nonce": "ldAcYLbLppZaaVulLHsFCw5jydllxjgY1YCHvVD8"
  }
}
2018-10-14 02:08:37.597 -03:00 [INF] Showing login: User is not authenticated
2018-10-14 02:08:37.637 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:08:37.655 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:08:37.661 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:08:37.670 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:08:37.676 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:08:37.688 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:08:37.693 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:08:37.722 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:08:41.284 -03:00 [INF] AuthenticationScheme: Google was challenged.
2018-10-14 02:08:54.258 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:08:54.283 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:08:54.291 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:08:54.308 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:08:54.316 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:08:54.331 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:08:54.335 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:08:54.360 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:00.688 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 02:09:00.695 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:09:00.704 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:09:00.709 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 02:09:00.730 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 02:09:00.741 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 02:09:00.748 -03:00 [DBG] Start discovery request
2018-10-14 02:09:00.773 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 02:09:00.808 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 02:09:00.819 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:09:00.826 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:09:00.830 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 02:09:00.835 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 02:09:00.839 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 02:09:00.844 -03:00 [DBG] Start key discovery request
2018-10-14 02:09:00.939 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-10-14 02:09:00.948 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-10-14 02:09:00.952 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-10-14 02:09:00.956 -03:00 [DBG] Start authorize request
2018-10-14 02:09:00.958 -03:00 [DBG] No user present in authorize request
2018-10-14 02:09:00.961 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:09:00.980 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:00.988 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:01.008 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:01.015 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:01.032 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:01.035 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:09:01.038 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email jp_api.user",
  "State": "2iEDefg9KKfnFMN4ceX5GuBzkDAysCC5ZQ5sDLW4",
  "Nonce": "2iEDefg9KKfnFMN4ceX5GuBzkDAysCC5ZQ5sDLW4",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "2iEDefg9KKfnFMN4ceX5GuBzkDAysCC5ZQ5sDLW4",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email jp_api.user",
    "nonce": "2iEDefg9KKfnFMN4ceX5GuBzkDAysCC5ZQ5sDLW4"
  }
}
2018-10-14 02:09:01.044 -03:00 [INF] Showing login: User is not authenticated
2018-10-14 02:09:01.052 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:09:01.070 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:01.077 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:01.086 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:01.091 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:01.104 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:01.108 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:09:01.125 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:02.949 -03:00 [INF] AuthenticationScheme: Google was challenged.
2018-10-14 02:09:14.790 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:09:14.813 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:14.821 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:14.835 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:14.843 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:14.857 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:14.861 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:09:14.884 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:21.494 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:09:21.523 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:21.533 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:21.547 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:21.555 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:21.571 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:21.575 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:09:21.599 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:27.284 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 02:09:27.291 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:09:27.295 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:09:27.299 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 02:09:27.303 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 02:09:27.307 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 02:09:27.310 -03:00 [DBG] Start discovery request
2018-10-14 02:09:27.327 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 02:09:27.389 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 02:09:27.396 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:09:27.404 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:09:27.407 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 02:09:27.413 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 02:09:27.416 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 02:09:27.419 -03:00 [DBG] Start key discovery request
2018-10-14 02:09:27.463 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-10-14 02:09:27.470 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-10-14 02:09:27.474 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-10-14 02:09:27.479 -03:00 [DBG] Start authorize request
2018-10-14 02:09:27.481 -03:00 [DBG] No user present in authorize request
2018-10-14 02:09:27.487 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:09:27.506 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:27.514 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:27.527 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:27.534 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:27.545 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:27.550 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:09:27.554 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email jp_api.user",
  "State": "yKAMmeKMGqBVddQyvmZ68vNoN1dz1gasaQ4OUy5L",
  "Nonce": "yKAMmeKMGqBVddQyvmZ68vNoN1dz1gasaQ4OUy5L",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "yKAMmeKMGqBVddQyvmZ68vNoN1dz1gasaQ4OUy5L",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email jp_api.user",
    "nonce": "yKAMmeKMGqBVddQyvmZ68vNoN1dz1gasaQ4OUy5L"
  }
}
2018-10-14 02:09:27.561 -03:00 [INF] Showing login: User is not authenticated
2018-10-14 02:09:27.569 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:09:27.592 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:27.599 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:27.611 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:27.616 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:27.625 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:27.628 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:09:27.646 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:28.833 -03:00 [INF] AuthenticationScheme: Google was challenged.
2018-10-14 02:09:37.595 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:09:37.616 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:37.623 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:37.636 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:37.644 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:37.657 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:37.661 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:09:37.683 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:38.720 -03:00 [INF] AuthenticationScheme: Facebook was challenged.
2018-10-14 02:09:39.730 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-10-14 02:09:39.974 -03:00 [WRN] User ec9c70b1-1f3c-4458-8e8d-7883199c11e6 validation failed: DuplicateUserName.
2018-10-14 02:09:42.815 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:09:42.839 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:42.847 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:42.861 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:42.869 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:42.882 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:42.887 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:09:42.911 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:51.564 -03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-10-14 02:09:51.710 -03:00 [DBG] Augmenting SignInContext
2018-10-14 02:09:51.716 -03:00 [DBG] Adding idp claim with value: local
2018-10-14 02:09:51.719 -03:00 [DBG] Adding amr claim with value: pwd
2018-10-14 02:09:51.722 -03:00 [DBG] Adding auth_time claim with value: 1539493791
2018-10-14 02:09:51.728 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-10-14 02:09:51.736 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "bruno",
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "DisplayName": "bruno",
  "Endpoint": "UI",
  "ActivityId": "0HLHHIBHIQQJH:00000016",
  "TimeStamp": "2018-10-14T05:09:51Z",
  "ProcessId": 16536,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-10-14 02:09:51.746 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-10-14 02:09:51.751 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-10-14 02:09:51.755 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-10-14 02:09:51.762 -03:00 [DBG] Start authorize callback request
2018-10-14 02:09:51.768 -03:00 [DBG] User in authorize request: 08d630d3-c89f-e2ef-a358-559ea4ad9dad
2018-10-14 02:09:51.771 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:09:51.790 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:51.796 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:51.807 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:51.812 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:51.822 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:09:51.825 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:09:51.828 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback"
  ],
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email jp_api.user",
  "State": "yKAMmeKMGqBVddQyvmZ68vNoN1dz1gasaQ4OUy5L",
  "Nonce": "yKAMmeKMGqBVddQyvmZ68vNoN1dz1gasaQ4OUy5L",
  "SessionId": "0a769d2f24518ec13eac343f6871a924",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "yKAMmeKMGqBVddQyvmZ68vNoN1dz1gasaQ4OUy5L",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email jp_api.user",
    "nonce": "yKAMmeKMGqBVddQyvmZ68vNoN1dz1gasaQ4OUy5L"
  }
}
2018-10-14 02:09:51.838 -03:00 [DBG] M7Imqp1yPU4pCxFvLqxrbgd/81DG0hJr2wTmQ57JSgM= found in database: true
2018-10-14 02:09:51.843 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-10-14 02:09:51.846 -03:00 [DBG] Creating Implicit Flow response.
2018-10-14 02:09:51.849 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-10-14 02:09:51.851 -03:00 [DBG] Getting claims for access token for subject: 08d630d3-c89f-e2ef-a358-559ea4ad9dad
2018-10-14 02:09:51.874 -03:00 [DBG] Getting claims for identity token for subject: 08d630d3-c89f-e2ef-a358-559ea4ad9dad and client: UserManagementUI
2018-10-14 02:09:51.877 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-10-14 02:09:51.882 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "Scopes": "openid profile email jp_api.user",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Kl8g"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****eyXA"
    }
  ],
  "ActivityId": "0HLHHIBHIQQJH:00000017",
  "TimeStamp": "2018-10-14T05:09:51Z",
  "ProcessId": 16536,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-10-14 02:09:51.891 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "yKAMmeKMGqBVddQyvmZ68vNoN1dz1gasaQ4OUy5L",
  "Scope": "openid profile email jp_api.user"
}
2018-10-14 02:09:51.898 -03:00 [DBG] Augmenting SignInContext
2018-10-14 02:09:51.900 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-10-14 02:09:53.329 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 02:09:53.337 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:09:53.341 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:09:53.345 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 02:09:53.348 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 02:09:53.352 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 02:09:53.356 -03:00 [DBG] Start discovery request
2018-10-14 02:09:53.373 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 02:09:53.430 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 02:09:53.442 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:09:53.446 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:09:53.449 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 02:09:53.453 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 02:09:53.457 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 02:09:53.460 -03:00 [DBG] Start key discovery request
2018-10-14 02:09:54.593 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 02:09:54.602 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:09:54.606 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:09:54.669 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 02:09:54.679 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:09:54.685 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:09:54.689 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 02:09:54.693 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 02:09:54.698 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 02:09:54.702 -03:00 [DBG] Start userinfo request
2018-10-14 02:09:54.705 -03:00 [DBG] Bearer token found in header
2018-10-14 02:09:54.728 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:54.745 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:54.754 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 02:09:54.757 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539493791,
    "exp": 1539497391,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "UserManagementUI",
    "sub": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
    "auth_time": 1539493791,
    "idp": "local",
    "is4-rights": "manager",
    "username": "bruno",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.user"
    ],
    "amr": "pwd"
  }
}
2018-10-14 02:09:54.761 -03:00 [DBG] Creating userinfo response
2018-10-14 02:09:54.763 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:09:54.766 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:09:54.772 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:54.775 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 02:09:54.780 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:09:54.785 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:54.804 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 02:09:54.807 -03:00 [DBG] End userinfo request
2018-10-14 02:09:57.129 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 02:09:57.139 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:09:57.147 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:09:57.151 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 02:09:57.157 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 02:09:57.161 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 02:09:57.165 -03:00 [DBG] Start userinfo request
2018-10-14 02:09:57.168 -03:00 [DBG] Bearer token found in header
2018-10-14 02:09:57.194 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:57.217 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:09:57.227 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 02:09:57.231 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539493791,
    "exp": 1539497391,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "UserManagementUI",
    "sub": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
    "auth_time": 1539493791,
    "idp": "local",
    "is4-rights": "manager",
    "username": "bruno",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.user"
    ],
    "amr": "pwd"
  }
}
2018-10-14 02:09:57.237 -03:00 [DBG] Creating userinfo response
2018-10-14 02:09:57.240 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:09:57.244 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:09:57.251 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:57.255 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 02:09:57.259 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:09:57.266 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:09:57.285 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 02:09:57.289 -03:00 [DBG] End userinfo request
2018-10-14 02:10:16.145 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 02:10:16.152 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:10:16.156 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:10:16.160 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 02:10:16.163 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 02:10:16.167 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 02:10:16.173 -03:00 [DBG] Start discovery request
2018-10-14 02:10:16.192 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 02:10:16.212 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 02:10:16.219 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:10:16.222 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:10:16.226 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 02:10:16.230 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 02:10:16.235 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 02:10:16.240 -03:00 [DBG] Start key discovery request
2018-10-14 02:10:22.001 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 02:10:22.008 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:10:22.013 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:10:22.019 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 02:10:22.026 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 02:10:22.030 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 02:10:22.035 -03:00 [DBG] Start discovery request
2018-10-14 02:10:22.054 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 02:10:22.083 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 02:10:22.092 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:10:22.096 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:10:22.100 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 02:10:22.105 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 02:10:22.109 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 02:10:22.113 -03:00 [DBG] Start key discovery request
2018-10-14 02:10:22.194 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-10-14 02:10:22.199 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-10-14 02:10:22.204 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-10-14 02:10:22.208 -03:00 [DBG] Start authorize request
2018-10-14 02:10:22.210 -03:00 [DBG] No user present in authorize request
2018-10-14 02:10:22.213 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:10:22.233 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:10:22.241 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:10:22.257 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:10:22.263 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:10:22.276 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:10:22.281 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:10:22.284 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email jp_api.user",
  "State": "t3PItclNhEN9RtE1g16PpC8tEIhq6mWiTUl9hm2h",
  "Nonce": "t3PItclNhEN9RtE1g16PpC8tEIhq6mWiTUl9hm2h",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "t3PItclNhEN9RtE1g16PpC8tEIhq6mWiTUl9hm2h",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email jp_api.user",
    "nonce": "t3PItclNhEN9RtE1g16PpC8tEIhq6mWiTUl9hm2h"
  }
}
2018-10-14 02:10:22.289 -03:00 [INF] Showing login: User is not authenticated
2018-10-14 02:10:22.297 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:10:22.317 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:10:22.324 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:10:22.337 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:10:22.344 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:10:22.354 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:10:22.357 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:10:22.378 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:10:30.541 -03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-10-14 02:10:30.585 -03:00 [DBG] Augmenting SignInContext
2018-10-14 02:10:30.589 -03:00 [DBG] Adding idp claim with value: local
2018-10-14 02:10:30.592 -03:00 [DBG] Adding amr claim with value: pwd
2018-10-14 02:10:30.596 -03:00 [DBG] Adding auth_time claim with value: 1539493830
2018-10-14 02:10:30.599 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-10-14 02:10:30.603 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "bruno",
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "DisplayName": "bruno",
  "Endpoint": "UI",
  "ActivityId": "0HLHHIBHIQQJH:0000001B",
  "TimeStamp": "2018-10-14T05:10:30Z",
  "ProcessId": 16536,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-10-14 02:10:30.614 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-10-14 02:10:30.619 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-10-14 02:10:30.624 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-10-14 02:10:30.629 -03:00 [DBG] Start authorize callback request
2018-10-14 02:10:30.632 -03:00 [DBG] User in authorize request: 08d630d3-c89f-e2ef-a358-559ea4ad9dad
2018-10-14 02:10:30.636 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:10:30.660 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:10:30.667 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:10:30.680 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:10:30.688 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:10:30.702 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:10:30.706 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:10:30.710 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback"
  ],
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email jp_api.user",
  "State": "t3PItclNhEN9RtE1g16PpC8tEIhq6mWiTUl9hm2h",
  "Nonce": "t3PItclNhEN9RtE1g16PpC8tEIhq6mWiTUl9hm2h",
  "SessionId": "2cf33e0891a401cdb3d793c298b94a67",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "t3PItclNhEN9RtE1g16PpC8tEIhq6mWiTUl9hm2h",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email jp_api.user",
    "nonce": "t3PItclNhEN9RtE1g16PpC8tEIhq6mWiTUl9hm2h"
  }
}
2018-10-14 02:10:30.729 -03:00 [DBG] M7Imqp1yPU4pCxFvLqxrbgd/81DG0hJr2wTmQ57JSgM= found in database: true
2018-10-14 02:10:30.735 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-10-14 02:10:30.738 -03:00 [DBG] Creating Implicit Flow response.
2018-10-14 02:10:30.740 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-10-14 02:10:30.743 -03:00 [DBG] Getting claims for access token for subject: 08d630d3-c89f-e2ef-a358-559ea4ad9dad
2018-10-14 02:10:30.765 -03:00 [DBG] Getting claims for identity token for subject: 08d630d3-c89f-e2ef-a358-559ea4ad9dad and client: UserManagementUI
2018-10-14 02:10:30.768 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-10-14 02:10:30.773 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "Scopes": "openid profile email jp_api.user",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****9bAw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****rdNw"
    }
  ],
  "ActivityId": "0HLHHIBHIQQJH:0000001C",
  "TimeStamp": "2018-10-14T05:10:30Z",
  "ProcessId": 16536,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-10-14 02:10:30.779 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "t3PItclNhEN9RtE1g16PpC8tEIhq6mWiTUl9hm2h",
  "Scope": "openid profile email jp_api.user"
}
2018-10-14 02:10:30.782 -03:00 [DBG] Augmenting SignInContext
2018-10-14 02:10:30.784 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-10-14 02:10:32.222 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 02:10:32.229 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:10:32.233 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:10:32.236 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 02:10:32.240 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 02:10:32.244 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 02:10:32.250 -03:00 [DBG] Start discovery request
2018-10-14 02:10:32.266 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 02:10:32.319 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 02:10:32.326 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:10:32.331 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:10:32.335 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 02:10:32.339 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 02:10:32.343 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 02:10:32.347 -03:00 [DBG] Start key discovery request
2018-10-14 02:10:33.481 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 02:10:33.487 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:10:33.491 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:10:33.548 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 02:10:33.557 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:10:33.560 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:10:33.564 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 02:10:33.568 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 02:10:33.572 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 02:10:33.576 -03:00 [DBG] Start userinfo request
2018-10-14 02:10:33.578 -03:00 [DBG] Bearer token found in header
2018-10-14 02:10:33.602 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:10:33.628 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:10:33.639 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 02:10:33.642 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539493830,
    "exp": 1539497430,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "UserManagementUI",
    "sub": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
    "auth_time": 1539493830,
    "idp": "local",
    "is4-rights": "manager",
    "username": "bruno",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.user"
    ],
    "amr": "pwd"
  }
}
2018-10-14 02:10:33.649 -03:00 [DBG] Creating userinfo response
2018-10-14 02:10:33.652 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:10:33.656 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:10:33.663 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:10:33.668 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 02:10:33.671 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:10:33.678 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:10:33.700 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 02:10:33.704 -03:00 [DBG] End userinfo request
2018-10-14 02:14:28.338 -03:00 [INF] SigninCredentialExtension keyType is Temporary
2018-10-14 02:14:28.470 -03:00 [INF] SigninCredentialExtension added
2018-10-14 02:14:32.627 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-10-14 02:14:32.646 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-10-14 02:14:32.648 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-10-14 02:14:32.650 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-10-14 02:14:32.656 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-10-14 02:14:33.004 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 02:14:33.154 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:14:33.163 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:14:33.202 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 02:14:33.210 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 02:14:33.213 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 02:14:33.219 -03:00 [DBG] Start discovery request
2018-10-14 02:14:33.496 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 02:14:33.543 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 02:14:33.552 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:14:33.555 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:14:33.558 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 02:14:33.562 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 02:14:33.565 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 02:14:33.571 -03:00 [DBG] Start key discovery request
2018-10-14 02:14:33.624 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 02:14:33.634 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:14:33.638 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:14:33.739 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 02:14:33.754 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:14:33.758 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:14:33.762 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 02:14:33.770 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 02:14:33.774 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 02:14:33.784 -03:00 [DBG] Start userinfo request
2018-10-14 02:14:33.793 -03:00 [DBG] Bearer token found in header
2018-10-14 02:14:34.025 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:14:34.051 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:14:34.083 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 02:14:34.093 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539493830,
    "exp": 1539497430,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "UserManagementUI",
    "sub": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
    "auth_time": 1539493830,
    "idp": "local",
    "is4-rights": "manager",
    "username": "bruno",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.user"
    ],
    "amr": "pwd"
  }
}
2018-10-14 02:14:34.113 -03:00 [DBG] Creating userinfo response
2018-10-14 02:14:34.119 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:14:34.125 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:14:34.151 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:14:34.156 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 02:14:34.159 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:14:34.165 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:14:34.306 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 02:14:34.309 -03:00 [DBG] End userinfo request
2018-10-14 02:15:11.329 -03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Authentication failed because the remote party has closed the transport stream.
   at System.Net.Security.SslState.StartReadFrame(Byte[] buffer, Int32 readBytes, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.PartialFrameCallback(AsyncProtocolRequest asyncRequest)
--- End of stack trace from previous location where exception was thrown ---
   at System.Net.Security.SslState.ThrowIfExceptional()
   at System.Net.Security.SslState.InternalEndProcessAuthentication(LazyAsyncResult lazyResult)
   at System.Net.Security.SslState.EndProcessAuthentication(IAsyncResult result)
   at System.Net.Security.SslStream.EndAuthenticateAsServer(IAsyncResult asyncResult)
   at System.Net.Security.SslStream.<>c.<AuthenticateAsServerAsync>b__51_1(IAsyncResult iar)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionAdapter.InnerOnConnectionAsync(ConnectionAdapterContext context)
2018-10-14 02:15:11.329 -03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Authentication failed because the remote party has closed the transport stream.
   at System.Net.Security.SslState.StartReadFrame(Byte[] buffer, Int32 readBytes, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.PartialFrameCallback(AsyncProtocolRequest asyncRequest)
--- End of stack trace from previous location where exception was thrown ---
   at System.Net.Security.SslState.ThrowIfExceptional()
   at System.Net.Security.SslState.InternalEndProcessAuthentication(LazyAsyncResult lazyResult)
   at System.Net.Security.SslState.EndProcessAuthentication(IAsyncResult result)
   at System.Net.Security.SslStream.EndAuthenticateAsServer(IAsyncResult asyncResult)
   at System.Net.Security.SslStream.<>c.<AuthenticateAsServerAsync>b__51_1(IAsyncResult iar)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionAdapter.InnerOnConnectionAsync(ConnectionAdapterContext context)
2018-10-14 02:15:46.208 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 02:15:46.214 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:15:46.219 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:15:46.225 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 02:15:46.229 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 02:15:46.242 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 02:15:46.249 -03:00 [DBG] Start discovery request
2018-10-14 02:15:46.271 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 02:15:46.546 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 02:15:46.553 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:15:46.556 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:15:46.560 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 02:15:46.563 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 02:15:46.567 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 02:15:46.574 -03:00 [DBG] Start key discovery request
2018-10-14 02:15:49.458 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 02:15:49.464 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:15:49.469 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:15:49.474 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 02:15:49.477 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 02:15:49.481 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 02:15:49.487 -03:00 [DBG] Start discovery request
2018-10-14 02:15:49.506 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 02:15:49.536 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 02:15:49.543 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:15:49.546 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:15:49.549 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 02:15:49.553 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 02:15:49.556 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 02:15:49.559 -03:00 [DBG] Start key discovery request
2018-10-14 02:15:49.651 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-10-14 02:15:49.661 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-10-14 02:15:49.664 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-10-14 02:15:49.670 -03:00 [DBG] Start authorize request
2018-10-14 02:15:49.681 -03:00 [DBG] User in authorize request: 08d630d3-c89f-e2ef-a358-559ea4ad9dad
2018-10-14 02:15:49.692 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 02:15:49.721 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:15:49.747 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:15:49.790 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:15:49.803 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:15:49.813 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 02:15:49.822 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 02:15:49.831 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback"
  ],
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email jp_api.user",
  "State": "DB17gjebOJ6YmfKTWUCvaROxRUnzM8bYy1YYUFUe",
  "Nonce": "DB17gjebOJ6YmfKTWUCvaROxRUnzM8bYy1YYUFUe",
  "SessionId": "2cf33e0891a401cdb3d793c298b94a67",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "DB17gjebOJ6YmfKTWUCvaROxRUnzM8bYy1YYUFUe",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email jp_api.user",
    "nonce": "DB17gjebOJ6YmfKTWUCvaROxRUnzM8bYy1YYUFUe"
  }
}
2018-10-14 02:15:49.899 -03:00 [DBG] M7Imqp1yPU4pCxFvLqxrbgd/81DG0hJr2wTmQ57JSgM= found in database: true
2018-10-14 02:15:49.908 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-10-14 02:15:49.920 -03:00 [DBG] Creating Implicit Flow response.
2018-10-14 02:15:49.930 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-10-14 02:15:49.933 -03:00 [DBG] Getting claims for access token for subject: 08d630d3-c89f-e2ef-a358-559ea4ad9dad
2018-10-14 02:15:49.990 -03:00 [DBG] Getting claims for identity token for subject: 08d630d3-c89f-e2ef-a358-559ea4ad9dad and client: UserManagementUI
2018-10-14 02:15:49.993 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-10-14 02:15:50.012 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "Scopes": "openid profile email jp_api.user",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****9FZg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****MmRA"
    }
  ],
  "ActivityId": "0HLHHIFMIUQ18:00000001",
  "TimeStamp": "2018-10-14T05:15:50Z",
  "ProcessId": 29512,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-10-14 02:15:50.020 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "DB17gjebOJ6YmfKTWUCvaROxRUnzM8bYy1YYUFUe",
  "Scope": "openid profile email jp_api.user"
}
2018-10-14 02:15:51.035 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 02:15:51.042 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:15:51.055 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:15:51.060 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 02:15:51.065 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 02:15:51.069 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 02:15:51.072 -03:00 [DBG] Start discovery request
2018-10-14 02:15:51.088 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 02:15:51.143 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 02:15:51.149 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:15:51.153 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:15:51.156 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 02:15:51.159 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 02:15:51.163 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 02:15:51.166 -03:00 [DBG] Start key discovery request
2018-10-14 02:15:52.303 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 02:15:52.310 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:15:52.313 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:15:52.360 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 02:15:52.368 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 02:15:52.371 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 02:15:52.376 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 02:15:52.379 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 02:15:52.383 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 02:15:52.386 -03:00 [DBG] Start userinfo request
2018-10-14 02:15:52.390 -03:00 [DBG] Bearer token found in header
2018-10-14 02:15:52.411 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:15:52.432 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 02:15:52.441 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 02:15:52.446 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539494149,
    "exp": 1539497749,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "UserManagementUI",
    "sub": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
    "auth_time": 1539493830,
    "idp": "local",
    "is4-rights": "manager",
    "username": "bruno",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.user"
    ],
    "amr": "pwd"
  }
}
2018-10-14 02:15:52.452 -03:00 [DBG] Creating userinfo response
2018-10-14 02:15:52.455 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:15:52.458 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:15:52.464 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:15:52.467 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 02:15:52.469 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 02:15:52.475 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 02:15:52.493 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 02:15:52.496 -03:00 [DBG] End userinfo request
2018-10-14 12:35:55.948 -03:00 [INF] SigninCredentialExtension keyType is Temporary
2018-10-14 12:35:56.209 -03:00 [INF] SigninCredentialExtension added
2018-10-14 12:36:01.248 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-10-14 12:36:01.267 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-10-14 12:36:01.271 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-10-14 12:36:01.274 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-10-14 12:36:01.280 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-10-14 12:51:20.010 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 12:51:20.148 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 12:51:20.154 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 12:51:20.187 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 12:51:20.195 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 12:51:20.197 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 12:51:20.203 -03:00 [DBG] Start discovery request
2018-10-14 12:51:20.475 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 12:51:20.525 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 12:51:20.534 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 12:51:20.536 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 12:51:20.546 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 12:51:20.554 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 12:51:20.559 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 12:51:20.564 -03:00 [DBG] Start key discovery request
2018-10-14 12:51:20.808 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-10-14 12:51:20.816 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-10-14 12:51:20.820 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-10-14 12:51:20.824 -03:00 [DBG] Start authorize request
2018-10-14 12:51:20.836 -03:00 [DBG] User in authorize request: 08d630d3-c89f-e2ef-a358-559ea4ad9dad
2018-10-14 12:51:20.845 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 12:51:21.022 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 12:51:21.062 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 12:51:21.111 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 12:51:21.128 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 12:51:21.139 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 12:51:21.149 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 12:51:21.160 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback"
  ],
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email jp_api.user",
  "State": "QsEsMo4xA0HqOV90iS25lU3f3BGpy5lbucQmYPhX",
  "Nonce": "QsEsMo4xA0HqOV90iS25lU3f3BGpy5lbucQmYPhX",
  "SessionId": "2cf33e0891a401cdb3d793c298b94a67",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "QsEsMo4xA0HqOV90iS25lU3f3BGpy5lbucQmYPhX",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email jp_api.user",
    "nonce": "QsEsMo4xA0HqOV90iS25lU3f3BGpy5lbucQmYPhX"
  }
}
2018-10-14 12:51:21.238 -03:00 [DBG] M7Imqp1yPU4pCxFvLqxrbgd/81DG0hJr2wTmQ57JSgM= found in database: true
2018-10-14 12:51:21.252 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-10-14 12:51:21.262 -03:00 [DBG] Creating Implicit Flow response.
2018-10-14 12:51:21.274 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-10-14 12:51:21.278 -03:00 [DBG] Getting claims for access token for subject: 08d630d3-c89f-e2ef-a358-559ea4ad9dad
2018-10-14 12:51:21.343 -03:00 [DBG] Getting claims for identity token for subject: 08d630d3-c89f-e2ef-a358-559ea4ad9dad and client: UserManagementUI
2018-10-14 12:51:21.347 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-10-14 12:51:21.368 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "Scopes": "openid profile email jp_api.user",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****3oRg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****E95w"
    }
  ],
  "ActivityId": "0HLHHTHCGDLRO:00000001",
  "TimeStamp": "2018-10-14T15:51:21Z",
  "ProcessId": 20128,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-10-14 12:51:21.377 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "QsEsMo4xA0HqOV90iS25lU3f3BGpy5lbucQmYPhX",
  "Scope": "openid profile email jp_api.user"
}
2018-10-14 12:51:21.943 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 12:51:21.951 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 12:51:21.956 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 12:51:21.960 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 12:51:21.964 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 12:51:21.972 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 12:51:21.977 -03:00 [DBG] Start discovery request
2018-10-14 12:51:21.997 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 12:51:22.035 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 12:51:22.042 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 12:51:22.048 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 12:51:22.051 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 12:51:22.055 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 12:51:22.060 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 12:51:22.066 -03:00 [DBG] Start key discovery request
2018-10-14 12:51:23.177 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 12:51:23.185 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 12:51:23.188 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 12:51:23.272 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 12:51:23.283 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 12:51:23.290 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 12:51:23.294 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 12:51:23.302 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 12:51:23.308 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 12:51:23.326 -03:00 [DBG] Start userinfo request
2018-10-14 12:51:23.335 -03:00 [DBG] Bearer token found in header
2018-10-14 12:51:23.402 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 12:51:23.432 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 12:51:23.447 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 12:51:23.455 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539532281,
    "exp": 1539535881,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "UserManagementUI",
    "sub": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
    "auth_time": 1539493830,
    "idp": "local",
    "is4-rights": "manager",
    "username": "bruno",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.user"
    ],
    "amr": "pwd"
  }
}
2018-10-14 12:51:23.470 -03:00 [DBG] Creating userinfo response
2018-10-14 12:51:23.477 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 12:51:23.481 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 12:51:23.491 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 12:51:23.494 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 12:51:23.497 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 12:51:23.502 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 12:51:23.520 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 12:51:23.524 -03:00 [DBG] End userinfo request
2018-10-14 13:01:04.709 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 13:01:04.728 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 13:01:04.749 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 13:01:04.774 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 13:01:04.783 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 13:01:04.791 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 13:01:04.800 -03:00 [DBG] Start discovery request
2018-10-14 13:01:04.818 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 13:01:05.010 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 13:01:05.017 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 13:01:05.025 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 13:01:05.030 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 13:01:05.034 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 13:01:05.038 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 13:01:05.042 -03:00 [DBG] Start key discovery request
2018-10-14 13:01:09.930 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 13:01:09.937 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 13:01:09.942 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 13:01:09.945 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 13:01:09.950 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 13:01:09.956 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 13:01:09.960 -03:00 [DBG] Start discovery request
2018-10-14 13:01:09.977 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 13:01:10.003 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 13:01:10.011 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 13:01:10.015 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 13:01:10.020 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 13:01:10.024 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 13:01:10.027 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 13:01:10.032 -03:00 [DBG] Start key discovery request
2018-10-14 13:01:10.107 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-10-14 13:01:10.115 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-10-14 13:01:10.129 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-10-14 13:01:10.137 -03:00 [DBG] Start authorize request
2018-10-14 13:01:10.146 -03:00 [DBG] User in authorize request: 08d630d3-c89f-e2ef-a358-559ea4ad9dad
2018-10-14 13:01:10.150 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 13:01:10.177 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 13:01:10.185 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 13:01:10.198 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 13:01:10.206 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 13:01:10.217 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 13:01:10.220 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 13:01:10.224 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback"
  ],
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email jp_api.user",
  "State": "yJL6RMJ9OFfGETgB8LE8Fhh8YGTQl4q1q79XOQmW",
  "Nonce": "yJL6RMJ9OFfGETgB8LE8Fhh8YGTQl4q1q79XOQmW",
  "SessionId": "2cf33e0891a401cdb3d793c298b94a67",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "yJL6RMJ9OFfGETgB8LE8Fhh8YGTQl4q1q79XOQmW",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email jp_api.user",
    "nonce": "yJL6RMJ9OFfGETgB8LE8Fhh8YGTQl4q1q79XOQmW"
  }
}
2018-10-14 13:01:10.241 -03:00 [DBG] M7Imqp1yPU4pCxFvLqxrbgd/81DG0hJr2wTmQ57JSgM= found in database: true
2018-10-14 13:01:10.255 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-10-14 13:01:10.259 -03:00 [DBG] Creating Implicit Flow response.
2018-10-14 13:01:10.262 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-10-14 13:01:10.266 -03:00 [DBG] Getting claims for access token for subject: 08d630d3-c89f-e2ef-a358-559ea4ad9dad
2018-10-14 13:01:10.296 -03:00 [DBG] Getting claims for identity token for subject: 08d630d3-c89f-e2ef-a358-559ea4ad9dad and client: UserManagementUI
2018-10-14 13:01:10.301 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-10-14 13:01:10.308 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "Scopes": "openid profile email jp_api.user",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****RTUg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****LkoQ"
    }
  ],
  "ActivityId": "0HLHHTHCGDLRR:00000001",
  "TimeStamp": "2018-10-14T16:01:10Z",
  "ProcessId": 20128,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-10-14 13:01:10.314 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "yJL6RMJ9OFfGETgB8LE8Fhh8YGTQl4q1q79XOQmW",
  "Scope": "openid profile email jp_api.user"
}
2018-10-14 13:01:11.417 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 13:01:11.425 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 13:01:11.447 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 13:01:11.453 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 13:01:11.458 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 13:01:11.462 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 13:01:11.467 -03:00 [DBG] Start discovery request
2018-10-14 13:01:11.486 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 13:01:11.526 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 13:01:11.535 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 13:01:11.539 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 13:01:11.542 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 13:01:11.546 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 13:01:11.550 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 13:01:11.554 -03:00 [DBG] Start key discovery request
2018-10-14 13:01:12.709 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 13:01:12.717 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 13:01:12.725 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 13:01:12.785 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 13:01:12.794 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 13:01:12.798 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 13:01:12.802 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 13:01:12.807 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 13:01:12.812 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 13:01:12.816 -03:00 [DBG] Start userinfo request
2018-10-14 13:01:12.818 -03:00 [DBG] Bearer token found in header
2018-10-14 13:01:12.844 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 13:01:12.871 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 13:01:12.880 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 13:01:12.883 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539532870,
    "exp": 1539536470,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "UserManagementUI",
    "sub": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
    "auth_time": 1539493830,
    "idp": "local",
    "is4-rights": "manager",
    "username": "bruno",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.user"
    ],
    "amr": "pwd"
  }
}
2018-10-14 13:01:12.889 -03:00 [DBG] Creating userinfo response
2018-10-14 13:01:12.891 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 13:01:12.896 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 13:01:12.901 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 13:01:12.904 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 13:01:12.907 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 13:01:12.912 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 13:01:12.934 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 13:01:12.937 -03:00 [DBG] End userinfo request
2018-10-14 13:15:28.518 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4300
2018-10-14 13:15:28.543 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 13:15:28.547 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 13:15:28.551 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 13:15:28.557 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 13:15:28.561 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 13:15:28.564 -03:00 [DBG] Start discovery request
2018-10-14 13:15:28.583 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 13:15:28.610 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4300
2018-10-14 13:15:28.617 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 13:15:28.621 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 13:15:28.624 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 13:15:28.627 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 13:15:28.630 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 13:15:28.633 -03:00 [DBG] Start key discovery request
2018-10-14 13:15:28.681 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-10-14 13:15:28.685 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-10-14 13:15:28.688 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-10-14 13:15:28.692 -03:00 [DBG] Start authorize request
2018-10-14 13:15:28.696 -03:00 [DBG] User in authorize request: 08d630d3-c89f-e2ef-a358-559ea4ad9dad
2018-10-14 13:15:28.699 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 13:15:28.718 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 13:15:28.724 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 13:15:28.735 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 13:15:28.741 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 13:15:28.751 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 13:15:28.757 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 13:15:28.760 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "IS4-Admin",
  "ClientName": "IS4-Admin",
  "RedirectUri": "http://localhost:4300/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4300/login-callback"
  ],
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email jp_api.is4",
  "State": "plCv5UlibAihljjT8GjOeqlr1rrQLMgYLMMzyDV2",
  "Nonce": "plCv5UlibAihljjT8GjOeqlr1rrQLMgYLMMzyDV2",
  "SessionId": "2cf33e0891a401cdb3d793c298b94a67",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "IS4-Admin",
    "state": "plCv5UlibAihljjT8GjOeqlr1rrQLMgYLMMzyDV2",
    "redirect_uri": "http://localhost:4300/login-callback",
    "scope": "openid profile email jp_api.is4",
    "nonce": "plCv5UlibAihljjT8GjOeqlr1rrQLMgYLMMzyDV2"
  }
}
2018-10-14 13:15:28.777 -03:00 [DBG] BMREC/048dYCBs84fVzwQyEz6wb10iKLMV2Lx+u9g6I= found in database: true
2018-10-14 13:15:28.783 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-10-14 13:15:28.786 -03:00 [DBG] Creating Implicit Flow response.
2018-10-14 13:15:28.788 -03:00 [DBG] Getting claims for access token for client: IS4-Admin
2018-10-14 13:15:28.790 -03:00 [DBG] Getting claims for access token for subject: 08d630d3-c89f-e2ef-a358-559ea4ad9dad
2018-10-14 13:15:28.812 -03:00 [DBG] Getting claims for identity token for subject: 08d630d3-c89f-e2ef-a358-559ea4ad9dad and client: IS4-Admin
2018-10-14 13:15:28.815 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-10-14 13:15:28.820 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "IS4-Admin",
  "ClientName": "IS4-Admin",
  "RedirectUri": "http://localhost:4300/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "Scopes": "openid profile email jp_api.is4",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****pgog"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****f87w"
    }
  ],
  "ActivityId": "0HLHHTHCGDLRV:00000001",
  "TimeStamp": "2018-10-14T16:15:28Z",
  "ProcessId": 20128,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-10-14 13:15:28.826 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "ClientId": "IS4-Admin",
  "RedirectUri": "http://localhost:4300/login-callback",
  "State": "plCv5UlibAihljjT8GjOeqlr1rrQLMgYLMMzyDV2",
  "Scope": "openid profile email jp_api.is4"
}
2018-10-14 13:15:28.837 -03:00 [DBG] Augmenting SignInContext
2018-10-14 13:15:28.847 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-10-14 13:15:29.831 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4300
2018-10-14 13:15:29.840 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 13:15:29.845 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 13:15:29.849 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 13:15:29.854 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 13:15:29.858 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 13:15:29.862 -03:00 [DBG] Start discovery request
2018-10-14 13:15:29.884 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 13:15:29.907 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4300
2018-10-14 13:15:29.915 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 13:15:29.919 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 13:15:29.922 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 13:15:29.935 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 13:15:29.938 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 13:15:29.942 -03:00 [DBG] Start key discovery request
2018-10-14 13:15:31.090 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 13:15:31.096 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 13:15:31.099 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 13:15:31.188 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 13:15:31.196 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 13:15:31.200 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 13:15:31.204 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 13:15:31.208 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 13:15:31.213 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 13:15:31.219 -03:00 [DBG] Start userinfo request
2018-10-14 13:15:31.225 -03:00 [DBG] Bearer token found in header
2018-10-14 13:15:31.259 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 13:15:31.296 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 13:15:31.307 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 13:15:31.317 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539533728,
    "exp": 1539537328,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "IS4-Admin",
    "sub": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
    "auth_time": 1539493830,
    "idp": "local",
    "is4-rights": "manager",
    "username": "bruno",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.is4"
    ],
    "amr": "pwd"
  }
}
2018-10-14 13:15:31.324 -03:00 [DBG] Creating userinfo response
2018-10-14 13:15:31.331 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 13:15:31.336 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 13:15:31.346 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 13:15:31.350 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 13:15:31.353 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 13:15:31.361 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 13:15:31.382 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 13:15:31.386 -03:00 [DBG] End userinfo request
2018-10-14 13:15:38.961 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 13:15:38.966 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 13:15:38.969 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 13:15:38.972 -03:00 [DBG] Start discovery request
2018-10-14 13:15:38.983 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 13:15:39.041 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 13:15:39.045 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 13:15:39.048 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 13:15:39.051 -03:00 [DBG] Start key discovery request
2018-10-14 13:16:02.327 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4300
2018-10-14 13:16:02.333 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 13:16:02.336 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 13:16:02.339 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 13:16:02.343 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 13:16:02.347 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 13:16:02.352 -03:00 [DBG] Start discovery request
2018-10-14 13:16:02.368 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 13:16:02.392 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4300
2018-10-14 13:16:02.405 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 13:16:02.410 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 13:16:02.414 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 13:16:02.419 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 13:16:02.422 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 13:16:02.426 -03:00 [DBG] Start key discovery request
2018-10-14 13:16:03.049 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 13:16:03.056 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 13:16:03.059 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 13:16:03.149 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 13:16:03.158 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 13:16:03.162 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 13:16:03.166 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 13:16:03.172 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 13:16:03.178 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 13:16:03.183 -03:00 [DBG] Start userinfo request
2018-10-14 13:16:03.186 -03:00 [DBG] Bearer token found in header
2018-10-14 13:16:03.216 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 13:16:03.244 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 13:16:03.256 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 13:16:03.260 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539533728,
    "exp": 1539537328,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "IS4-Admin",
    "sub": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
    "auth_time": 1539493830,
    "idp": "local",
    "is4-rights": "manager",
    "username": "bruno",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.is4"
    ],
    "amr": "pwd"
  }
}
2018-10-14 13:16:03.268 -03:00 [DBG] Creating userinfo response
2018-10-14 13:16:03.274 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 13:16:03.281 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 13:16:03.296 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 13:16:03.302 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 13:16:03.306 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 13:16:03.321 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 13:16:03.359 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 13:16:03.367 -03:00 [DBG] End userinfo request
2018-10-14 14:04:00.896 -03:00 [INF] SigninCredentialExtension keyType is Temporary
2018-10-14 14:04:01.126 -03:00 [INF] SigninCredentialExtension added
2018-10-14 14:04:07.183 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-10-14 14:04:07.198 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-10-14 14:04:07.201 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-10-14 14:04:07.203 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-10-14 14:04:07.206 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-10-14 14:13:34.170 -03:00 [INF] SigninCredentialExtension keyType is Temporary
2018-10-14 14:13:34.326 -03:00 [INF] SigninCredentialExtension added
2018-10-14 14:13:38.506 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-10-14 14:13:38.524 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-10-14 14:13:38.526 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-10-14 14:13:38.529 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-10-14 14:13:38.534 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-10-14 14:13:42.495 -03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-10-14 14:13:42.511 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-10-14 14:13:42.514 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-10-14 14:13:42.524 -03:00 [DBG] Processing signout request for 08d630d3-c89f-e2ef-a358-559ea4ad9dad
2018-10-14 14:13:42.532 -03:00 [DBG] Start end session request validation
2018-10-14 14:13:42.546 -03:00 [DBG] Start identity token validation
2018-10-14 14:13:42.888 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:13:42.895 -03:00 [DBG] Client found: UserManagementUI / User Management UI
2018-10-14 14:13:42.920 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:13:42.930 -03:00 [DBG] Token validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1539532870,
    "exp": 1539533170,
    "iss": "https://localhost:5000",
    "aud": "UserManagementUI",
    "nonce": "yJL6RMJ9OFfGETgB8LE8Fhh8YGTQl4q1q79XOQmW",
    "iat": 1539532870,
    "at_hash": "0jt2ZNT8SwXJ9DcLUVcd0w",
    "sid": "2cf33e0891a401cdb3d793c298b94a67",
    "sub": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
    "auth_time": 1539493830,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-10-14 14:13:42.946 -03:00 [INF] End session request validation success
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "PostLogOutUri": "http://localhost:4200",
  "Raw": {
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjM1Y2JkMjU0NmQ0Mjc5MmI3MTVhYTRhN2U4MGRmODczIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1Mzk1MzI4NzAsImV4cCI6MTUzOTUzMzE3MCwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NTAwMCIsImF1ZCI6IlVzZXJNYW5hZ2VtZW50VUkiLCJub25jZSI6InlKTDZSTUo5T0ZmR0VUZ0I4TEU4RmhoOFlHVFFsNHExcTc5WE9RbVciLCJpYXQiOjE1Mzk1MzI4NzAsImF0X2hhc2giOiIwanQyWk5UOFN3WEo5RGNMVVZjZDB3Iiwic2lkIjoiMmNmMzNlMDg5MWE0MDFjZGIzZDc5M2MyOThiOTRhNjciLCJzdWIiOiIwOGQ2MzBkMy1jODlmLWUyZWYtYTM1OC01NTllYTRhZDlkYWQiLCJhdXRoX3RpbWUiOjE1Mzk0OTM4MzAsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.uR-eNdkreijUmacSpKqUo0fr-GzFGtEP3Ssw9em-9lGxompvsBoRdXK7zxPbqb_KcbCMGLgRTp2vdemGrHQZoR2iBS2rIj6Bg_WsUQrTOH-0yJBEOlPscmqO6ddT_8JSszq59KuO-CqUl26g2v19BcFC7lahbkUygHU2be2QC_4_FBJVv2MFFW7LhzfleQSNeApQw5AVzco1ZhhQckC7hEv9JheqXdj3I_Cvb3XXP2dHTwgeYTeeD7pSr2x1EWW2_5La3HcqyKYQB-kDinBPZB6vYMK9ygGYRHLzEs63WejpMz-diG8OFUiATwfJ0O_xIPkU8_mjXGLJ3IuFUZRTUg",
    "post_logout_redirect_uri": "http://localhost:4200"
  }
}
2018-10-14 14:13:42.951 -03:00 [DBG] Success validating end session request from UserManagementUI
2018-10-14 14:13:43.183 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-10-14 14:13:43.188 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-10-14 14:13:43.192 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-10-14 14:13:43.207 -03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "08d630d3-c89f-e2ef-a358-559ea4ad9dad",
  "DisplayName": "bruno",
  "ActivityId": "0HLHHV1I166K7:00000002",
  "TimeStamp": "2018-10-14T17:13:43Z",
  "ProcessId": 21860,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-10-14 14:13:43.549 -03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-10-14 14:13:43.556 -03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-10-14 14:13:43.559 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-10-14 14:13:43.570 -03:00 [DBG] Processing signout callback request
2018-10-14 14:13:43.608 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:13:43.632 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:13:43.634 -03:00 [DBG] No client front-channel logout URLs
2018-10-14 14:13:43.637 -03:00 [DBG] No client back-channel logout URLs
2018-10-14 14:13:43.639 -03:00 [INF] Successful signout callback.
2018-10-14 14:13:43.642 -03:00 [DBG] No client front-channel iframe urls
2018-10-14 14:13:43.649 -03:00 [DBG] No client back-channel iframe urls
2018-10-14 14:13:47.784 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 14:13:47.828 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:13:47.844 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:13:47.850 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:13:47.858 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:13:47.861 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:13:47.870 -03:00 [DBG] Start discovery request
2018-10-14 14:13:48.099 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:13:48.124 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 14:13:48.131 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:13:48.134 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:13:48.137 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:13:48.141 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:13:48.146 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:13:48.156 -03:00 [DBG] Start key discovery request
2018-10-14 14:13:48.194 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-10-14 14:13:48.204 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-10-14 14:13:48.209 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-10-14 14:13:48.217 -03:00 [DBG] Start authorize request
2018-10-14 14:13:48.225 -03:00 [DBG] No user present in authorize request
2018-10-14 14:13:48.233 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 14:13:48.267 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:13:48.324 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:13:48.371 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 14:13:48.385 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:13:48.395 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 14:13:48.405 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 14:13:48.413 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email jp_api.user",
  "State": "tspun6j7kT1h13YccTjH3ZH54bS2vMqlsTpZEhMd",
  "Nonce": "tspun6j7kT1h13YccTjH3ZH54bS2vMqlsTpZEhMd",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "tspun6j7kT1h13YccTjH3ZH54bS2vMqlsTpZEhMd",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email jp_api.user",
    "nonce": "tspun6j7kT1h13YccTjH3ZH54bS2vMqlsTpZEhMd"
  }
}
2018-10-14 14:13:48.434 -03:00 [INF] Showing login: User is not authenticated
2018-10-14 14:13:48.467 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 14:13:48.484 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:13:48.489 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:13:48.500 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 14:13:48.506 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:13:48.516 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 14:13:48.519 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 14:13:48.537 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:13:57.043 -03:00 [INF] AuthenticationScheme: Google was challenged.
2018-10-14 14:14:01.395 -03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-10-14 14:14:01.500 -03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "Google",
  "ProviderUserId": "102696868227620762147",
  "SubjectId": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
  "DisplayName": "bhdebrito@gmail.com",
  "Endpoint": "UI",
  "ActivityId": "0HLHHV1I166K9:00000005",
  "TimeStamp": "2018-10-14T17:14:01Z",
  "ProcessId": 21860,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-10-14 14:14:01.512 -03:00 [DBG] Augmenting SignInContext
2018-10-14 14:14:01.517 -03:00 [DBG] Adding amr claim with value: external
2018-10-14 14:14:01.523 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-10-14 14:14:01.526 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-10-14 14:14:01.560 -03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-10-14 14:14:01.565 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-10-14 14:14:01.569 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-10-14 14:14:01.579 -03:00 [DBG] Start authorize callback request
2018-10-14 14:14:01.585 -03:00 [DBG] User in authorize request: d36b7160-b58b-4e68-8d0a-fe959d445f4b
2018-10-14 14:14:01.588 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 14:14:01.607 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:14:01.613 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:14:01.622 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 14:14:01.630 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:14:01.643 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 14:14:01.646 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 14:14:01.649 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback"
  ],
  "SubjectId": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email jp_api.user",
  "State": "tspun6j7kT1h13YccTjH3ZH54bS2vMqlsTpZEhMd",
  "Nonce": "tspun6j7kT1h13YccTjH3ZH54bS2vMqlsTpZEhMd",
  "SessionId": "f313a49fa663c1f1df4906607518da7a",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "tspun6j7kT1h13YccTjH3ZH54bS2vMqlsTpZEhMd",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email jp_api.user",
    "nonce": "tspun6j7kT1h13YccTjH3ZH54bS2vMqlsTpZEhMd"
  }
}
2018-10-14 14:14:01.705 -03:00 [DBG] CQw7PQZzv0X/POAfOZXAe9WpvFJDwBmfVs0+A8o4zoM= found in database: true
2018-10-14 14:14:01.712 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-10-14 14:14:01.722 -03:00 [DBG] Creating Implicit Flow response.
2018-10-14 14:14:01.733 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-10-14 14:14:01.736 -03:00 [DBG] Getting claims for access token for subject: d36b7160-b58b-4e68-8d0a-fe959d445f4b
2018-10-14 14:14:01.782 -03:00 [DBG] Getting claims for identity token for subject: d36b7160-b58b-4e68-8d0a-fe959d445f4b and client: UserManagementUI
2018-10-14 14:14:01.786 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-10-14 14:14:01.800 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
  "Scopes": "openid profile email jp_api.user",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****qv3g"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****fjtw"
    }
  ],
  "ActivityId": "0HLHHV1I166K9:00000006",
  "TimeStamp": "2018-10-14T17:14:01Z",
  "ProcessId": 21860,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-10-14 14:14:01.810 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "tspun6j7kT1h13YccTjH3ZH54bS2vMqlsTpZEhMd",
  "Scope": "openid profile email jp_api.user"
}
2018-10-14 14:14:01.823 -03:00 [DBG] Augmenting SignInContext
2018-10-14 14:14:01.826 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-10-14 14:14:03.381 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 14:14:03.387 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:14:03.398 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:14:03.401 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:14:03.406 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:14:03.414 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:14:03.419 -03:00 [DBG] Start discovery request
2018-10-14 14:14:03.443 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:14:03.495 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 14:14:03.502 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:14:03.507 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:14:03.512 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:14:03.516 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:14:03.522 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:14:03.526 -03:00 [DBG] Start key discovery request
2018-10-14 14:14:04.687 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 14:14:04.696 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:14:04.700 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:14:04.775 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 14:14:04.782 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:14:04.786 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:14:04.791 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:14:04.796 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:14:04.801 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:14:04.810 -03:00 [DBG] Start userinfo request
2018-10-14 14:14:04.816 -03:00 [DBG] Bearer token found in header
2018-10-14 14:14:04.848 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:14:04.866 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:14:04.876 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:14:04.879 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539537241,
    "exp": 1539540841,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "UserManagementUI",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.user"
    ],
    "amr": "external"
  }
}
2018-10-14 14:14:04.890 -03:00 [DBG] Creating userinfo response
2018-10-14 14:14:04.894 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 14:14:04.899 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 14:14:04.906 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:14:04.910 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:14:04.912 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 14:14:04.917 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:14:04.929 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:14:04.932 -03:00 [DBG] End userinfo request
2018-10-14 14:15:12.793 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:15:12.797 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:15:12.800 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:15:12.803 -03:00 [DBG] Start discovery request
2018-10-14 14:15:12.814 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:15:12.862 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:15:12.868 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:15:12.871 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:15:12.874 -03:00 [DBG] Start key discovery request
2018-10-14 14:16:11.285 -03:00 [INF] SigninCredentialExtension keyType is Temporary
2018-10-14 14:16:11.442 -03:00 [INF] SigninCredentialExtension added
2018-10-14 14:16:15.587 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-10-14 14:16:15.602 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-10-14 14:16:15.605 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-10-14 14:16:15.607 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-10-14 14:16:15.612 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-10-14 14:16:21.157 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 14:16:21.320 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:16:21.329 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:16:21.373 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:16:21.384 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:16:21.404 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:16:21.414 -03:00 [DBG] Start discovery request
2018-10-14 14:16:21.749 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:16:21.801 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 14:16:21.813 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:16:21.818 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:16:21.821 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:16:21.825 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:16:21.830 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:16:21.838 -03:00 [DBG] Start key discovery request
2018-10-14 14:16:21.910 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 14:16:21.920 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:16:21.925 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:16:22.052 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 14:16:22.068 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:16:22.076 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:16:22.087 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:16:22.094 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:16:22.100 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:16:22.110 -03:00 [DBG] Start userinfo request
2018-10-14 14:16:22.118 -03:00 [DBG] Bearer token found in header
2018-10-14 14:16:22.409 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:16:22.436 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:16:22.479 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:16:22.498 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539537241,
    "exp": 1539540841,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "UserManagementUI",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.user"
    ],
    "amr": "external"
  }
}
2018-10-14 14:16:22.513 -03:00 [DBG] Creating userinfo response
2018-10-14 14:16:22.518 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 14:16:22.524 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 14:16:22.550 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:16:22.555 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:16:22.558 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 14:16:22.564 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:16:22.680 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:16:22.684 -03:00 [DBG] End userinfo request
2018-10-14 14:17:13.819 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 14:17:13.826 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:17:13.830 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:17:13.834 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:17:13.840 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:17:13.847 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:17:13.853 -03:00 [DBG] Start discovery request
2018-10-14 14:17:13.878 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:17:16.376 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 14:17:16.383 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:17:16.387 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:17:16.390 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:17:16.395 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:17:16.400 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:17:16.404 -03:00 [DBG] Start key discovery request
2018-10-14 14:17:18.785 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 14:17:18.793 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:17:18.797 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:17:42.270 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 14:17:42.289 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:17:42.315 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:17:42.323 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:17:42.332 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:17:42.346 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:17:42.374 -03:00 [DBG] Start userinfo request
2018-10-14 14:17:42.378 -03:00 [DBG] Bearer token found in header
2018-10-14 14:17:42.414 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:17:42.440 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:17:42.453 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:17:42.458 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539537241,
    "exp": 1539540841,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "UserManagementUI",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.user"
    ],
    "amr": "external"
  }
}
2018-10-14 14:17:42.468 -03:00 [DBG] Creating userinfo response
2018-10-14 14:17:42.472 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 14:17:42.475 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 14:17:42.484 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:17:42.489 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:17:42.496 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 14:17:42.510 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:17:42.535 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:17:42.539 -03:00 [DBG] End userinfo request
2018-10-14 14:17:55.111 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 14:17:55.119 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:17:55.124 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:17:55.128 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:17:55.132 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:17:55.137 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:17:55.141 -03:00 [DBG] Start discovery request
2018-10-14 14:17:55.161 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:17:55.348 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 14:17:55.354 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:17:55.357 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:17:55.360 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:17:55.364 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:17:55.368 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:17:55.372 -03:00 [DBG] Start key discovery request
2018-10-14 14:17:55.407 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 14:17:55.415 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:17:55.419 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:17:55.489 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 14:17:55.503 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:17:55.510 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:17:55.518 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:17:55.523 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:17:55.530 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:17:55.543 -03:00 [DBG] Start userinfo request
2018-10-14 14:17:55.562 -03:00 [DBG] Bearer token found in header
2018-10-14 14:17:55.585 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:17:55.606 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:17:55.614 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:17:55.617 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539537241,
    "exp": 1539540841,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "UserManagementUI",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.user"
    ],
    "amr": "external"
  }
}
2018-10-14 14:17:55.622 -03:00 [DBG] Creating userinfo response
2018-10-14 14:17:55.624 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 14:17:55.630 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 14:17:55.636 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:17:55.639 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:17:55.642 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 14:17:55.648 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:17:55.665 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:17:55.668 -03:00 [DBG] End userinfo request
2018-10-14 14:27:34.877 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 14:27:34.891 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:27:34.896 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:27:34.901 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:27:34.906 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:27:34.911 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:27:34.915 -03:00 [DBG] Start discovery request
2018-10-14 14:27:34.934 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:27:34.945 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 14:27:34.954 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:27:34.958 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:27:34.961 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:27:34.965 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:27:34.970 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:27:34.973 -03:00 [DBG] Start key discovery request
2018-10-14 14:27:45.576 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 14:27:45.582 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:27:45.588 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:27:45.591 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:27:45.595 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:27:45.600 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:27:45.604 -03:00 [DBG] Start discovery request
2018-10-14 14:27:45.625 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:27:45.671 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 14:27:45.680 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:27:45.684 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:27:45.687 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:27:45.693 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:27:45.697 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:27:45.701 -03:00 [DBG] Start key discovery request
2018-10-14 14:27:45.816 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-10-14 14:27:45.824 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-10-14 14:27:45.827 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-10-14 14:27:45.836 -03:00 [DBG] Start authorize request
2018-10-14 14:27:45.849 -03:00 [DBG] User in authorize request: d36b7160-b58b-4e68-8d0a-fe959d445f4b
2018-10-14 14:27:45.857 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 14:27:45.880 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:27:45.909 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:27:45.958 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 14:27:45.973 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:27:45.987 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 14:27:46.001 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 14:27:46.012 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4200/login-callback"
  ],
  "SubjectId": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email jp_api.user",
  "State": "1eJRImJ5VviLkHaF5yGQcNTpsPWzYiyURo98sy0i",
  "Nonce": "1eJRImJ5VviLkHaF5yGQcNTpsPWzYiyURo98sy0i",
  "SessionId": "f313a49fa663c1f1df4906607518da7a",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "UserManagementUI",
    "state": "1eJRImJ5VviLkHaF5yGQcNTpsPWzYiyURo98sy0i",
    "redirect_uri": "http://localhost:4200/login-callback",
    "scope": "openid profile email jp_api.user",
    "nonce": "1eJRImJ5VviLkHaF5yGQcNTpsPWzYiyURo98sy0i"
  }
}
2018-10-14 14:27:46.093 -03:00 [DBG] CQw7PQZzv0X/POAfOZXAe9WpvFJDwBmfVs0+A8o4zoM= found in database: true
2018-10-14 14:27:46.101 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-10-14 14:27:46.109 -03:00 [DBG] Creating Implicit Flow response.
2018-10-14 14:27:46.119 -03:00 [DBG] Getting claims for access token for client: UserManagementUI
2018-10-14 14:27:46.122 -03:00 [DBG] Getting claims for access token for subject: d36b7160-b58b-4e68-8d0a-fe959d445f4b
2018-10-14 14:27:46.170 -03:00 [DBG] Getting claims for identity token for subject: d36b7160-b58b-4e68-8d0a-fe959d445f4b and client: UserManagementUI
2018-10-14 14:27:46.173 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-10-14 14:27:46.201 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "UserManagementUI",
  "ClientName": "User Management UI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
  "Scopes": "openid profile email jp_api.user",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****UrnQ"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****lOCg"
    }
  ],
  "ActivityId": "0HLHHV30UUFPC:00000001",
  "TimeStamp": "2018-10-14T17:27:46Z",
  "ProcessId": 9496,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-10-14 14:27:46.212 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
  "ClientId": "UserManagementUI",
  "RedirectUri": "http://localhost:4200/login-callback",
  "State": "1eJRImJ5VviLkHaF5yGQcNTpsPWzYiyURo98sy0i",
  "Scope": "openid profile email jp_api.user"
}
2018-10-14 14:27:47.438 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2018-10-14 14:27:47.444 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:27:47.449 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:27:47.453 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:27:47.458 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:27:47.463 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:27:47.468 -03:00 [DBG] Start discovery request
2018-10-14 14:27:47.488 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:27:47.515 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2018-10-14 14:27:47.522 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:27:47.526 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:27:47.532 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:27:47.535 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:27:47.540 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:27:47.543 -03:00 [DBG] Start key discovery request
2018-10-14 14:27:48.675 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 14:27:48.684 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:27:48.688 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:27:48.742 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2018-10-14 14:27:48.750 -03:00 [DBG] Origin http://localhost:4200 is allowed: true
2018-10-14 14:27:48.755 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2018-10-14 14:27:48.759 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:27:48.764 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:27:48.768 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:27:48.771 -03:00 [DBG] Start userinfo request
2018-10-14 14:27:48.774 -03:00 [DBG] Bearer token found in header
2018-10-14 14:27:48.798 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:27:48.818 -03:00 [DBG] UserManagementUI found in database: true
2018-10-14 14:27:48.827 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:27:48.830 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539538066,
    "exp": 1539541666,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "UserManagementUI",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.user"
    ],
    "amr": "external"
  }
}
2018-10-14 14:27:48.834 -03:00 [DBG] Creating userinfo response
2018-10-14 14:27:48.837 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 14:27:48.841 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 14:27:48.847 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:27:48.850 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:27:48.853 -03:00 [DBG] Scopes in access token: openid profile email jp_api.user
2018-10-14 14:27:48.858 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:27:48.869 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:27:48.872 -03:00 [DBG] End userinfo request
2018-10-14 14:27:51.027 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:27:51.031 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:27:51.034 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:27:51.037 -03:00 [DBG] Start discovery request
2018-10-14 14:27:51.047 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:27:51.095 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:27:51.099 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:27:51.103 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:27:51.105 -03:00 [DBG] Start key discovery request
2018-10-14 14:50:54.117 -03:00 [INF] SigninCredentialExtension keyType is Temporary
2018-10-14 14:50:54.302 -03:00 [INF] SigninCredentialExtension added
2018-10-14 14:50:59.647 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-10-14 14:50:59.662 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-10-14 14:50:59.665 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-10-14 14:50:59.667 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-10-14 14:50:59.672 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-10-14 14:51:11.069 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4300
2018-10-14 14:51:11.179 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:11.187 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:11.223 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:51:11.232 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:51:11.236 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:51:11.242 -03:00 [DBG] Start discovery request
2018-10-14 14:51:11.549 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:51:11.603 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4300
2018-10-14 14:51:11.615 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:11.620 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:11.624 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:51:11.628 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:51:11.668 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:51:11.677 -03:00 [DBG] Start key discovery request
2018-10-14 14:51:11.930 -03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-10-14 14:51:11.938 -03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-10-14 14:51:11.941 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-10-14 14:51:11.948 -03:00 [DBG] Start authorize request
2018-10-14 14:51:11.956 -03:00 [DBG] User in authorize request: d36b7160-b58b-4e68-8d0a-fe959d445f4b
2018-10-14 14:51:11.963 -03:00 [DBG] Start authorize request protocol validation
2018-10-14 14:51:12.159 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:51:12.201 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:51:12.247 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 14:51:12.270 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:51:12.286 -03:00 [DBG] Found ["jp_api.user","jp_api.is4"] API scopes in database
2018-10-14 14:51:12.298 -03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-10-14 14:51:12.313 -03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "IS4-Admin",
  "ClientName": "IS4-Admin",
  "RedirectUri": "http://localhost:4300/login-callback",
  "AllowedRedirectUris": [
    "http://localhost:4300/login-callback"
  ],
  "SubjectId": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
  "ResponseType": "id_token token",
  "ResponseMode": "fragment",
  "GrantType": "implicit",
  "RequestedScopes": "openid profile email jp_api.is4",
  "State": "kzQIepBiJ1HtWZ5rUmbaLPsLEKr33Lp3VfAifXcE",
  "Nonce": "kzQIepBiJ1HtWZ5rUmbaLPsLEKr33Lp3VfAifXcE",
  "SessionId": "f313a49fa663c1f1df4906607518da7a",
  "Raw": {
    "response_type": "id_token token",
    "client_id": "IS4-Admin",
    "state": "kzQIepBiJ1HtWZ5rUmbaLPsLEKr33Lp3VfAifXcE",
    "redirect_uri": "http://localhost:4300/login-callback",
    "scope": "openid profile email jp_api.is4",
    "nonce": "kzQIepBiJ1HtWZ5rUmbaLPsLEKr33Lp3VfAifXcE"
  }
}
2018-10-14 14:51:12.379 -03:00 [DBG] HfP76HeqAZj89RV7qQ4e7uzUwcMI+2MExHjSLkC+zo0= found in database: true
2018-10-14 14:51:12.387 -03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-10-14 14:51:12.397 -03:00 [DBG] Creating Implicit Flow response.
2018-10-14 14:51:12.408 -03:00 [DBG] Getting claims for access token for client: IS4-Admin
2018-10-14 14:51:12.410 -03:00 [DBG] Getting claims for access token for subject: d36b7160-b58b-4e68-8d0a-fe959d445f4b
2018-10-14 14:51:12.465 -03:00 [DBG] Getting claims for identity token for subject: d36b7160-b58b-4e68-8d0a-fe959d445f4b and client: IS4-Admin
2018-10-14 14:51:12.469 -03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-10-14 14:51:12.491 -03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "IS4-Admin",
  "ClientName": "IS4-Admin",
  "RedirectUri": "http://localhost:4300/login-callback",
  "Endpoint": "Authorize",
  "SubjectId": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
  "Scopes": "openid profile email jp_api.is4",
  "GrantType": "implicit",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****JyTg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****gwMA"
    }
  ],
  "ActivityId": "0HLHHVMG804UU:00000001",
  "TimeStamp": "2018-10-14T17:51:12Z",
  "ProcessId": 23076,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-10-14 14:51:12.499 -03:00 [INF] Authorize endpoint response
{
  "SubjectId": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
  "ClientId": "IS4-Admin",
  "RedirectUri": "http://localhost:4300/login-callback",
  "State": "kzQIepBiJ1HtWZ5rUmbaLPsLEKr33Lp3VfAifXcE",
  "Scope": "openid profile email jp_api.is4"
}
2018-10-14 14:51:12.521 -03:00 [DBG] Augmenting SignInContext
2018-10-14 14:51:12.532 -03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-10-14 14:51:13.563 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4300
2018-10-14 14:51:13.570 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:13.575 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:13.580 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:51:13.585 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:51:13.590 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:51:13.595 -03:00 [DBG] Start discovery request
2018-10-14 14:51:13.617 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:51:13.637 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4300
2018-10-14 14:51:13.645 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:13.650 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:13.654 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:51:13.658 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:51:13.663 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:51:13.666 -03:00 [DBG] Start key discovery request
2018-10-14 14:51:14.821 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:51:14.827 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:14.830 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:14.890 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:51:14.897 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:14.902 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:14.905 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:51:14.911 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:51:14.916 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:51:14.926 -03:00 [DBG] Start userinfo request
2018-10-14 14:51:14.932 -03:00 [DBG] Bearer token found in header
2018-10-14 14:51:14.980 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:51:15.004 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:51:15.016 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:51:15.024 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539539472,
    "exp": 1539543072,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "IS4-Admin",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.is4"
    ],
    "amr": "external"
  }
}
2018-10-14 14:51:15.034 -03:00 [DBG] Creating userinfo response
2018-10-14 14:51:15.040 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:51:15.045 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:51:15.052 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:51:15.056 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:51:15.059 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:51:15.064 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:51:15.075 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:51:15.078 -03:00 [DBG] End userinfo request
2018-10-14 14:51:42.640 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4300
2018-10-14 14:51:42.650 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:42.654 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:42.657 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:51:42.661 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:51:42.666 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:51:42.669 -03:00 [DBG] Start discovery request
2018-10-14 14:51:42.688 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:51:42.713 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4300
2018-10-14 14:51:42.721 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:42.726 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:42.731 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:51:42.736 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:51:42.739 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:51:42.743 -03:00 [DBG] Start key discovery request
2018-10-14 14:51:42.856 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:51:42.864 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:42.868 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:42.950 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:51:42.958 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:42.962 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:42.967 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:51:42.971 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:51:42.976 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:51:42.981 -03:00 [DBG] Start userinfo request
2018-10-14 14:51:42.985 -03:00 [DBG] Bearer token found in header
2018-10-14 14:51:43.021 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:51:43.057 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:51:43.069 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:51:43.084 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539539472,
    "exp": 1539543072,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "IS4-Admin",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.is4"
    ],
    "amr": "external"
  }
}
2018-10-14 14:51:43.103 -03:00 [DBG] Creating userinfo response
2018-10-14 14:51:43.106 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:51:43.112 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:51:43.123 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:51:43.128 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:51:43.134 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:51:43.144 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:51:43.161 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:51:43.164 -03:00 [DBG] End userinfo request
2018-10-14 14:51:43.558 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4300
2018-10-14 14:51:43.563 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:43.566 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:43.569 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:51:43.572 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:51:43.575 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:51:43.578 -03:00 [DBG] Start discovery request
2018-10-14 14:51:43.596 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:51:43.611 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4300
2018-10-14 14:51:43.617 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:43.620 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:43.622 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:51:43.626 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:51:43.629 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:51:43.633 -03:00 [DBG] Start key discovery request
2018-10-14 14:51:45.453 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:51:45.459 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:45.462 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:45.516 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:51:45.523 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:45.526 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:45.529 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:51:45.532 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:51:45.535 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:51:45.538 -03:00 [DBG] Start userinfo request
2018-10-14 14:51:45.541 -03:00 [DBG] Bearer token found in header
2018-10-14 14:51:45.562 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:51:45.583 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:51:45.590 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:51:45.593 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539539472,
    "exp": 1539543072,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "IS4-Admin",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.is4"
    ],
    "amr": "external"
  }
}
2018-10-14 14:51:45.598 -03:00 [DBG] Creating userinfo response
2018-10-14 14:51:45.600 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:51:45.603 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:51:45.611 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:51:45.614 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:51:45.617 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:51:45.626 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:51:45.637 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:51:45.640 -03:00 [DBG] End userinfo request
2018-10-14 14:51:46.232 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4300
2018-10-14 14:51:46.240 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:46.245 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:46.250 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:51:46.256 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:51:46.263 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:51:46.268 -03:00 [DBG] Start discovery request
2018-10-14 14:51:46.292 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:51:46.327 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4300
2018-10-14 14:51:46.336 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:46.344 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:46.348 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:51:46.354 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:51:46.357 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:51:46.361 -03:00 [DBG] Start key discovery request
2018-10-14 14:51:48.227 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:51:48.233 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:48.237 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:48.334 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:51:48.343 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:51:48.348 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:51:48.352 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:51:48.357 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:51:48.362 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:51:48.371 -03:00 [DBG] Start userinfo request
2018-10-14 14:51:48.375 -03:00 [DBG] Bearer token found in header
2018-10-14 14:51:48.405 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:51:48.439 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:51:48.447 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:51:48.451 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539539472,
    "exp": 1539543072,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "IS4-Admin",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.is4"
    ],
    "amr": "external"
  }
}
2018-10-14 14:51:48.456 -03:00 [DBG] Creating userinfo response
2018-10-14 14:51:48.459 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:51:48.461 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:51:48.471 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:51:48.474 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:51:48.478 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:51:48.485 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:51:48.497 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:51:48.501 -03:00 [DBG] End userinfo request
2018-10-14 14:52:48.353 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4300
2018-10-14 14:52:48.368 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:52:48.389 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:52:48.402 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:52:48.429 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:52:48.434 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:52:48.448 -03:00 [DBG] Start discovery request
2018-10-14 14:52:48.470 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:52:48.539 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4300
2018-10-14 14:52:48.544 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:52:48.547 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:52:48.551 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:52:48.554 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:52:48.558 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:52:48.561 -03:00 [DBG] Start key discovery request
2018-10-14 14:52:48.637 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:52:48.644 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:52:48.647 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:52:48.742 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:52:48.751 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:52:48.755 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:52:48.759 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:52:48.762 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:52:48.765 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:52:48.769 -03:00 [DBG] Start userinfo request
2018-10-14 14:52:48.771 -03:00 [DBG] Bearer token found in header
2018-10-14 14:52:48.801 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:52:48.824 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:52:48.845 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:52:48.849 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539539472,
    "exp": 1539543072,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "IS4-Admin",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.is4"
    ],
    "amr": "external"
  }
}
2018-10-14 14:52:48.855 -03:00 [DBG] Creating userinfo response
2018-10-14 14:52:48.858 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:52:48.866 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:52:48.873 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:52:48.881 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:52:48.885 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:52:48.895 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:52:48.916 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:52:48.920 -03:00 [DBG] End userinfo request
2018-10-14 14:53:03.765 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4300
2018-10-14 14:53:03.772 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:03.777 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:03.782 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:53:03.785 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:53:03.791 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:53:03.797 -03:00 [DBG] Start discovery request
2018-10-14 14:53:03.816 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:53:03.842 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4300
2018-10-14 14:53:03.849 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:03.853 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:03.857 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:53:03.860 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:53:03.864 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:53:03.868 -03:00 [DBG] Start key discovery request
2018-10-14 14:53:04.043 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:53:04.050 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:04.054 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:04.174 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:53:04.183 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:04.188 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:04.195 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:53:04.201 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:53:04.205 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:53:04.209 -03:00 [DBG] Start userinfo request
2018-10-14 14:53:04.211 -03:00 [DBG] Bearer token found in header
2018-10-14 14:53:04.240 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:53:04.270 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:53:04.285 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:53:04.289 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539539472,
    "exp": 1539543072,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "IS4-Admin",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.is4"
    ],
    "amr": "external"
  }
}
2018-10-14 14:53:04.294 -03:00 [DBG] Creating userinfo response
2018-10-14 14:53:04.298 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:04.304 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:04.313 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:53:04.319 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:53:04.324 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:04.332 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:53:04.356 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:53:04.362 -03:00 [DBG] End userinfo request
2018-10-14 14:53:04.476 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4300
2018-10-14 14:53:04.484 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:04.487 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:04.491 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:53:04.494 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:53:04.498 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:53:04.504 -03:00 [DBG] Start discovery request
2018-10-14 14:53:04.521 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:53:04.546 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4300
2018-10-14 14:53:04.554 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:04.557 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:04.560 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:53:04.564 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:53:04.568 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:53:04.572 -03:00 [DBG] Start key discovery request
2018-10-14 14:53:04.780 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:53:04.788 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:04.792 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:04.847 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:53:04.858 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:04.861 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:04.863 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:53:04.867 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:53:04.870 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:53:04.873 -03:00 [DBG] Start userinfo request
2018-10-14 14:53:04.875 -03:00 [DBG] Bearer token found in header
2018-10-14 14:53:04.894 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:53:04.910 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:53:04.916 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:53:04.920 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539539472,
    "exp": 1539543072,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "IS4-Admin",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.is4"
    ],
    "amr": "external"
  }
}
2018-10-14 14:53:04.927 -03:00 [DBG] Creating userinfo response
2018-10-14 14:53:04.929 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:04.931 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:04.939 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:53:04.942 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:53:04.945 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:04.953 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:53:04.964 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:53:04.967 -03:00 [DBG] End userinfo request
2018-10-14 14:53:13.667 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:53:13.674 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:13.680 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:13.738 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:53:13.748 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:13.754 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:13.758 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:53:13.764 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:53:13.771 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:53:13.776 -03:00 [DBG] Start userinfo request
2018-10-14 14:53:13.780 -03:00 [DBG] Bearer token found in header
2018-10-14 14:53:13.808 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:53:13.834 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:53:13.842 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:53:13.846 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539539472,
    "exp": 1539543072,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "IS4-Admin",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.is4"
    ],
    "amr": "external"
  }
}
2018-10-14 14:53:13.852 -03:00 [DBG] Creating userinfo response
2018-10-14 14:53:13.854 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:13.860 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:13.867 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:53:13.894 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:53:13.901 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:13.932 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:53:13.964 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:53:13.973 -03:00 [DBG] End userinfo request
2018-10-14 14:53:46.759 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4300
2018-10-14 14:53:46.768 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:46.773 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:46.780 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:53:46.789 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:53:46.796 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:53:46.804 -03:00 [DBG] Start discovery request
2018-10-14 14:53:46.834 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:53:46.901 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4300
2018-10-14 14:53:46.906 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:46.910 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:46.913 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:53:46.917 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:53:46.922 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:53:46.938 -03:00 [DBG] Start key discovery request
2018-10-14 14:53:47.012 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:53:47.017 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:47.021 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:47.077 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:53:47.087 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:47.092 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:47.096 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:53:47.100 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:53:47.105 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:53:47.109 -03:00 [DBG] Start userinfo request
2018-10-14 14:53:47.112 -03:00 [DBG] Bearer token found in header
2018-10-14 14:53:47.145 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:53:47.190 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:53:47.206 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:53:47.210 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539539472,
    "exp": 1539543072,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "IS4-Admin",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.is4"
    ],
    "amr": "external"
  }
}
2018-10-14 14:53:47.218 -03:00 [DBG] Creating userinfo response
2018-10-14 14:53:47.221 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:47.225 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:47.233 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:53:47.237 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:53:47.240 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:47.253 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:53:47.273 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:53:47.279 -03:00 [DBG] End userinfo request
2018-10-14 14:53:47.568 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4300
2018-10-14 14:53:47.574 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:47.578 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:47.583 -03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-10-14 14:53:47.588 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-10-14 14:53:47.592 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-10-14 14:53:47.597 -03:00 [DBG] Start discovery request
2018-10-14 14:53:47.613 -03:00 [DBG] Found ["openid","profile","email","username","roles","is4-rights","jp_api.user","jp_api.is4"] as all scopes in database
2018-10-14 14:53:47.627 -03:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4300
2018-10-14 14:53:47.633 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:47.636 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:47.640 -03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-10-14 14:53:47.643 -03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-10-14 14:53:47.646 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-10-14 14:53:47.650 -03:00 [DBG] Start key discovery request
2018-10-14 14:53:47.759 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:53:47.765 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:47.772 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:47.825 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:53:47.835 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:47.840 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:47.843 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:53:47.847 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:53:47.850 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:53:47.854 -03:00 [DBG] Start userinfo request
2018-10-14 14:53:47.857 -03:00 [DBG] Bearer token found in header
2018-10-14 14:53:47.883 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:53:47.910 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:53:47.920 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:53:47.925 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539539472,
    "exp": 1539543072,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "IS4-Admin",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.is4"
    ],
    "amr": "external"
  }
}
2018-10-14 14:53:47.932 -03:00 [DBG] Creating userinfo response
2018-10-14 14:53:47.939 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:47.944 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:47.957 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:53:47.961 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:53:47.965 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:47.973 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:53:47.991 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:53:47.995 -03:00 [DBG] End userinfo request
2018-10-14 14:53:53.183 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:53:53.191 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:53.195 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:53.297 -03:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4300
2018-10-14 14:53:53.305 -03:00 [DBG] Origin http://localhost:4300 is allowed: true
2018-10-14 14:53:53.309 -03:00 [DBG] CorsPolicyService allowed origin: http://localhost:4300
2018-10-14 14:53:53.313 -03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-10-14 14:53:53.317 -03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-10-14 14:53:53.322 -03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-10-14 14:53:53.327 -03:00 [DBG] Start userinfo request
2018-10-14 14:53:53.329 -03:00 [DBG] Bearer token found in header
2018-10-14 14:53:53.359 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:53:53.384 -03:00 [DBG] IS4-Admin found in database: true
2018-10-14 14:53:53.397 -03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-10-14 14:53:53.406 -03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1539539472,
    "exp": 1539543072,
    "iss": "https://localhost:5000",
    "aud": [
      "https://localhost:5000/resources",
      "jp_api"
    ],
    "client_id": "IS4-Admin",
    "sub": "d36b7160-b58b-4e68-8d0a-fe959d445f4b",
    "auth_time": 1539537241,
    "idp": "Google",
    "username": "bhdebrito@gmail.com",
    "email": "bhdebrito@gmail.com",
    "scope": [
      "openid",
      "profile",
      "email",
      "jp_api.is4"
    ],
    "amr": "external"
  }
}
2018-10-14 14:53:53.417 -03:00 [DBG] Creating userinfo response
2018-10-14 14:53:53.425 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:53.430 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:53.440 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:53:53.447 -03:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture profile preferred_username nickname middle_name given_name family_name name email_verified email
2018-10-14 14:53:53.456 -03:00 [DBG] Scopes in access token: openid profile email jp_api.is4
2018-10-14 14:53:53.467 -03:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2018-10-14 14:53:53.484 -03:00 [INF] Profile service returned to the following claim types: sub email picture preferred_username name email email_verified
2018-10-14 14:53:53.488 -03:00 [DBG] End userinfo request
2018-10-15 10:44:11.103 -03:00 [INF] SigninCredentialExtension keyType is Temporary
2018-10-15 10:44:11.304 -03:00 [INF] SigninCredentialExtension added
2018-10-15 10:44:13.886 -03:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `StoredEvent` (
    `Action` varchar(100) NULL,
    `AggregateId` longtext NULL,
    `CreationDate` datetime(6) NOT NULL,
    `Id` char(36) NOT NULL,
    `Data` longtext NULL,
    `User` longtext NULL,
    CONSTRAINT `PK_StoredEvent` PRIMARY KEY (`Id`)
);
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'StoredEvent' already exists ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'StoredEvent' already exists
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
2018-10-15 10:44:46.645 -03:00 [INF] SigninCredentialExtension keyType is Temporary
2018-10-15 10:44:46.784 -03:00 [INF] SigninCredentialExtension added
2018-10-15 10:44:52.253 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-10-15 10:44:52.269 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-10-15 10:44:52.272 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-10-15 10:44:52.274 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-10-15 10:44:52.277 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-10-15 10:45:16.411 -03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-10-15 10:45:16.424 -03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-10-15 10:45:16.427 -03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-10-15 10:45:16.434 -03:00 [INF] Identity.Application was not authenticated. Failure message: No principal.
2018-10-15 10:45:16.449 -03:00 [INF] Identity.Application was not authenticated. Failure message: No principal.
2018-10-15 11:10:13.903 -03:00 [INF] SigninCredentialExtension keyType is Temporary
2018-10-15 11:10:14.088 -03:00 [INF] SigninCredentialExtension added
2018-10-15 11:10:18.066 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-10-15 11:10:18.081 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-10-15 11:10:18.084 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-10-15 11:10:18.085 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-10-15 11:10:18.087 -03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-10-15 15:33:22.804 -03:00 [INF] SigninCredentialExtension keyType is Temporary
2018-10-15 15:33:22.938 -03:00 [INF] SigninCredentialExtension added
2018-10-15 15:33:25.240 -03:00 [ERR] Failed executing DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `StoredEvent` (
    `Action` varchar(100) NULL,
    `AggregateId` longtext NULL,
    `CreationDate` datetime(6) NOT NULL,
    `Id` char(36) NOT NULL,
    `Data` longtext NULL,
    `User` longtext NULL,
    CONSTRAINT `PK_StoredEvent` PRIMARY KEY (`Id`)
);
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'StoredEvent' already exists ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'StoredEvent' already exists
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
2018-10-15 15:34:18.472 -03:00 [INF] SigninCredentialExtension keyType is Temporary
2018-10-15 15:34:18.618 -03:00 [INF] SigninCredentialExtension added
2018-10-15 15:34:35.725 -03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-10-15 15:34:35.740 -03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-10-15 15:34:35.742 -03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-10-15 15:34:35.746 -03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-10-15 15:34:35.748 -03:00 [DBG] Using Identity.Application as default scheme for forbid
